apt10 (menupass group): new tools, global campaign latest manifestation of longstanding threat
april 06, 2017 | by fireeye isight intelligence | threat intelligence, targeted attack, advanced malware
apt10 background
apt10 (menupass group) is a chinese cyber espionage group that fireeye has tracked since 2009. they have historically targeted construction and engineering, aerospace, and telecom firms, and governments in the united states, europe, and japan. we believe that the targeting of these industries has been in support of chinese national security goals, including acquiring valuable military and intelligence information as well as the theft of confidential business data to support chinese corporations. pwc and bae recently issued a joint blog detailing extensive apt10 activity. apt10 s resurgence
in june 2016, fireeye isight intelligence first reported that apt10 expanded their operations. the group was initially detected targeting a japanese university, and more widespread targeting in japan was subsequently uncovered. further collaboration between fireeye as a service (faas), mandiant and fireeye isight intelligence uncovered additional victims worldwide, a new suite of tools and novel techniques. global targeting using new tools
leveraging its global footprint, fireeye has detected apt10 activity across six continents in 2016 and 2017. apt10 has targeted or compromised manufacturing companies in india, japan and northern europe; a mining company in south america; and multiple it service providers worldwide. we believe these companies are a mix of final targets and organizations that could provide a foothold in a final target. apt10 unveiled new tools in its 2016/2017 activity. in addition to the continued use of sogu, the current wave of intrusions has involved new tools we believe are unique to apt10. haymaker and snugride have been used as first stage backdoors, while bugjuice and a customized version of the open source quasarrat have been used as second stage backdoors. these new pieces of malware show that apt10 is devoting resources to capability development and innovation. haymaker is a backdoor that can download and execute additional payloads in the form of modules. it also conducts basic victim profiling activity, collecting the computer name, running process ids, %temp% directory path and version of internet explorer. it communicates encoded system information to a single hard coded command and control (c2) server, using the system s default user-agent string.
bugjuice is a backdoor that is executed by launching a benign file and then hijacking the search order to load a malicious dll into it. that malicious dll then loads encrypted shellcode from the binary, which is decrypted and runs the final bugjuice payload. bugjuice defaults to tcp using a custom binary protocol to communicate with the c2, but can also use http and https if directed by the c2. it has the capability to find files, enumerate drives, exfiltrate data, take screenshots and provide a reverse shell.
snugride is a backdoor that communicates with its c2 server through http requests. messages are encrypted using aes with a static key. the malware s capabilities include taking a system survey, access to the filesystem, executing commands and a reverse shell. persistence is maintained through a run registry key.
quasarrat is an open-source rat available here. the versions used by apt10 are not available via the public github page, indicating that apt10 has further customized the open source version. the 2.0 versions require a dropper to decipher and launch the aes encrypted quasarrat payload. quasarrat is a fully functional .net backdoor that has been used by multiple cyber espionage groups in the past.
traditional and novel methods
this recent apt10 activity has included both traditional spear phishing and access to victim s networks through service providers. (for more information on infection via service providers see m-trends 2016). apt10 spear phishes have been relatively unsophisticated, leveraging .lnk files within archives, files with double extensions (e.g. ) and in some cases simply identically named decoy documents and malicious launchers within the same archive. in addition to the spear phishes, fireeye isight intelligence has observed apt10 accessing victims through global service providers. service providers have significant access to customer networks, enabling an attacker who had compromised a service provider to move laterally into the network of the service provider s customer. in addition, web traffic between a service provider s customer and a service provider is likely to be viewed as benign by network defenders at the customer, allowing the attacker to exfiltrate data stealthily. a notable instance of this observed by fireeye involved a sogu backdoor that was set to communicate with its c2 through a server belonging to the victim s service provider. apt10 actors issued the following commands to a sogu implant at a victim: these commands included setting persistence on the victim s system. the actor then tested connectivity to an ip managed by the victim s service provider. once connectivity to the service provider ip was verified, the actor established the service provider ip as a proxy for the victim s sogu backdoor. this effectively routes sogu malware traffic through the victim s service provider, which likely indicates a foothold on the service provider s network. the tactic also serves to mask malicious c2 and exfiltration traffic and make it appear innocuous. implications
apt10 is a threat to organizations worldwide. their abuse of access to service provider networks demonstrates that peripheral organizations continue to be of interest to a malicious actor especially those seeking alternative angles of attack. we believe the pace of apt10 operations may slow following the public disclosure by the pwc/bae blog; however, we believe they will return to their large-scale operations, potentially employing new tactics, techniques and procedures. this entry was posted on april 06, 2017 and filed under malware, threat intelligence, advanced malware, fireeye isight intelligence, targeted attack, spear phishing, backdoor, and apt.
