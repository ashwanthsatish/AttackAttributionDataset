together with our colleagues at issuemakerslab, we uncovered operation red signature, an information theft-driven supply chain attack targeting organizations in south korea. we discovered the attacks around the end of july, while the media reported the attack in south korea on august 6. the threat actors compromised the update server of a remote support solutions provider to deliver a remote access tool called 9002 rat to their targets of interest through the update process. they carried this out by first stealing the company s certificate then using it to sign the malware. they also configured the update server to only deliver malicious files if the client is located in the range of ip addresses of their target organizations. 9002 rat also installed additional malicious tools: an exploit tool for internet information services (iis) 6 webdav (exploiting cve-2017-7269) and an sql database password dumper. these tools hint at how the attackers are also after data stored in their target s web server and database. here s how operation red signature works: the code-signing certificate from the remote support solutions provider is stolen. it s possible that the certificate was stolen as early as april 2018, as we found a shiftdoor malware on april 8 that was signed with the stolen certificate.
malicious update files are prepared, signed with the stolen certificate, and uploaded to the attacker s server (207[.]148[.]94[.]157).
the update server of the company is hacked.
the update server is configured to receive an file from the attackers server if a client is connecting from a specific range of ip addresses belonging to their targeted organizations.
the malicious file is sent to the client when the remote support program is executed.
the remote support program recognizes the update files as normal and executes the 9002 rat malware inside it.
9002 rat downloads and executes additional malicious files from the attackers server.
technical analysis
the file contains an file, which has the malicious update configuration that specifies the remote support solution program to download and and extract them as and to the installation folder. the program will then execute , signed with the stolen certificate, with microsoft register server ( ). this dynamic-link library (dll) is responsible for decrypting the encrypted file and executing it in memory. 9002 rat is the decrypted payload, which connects to the command-and-control (c&c) server at 66[.]42[.]37[.]101. correlating 9002 rat
delving into 9002 rat, we found that it was compiled on july 17, 2018, and that the configuration files inside were created on july 18. our analysis of an update log file we found reveals the remote support program s update process started around 13:35 on july 18, with the 9002 rat being downloaded and launched. we also saw the rat file used for this specific attack was set to be inactive in august, so we can construe that the rat s activity was rather short-lived (from july 18 to july 31). additional malware tools
the 9002 rat also serves as a springboard for delivering additional malware. most of these are downloaded as files compressed with the microsoft cabinet format (.cab). this is most likely done to avoid detection by antivirus (av) solutions. here s a list of files that 9002 rat retrieves and delivers to the affected system: one of the downloaded files , which is another rat. it is a variant of plugx malware, and connects to the same c&c server (66[.]42[.]37[.]101). mitigating supply chain attacks
supply chain attacks don t just affect users and businesses they exploit the trust between vendors and its clients or customers. by trojanizing software/applications or manipulating the infrastructures or platforms that run them, supply chain attacks affects the integrity and security of the goods and services that organizations provide. in healthcare, for instance, where the industry heavily relies on third-party and cloud-based services, supply chain attacks can risk the privacy of personally identifiable data and intellectual property, disrupt hospital operations, and even endanger patient health. and when stacked up with regulations such as the eu general data protection and regulation (gdpr), the impact can be exacerbated. here are some best practices: oversee third-party products and services; apart from ensuring the security of the organization s own online premises (e.g., patching, authentication mechanisms), security controls must also be in place in third-party applications being used.
develop a proactive incident response strategy: supply chain attacks are often targeted; organizations must be able to fully understand, manage, and monitor the risks involved in third-party vendors.
proactively monitor the network for anomalous activities; firewalls and intrusion detection and prevention systems help mitigate network-based threats.
enforce the principle of least privilege: network segmentation, data categorization, restriction of system administration tools, and application control help deter lateral movement and minimize data being exposed.
trend micro solutions
the trend micro deep discovery solution provides detection, in-depth analysis, and proactive response to today s stealthy malware and targeted attacks in real time. it provides a comprehensive defense tailored to protect organizations against targeted attacks and advanced threats through specialized engines, custom sandboxing, and seamless correlation across the entire attack life cycle, allowing it to detect threats even without any engine or pattern update. trend micro endpoint solutions such as the smart protection suites and worry-free business security solutions can protect users and businesses from threats by detecting malicious files and blocking all related malicious urls.
