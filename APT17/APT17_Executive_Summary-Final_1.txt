operation smn:
axiom threat actor group report
caveats
operational caveat:
to the best of novetta s knowledge and belief, participants in this effort did not disclose, access,
or utilize any confidential information that would result in violation of any third party agreements,
including but not limited to non-disclosure agreements or customer agreements.
reporting caveat:
due to the operational sensitivity of this activity and affected organizations, some of the related
details will not be included in this report or shared beyond their original sources.4
key findings
axiom is responsible for directing highly sophisticated cyber espionage operations against
numerous fortune 500 companies, journalists, environmental groups, pro-democracy groups,
software companies, academic institutions, and government agencies worldwide for at least the
last six years. in our coordinated effort, we performed the first ever-private sponsored
interdiction against a sophisticated state sponsored advanced threat group. our efforts detected
and cleaned 43,000 separate installations of axiom tools, including 180 of their top tier implants.
this report will expand upon the following key findings:
a coordinated effort across the private sector can have quantifiable impact on statesponsored threat actors.
the axiom threat group is a well resourced, disciplined, and sophisticated subgroup of a
larger cyber espionage group that has been directing operations unfettered for over six
years.
novetta has moderate to high confidence that the organization-tasking axiom is a part of
chinese intelligence apparatus. this belief has been partially confirmed by a recent fbi
flash released to infragard stating the actors are affiliated with the chinese government1.
axiom actors have victimized pro-democracy non-governmental organizations (ngo)
and other groups and individuals that would be perceived as a potential threat to the
stability of the chinese state.
axiom operators have been observed operating in organizations that are of strategic
economic interest, that influence environmental and energy policy, and that develop
cutting edge information technology including integrated circuits, telecommunications
equipment manufacturers, and infrastructure providers.
later stages of axiom operations leverage command and control infrastructure that has
been compromised solely for the targeting of individual or small clusters of related
targeted organizations.
axiom uses a varied toolset ranging from generic malware to very tailored, custom
malware designed for long-term persistence that at times can be measured in years. in
descending order of observed scarcity these families are:
zox family (zoxpng, zoxrpc)/gresim
hikit
derusbi
fexel/deputy dog
hydraq/9002/naid/roarur/mdmbot
zxshell/sensode
plugx/sogu/kaba/korplug/destroyrat
gh0st/moudour/mydoor
poison ivy/darkmoon/breut
operation smn background
operation smn2 is a coordinated effort amongst leading private-industry security companies,
led by novetta. the initial focus of operation smn was to conduct the first industry-led
interdiction effort against a sophisticated advanced threat actor group. this collaboration
represents an evolution of the status quo from simple reporting of identified threats to a new
methodology of coordinated interdiction. during this operation, the group performed malware
removal, released detection signatures, and issued public reporting on 10/14/20143 and
10/28/2014 in order to mitigate the threat posed by the actor group. for the purposes of this
document, the name axiom will refer to this threat group.
this effort was initially focused on transferring the understanding generated by novetta s
malware decoder development to microsoft, via their coordinated malware eradication program,
to create high fidelity signatures for the hikit malware family. these co-developed signatures
between novetta and microsoft were slated for inclusion in a malicious software removal tool
(msrt) release that would initially only target the hikit malware family. upon the initial few
iterations of information sharing and signature development between microsoft and novetta it
became clear that by leveraging additional industry partners a much larger sample set could be
collected, analyzed, and acted upon. this fueled the selective expansion of the partnership into
a small group of capable organizations that could contribute directly to the cme campaign.
the expansion of operational scope brought with it discussions of not only targeting the hikit
family of malware, but also refocusing efforts to target the entire known set of associated tools
and malware capabilities. it was at this junction that the group decided on a more
comprehensive course of action that would leverage the msrt capabilities for detection and
removal, as well as distribute the corpus of samples, analysis, and knowledge to the entire
industry via microsoft's virus information alliance. the group saw that this was the most
effective means to broadly distribute highly sensitive information to 64 trusted industry partners
in 22 separate countries for their own use, and to protect their customers.
this chain of events enabled operation smn members to plan and execute a global disruption
and degradation campaign, exposing a chinese state-sponsored threat actor that has targeted
and exploited individual victims and organizations worldwide. novetta feels that the unified
approach developed within operation smn, which united multiple perspectives and capabilities
across private industry, provides the highest level of visibility and establishes the foundation
necessary to effectively counter a threat of this nature. it is novetta s hope that others within
industry will embrace and adopt a similar approach in the future.
operational impact
on tuesday, october 14, 2014, operation-smn took its first public action as a coordinated
malware eradication campaign (cme-2014-03). this first action consisted of efforts intended to
impede the ability of this and other threat actors to leverage this suite of tools. to do so, the
coalition:
released detection and removal signatures for related malware both publicly and
through our coalition partners into their customer bases.
provided detection guidance to trusted security partners, including those in the microsoft
virus information alliance program, so that as many potentially affected victims as
possible will have detection and protection against this threat.
released several stages of reporting designed to raise awareness and highlight the
tools, techniques, and procedures leveraged by axiom and some affiliated groups.
the breadth and scope of axiom s operations served as motivation and justification for the
approach adopted by the coalition of large scale data capture, analysis, and distribution of both
data and analytical output to industry. in the intervening period, the coalition has received a
substantial amount of information relating to the removal of these malware tools. to date, over
43,000 separate installations of axiom-related tools have been removed from machines
protected by operation smn partners, and 180 of those infections were examples of hikit, the
late-stage persistence and data exfiltration tool that represents the height of an axiom victim s
operational lifecycle.
shown below are two graphs, generated with data from microsoft s msrt telemetry, which
graph the installation footprint of the various malware samples that axiom has been observed
using. three clear clusters emerge, centered on what novetta believes to be areas of
responsibility for axiom. these graphs speak to the usage of a multi-stage corpus of malware
which allows the operators to continually refine their targeting as they get closer and closer to
their intended goals.78
axiom targeting
novetta has observed that axiom s activity largely centers on using hikit within victim networks
post-compromise. the configuration files extracted from hikit binaries used in axiom s
operations give identifiable campaign comments that provide strong indications of the intended
targets.
from our analysis, we believe that organizations infected with hikit are significant to the goals
behind those tasking axiom operations. though many organizations may have been targeted
and compromised with initial stages of implants, the occurrence of hikit activity within an entity
indicates that the organization responsible for axiom tasking considers it of importance or,
alternatively, that the target is relatively hardened and more specialized malware is needed.
within these targets, axiom has been observed as going out of its way to ensure continued
access regardless of changes to its target s network topology or security controls. axiom s hikit
operators have been observed returning to compromised organizations on a scheduled basis,
and even performing targeted lateral compromises based on the geographic locations of
network egress points as well as introduction of new security controls.9
among the industries we observed targeted or potentially infected by hikit:
asian and western government agencies responsible for:
government records and communications agencies
law enforcement
environmental policy
personnel management
space and aerospace exploration and research
government auditing and internal affairs
electronics and integrated circuit manufacturers
networking equipment manufacturers
internet based services companies
software vendors, especially in the apac region
journalism and media organizations
ngos, specifically those which deal with human rights or environmental policy
international consulting and analysis firms
law firms with an international or heavy m&a financial footprint
telecommunications firms
manufacturing conglomerates
venture capital firms
energy firms
meteorological services companies
cloud computing companies
pharmaceutical companies
highly regarded us academic institutions
these industries cover an array of targeted organizations spanning multiple countries including
the united states, south korea, taiwan, japan, and the european union. novetta has observed
potential compromises from the following geographic areas:10
targeting and china s strategic goals
axiom s actions targeting the above industries have fit in particularly well with china s strategic
interests and with their most recent five year plans accepted in 2006 and 2011. the 12th five
year plan displays china s new direction of pursuing advanced technology and advanced r&d
efforts. as china begins its shift away from dependence on foreign technology (specifically the
us), more and more corporations and organizations may be targeted by axiom, and/or other
groups that receive the same or similar tasking, as the chinese play catch-up. the following
sections detail how axiom s hikit operations line up with official policy.
semiconductor and networking technology
as part of the 12th five year plan, semiconductor and network device manufacturing were two
main areas of focus for growth that china has emphasized to minimize foreign dependencies4
and increase potential consumption of domestic internet services. of the many ways the
chinese could acquire this knowledge and technology to further their stated goals, the fastest
would be the theft of trade and technology secrets from western corporations, especially those
with offices in china5. we have strong indications based on hikit analysis that these industries
have been targeted by axiom operations.
human intelligence
information on individuals stored by western and asian government entities has also been
targeted by axiom. information held by these organizations includes details on individuals with
access to confidential or classified information, which would be extremely useful for intelligence
and counterintelligence operations. additionally, it should be noted that this sort of information
could also be used to enable or extend technical and human operations against target
organizations and individuals. for example, this can be done through remote network based
attacks, tailored spear phishing, targeted social media delivery, physical delivery and transfer of
data through non-technical means, and traditional human operations.
non-governmental organizations
axiom has demonstrated a clear interest in compromising ngos that deal with international
politics, environmental policy, pro-democracy movements, or human rights issues. novetta has
observed at least one operation where axiom compromised a satellite office of one of these
organizations and then appeared to have moved laterally into that organization s main
headquarters. much has been written of china s dissatisfaction of their reputation on the world
stage, in particular criticism for human rights abuses and environmental issues stemming from
rapid industrialization; these criticisms are often viewed as a blow to the authority of the ruling
party and to the soft power of their nation state, which china has been keen on developing in
recent years. monitoring these kinds of organizations could allow the chinese government to
track these watchdog organizations and potentially accomplish more traditional goals such as
the suppression of dissidents or intimidation of whistleblowers.
previous public reporting
in addition to the malware binaries that novetta has analyzed and attributed to axiom, we have
found similarities in several high-profile cyber attacks since 2009. the following timeline details
some of the attacks that we know exhibit similar ttps or leverage overlapping tools and
infrastructure with those we have attributed to axiom.
june - december 2009: operation aurora (hydraq)
december 2009: elderwood project leveraging 0days6 (hydraq)
march, april june 2011: elderwood platform attacks
april, may, august 2012: elderwood platform attacks
june - july 2012: voho campaign wateringhole attacks7 (gh0st rat, hydraq)
july 2012 - january 2013: bit9 compromise8,9 (hikit)
june 2013: shell_crew compromise of coldfusion server10 (derusbi)
september 2013: operation deputy dog attack on japanese targets11
november 2013: operation ephemeral hydra involving internet explorer zero-day
(deputydog)12
january 2014: 3 new 0-day exploits leveraged by elderwood platform13
february 2014: operation snowman attack on the us veterans of foreign wars website
(deputydog)14
june - july 2014: american middle eastern policy think tank attacks15
as part of operation aurora, google16, adobe17, rackspace and 32 other companies were
compromised in similar fashion by attackers with connections to china, who we believe exhibit
some of axiom s characteristics18. microsoft also reported being subject to similar style attacks,
though those attempts were unsuccessful19. in april 2013, microsofts david aucsmith20
suggested that the aurora campaign that targeted google may have been part of a larger
chinese counterintelligence operation aimed at gaining insights to chinese gmail accounts
which were under fisa (foreign intelligence surveillance act) surveillance. later, in may 2013,
the washington post21 would report that according to current and former government officials,
the chinese had successfully accessed google s database of flagged email accounts that were
placed under 702 foreign surveillance by u.s. law enforcement and counterintelligence. it is
unclear whether these exploitation operations can be directly linked to axiom, however we have
seen direct evidence that axiom is highly interested in targeting organizations with data that
may aid human intelligence or counterintelligence operations.
during the summer of 2012, the voho campaign was discovered by private industry to be
leveraging watering-hole attacks and several exploits to download and install variants of gh0st
rat and hydraq. the voho attacks occurred in two phases, each phase using a different
zero-day vulnerability, over multiple weeks during july 2012. according to rsa s reporting on
this campaign, nearly 1,000 organizations across multiple industries were impacted during the
first phase, resulting in roughly 4,200 individual machines being compromised. during this multi
phased attack campaign security firm bit9 was targeted and axiom operators gained access to
a bit9 digital certificate. which they then used to sign custom variants of the hikit malware in an
effort to bypass the additional security provided by their product at specific organizations within
the voho target set.
the ability to target, compromise, and filter tens of thousands of individual infections across
nearly 1000 organizations, in order to identify victims to further other active attacks indicates a
level of technical, organizational, and operational sophistication not typically seen. the
techniques used and malware delivered in the voho campaign have been tied to axiom, and
the use of digital certificates to deliver malware is also a well-known technique for axiom.
watering-hole attacks that include 0-day exploits require planning and sophistication, as the
attackers need to identify sites frequented by their targets, compromise those third party
website(s), have available 0-day exploits, and then ultimately compromise the visiting targets systems. coupling a watering hole attack with a supply chain attack requires even more
planning. the fact that the voho watering hole attack, the bit9 compromise, and the delivery of
the custom hikit malware all occurred within a one week period suggests a highly organized
group able to carry out simultaneous and independent objectives against larger goals, possibly
under the direction and supervision of a larger organization.
another series of attacks named the elderwood project22 began in late 2009 and used a notably
large number of zero-day vulnerabilities to deliver malware (hydraq) onto targeted networks.
the attackers delivered these exploits using a variety of methods including a watering hole
attack targeting the amnesty international hong kong website, which may provide insight into at
least some of the victims targeted. the threat actors behind these attacks had access to
multiple critical zero-day vulnerabilities, suggesting the group had resources to develop them or
to acquire them from other. it should also be noted that the stated techniques of the actors
behind elderwood include targeting of supply-chain organizations of their intended targets.
american think tanks focusing on iraq have also been targets of watering-hole attacks23 that
utilize malware also occasionally used by the axiom group: derusbi. the attack was specifically
looking for users with identified chinese, us english, russian, japanese, or korean language
machines24. although previous chinese cyber attacks targeting think tanks have concentrated
on those involved in east asian policy, this shift may be reflective of china s renewed interest in
the middle east due to their dependence on oil production from this region25. although this is not
as strong a link to the axiom threat group, the fact that derusbi was used is notable, as this
malware is not widely distributed beyond intermediate stages of operations that have been
attributed to axiom.
when comparing the last three campaigns that have discussed(voho, elderwood project, and
iraq-focused think-tanks), beyond the toolset:
they all used waterholing as their primary initial infection vector
they all required the ability to sift potentially large sets of infected machines to identify
targets of high interest for further exploitation.
they all targeted (at least in part) non-profit organizations that deal with information
related to chinese policy or chinese stated interests.
the fact that the primary beneficiary of information stolen in these campaigns is not military or
directly financial, but rather intelligence benefiting chinese domestic and international policies,
is highly telling and implies the chinese intelligence apparatus could be behind such attacks.
domestic targeting
in addition to international organizations of strategic interest, it also appears that axiom has
used hikit internally to gather information on domestic chinese targets. cyber operations within
china s own borders may be reflective of the communist party s emphasis on maintaining
internal state security to ensure domestic stability, as the past three decades of rapid economic
change have brought about a significant wage gap, unemployment issues, environmental
issues, and other societal issues, in addition to long-standing issues such as disparate ethnic
groups and territorial disputes. the cpc has subsequently dedicated significant resources
toward domestic security: although domestic security spending for 2014 was not revealed by
official sources, in the three years prior it has consistently exceeded the military budget26.
among the well-funded entities tasked with domestic security are the ministry of public security
and the ministry of state security. in particular, the latter organization is the primary non-military
security agency of china and is tasked with not only domestic surveillance, but also foreign
intelligence and counterintelligence.
much of previous public reporting on chinese threat groups has concentrated on the cyber
capabilities and information warfare of the people s liberation army (pla). in particular, the
third department serves as the pla s telecommunications reconnaissance bureau charged
with sigint for foreign intelligence operations27. the third department is divided into twelve
bureaus, each ostensibly having a dedicated mission. for instance, the 2nd bureau, or unit
61398, has been directly linked by security researchers to attacks primarily focused on englishlanguage organizations of strategic importance to china28. while this group has been
responsible for a significant number of cyber attacks, the group s profiled operational security
and tactics do not appear to be as sophisticated as those attributed to axiom. in fact,
researchers were able to directly link individuals to this bureau due to activity on social media as
well as identifiable indicators used to register campaign command and control (c2)
infrastructure, including domains or emails. other individuals linked to unit 61398 cyber
operations have also been profiled by the fbi in an indictment of five chinese military
intelligence officers29. in contrast, there have been no identified mistakes in operational security
on the part of axiom operators to date.
other attacks targeting satellite/aerospace industries have been linked to the third
department s 12th bureau, unit 6148630. again, at least one individual has been connected to
this activity using open-source intelligence due to a presence on social media and clues found
in campaign infrastructure information, suggesting a lax operational security when compared to
what has been observed with axiom. furthermore, attack activity from unit 61486 has been
linked to unit 61398 based on shared infrastructure. this might suggest some degree of
cooperation or overlap between these teams and missions in the third department that we
have not yet observed between previously identified chinese threat groups and axiom, beyond
the usage of commonly available malware. however, we cannot discount the possibility that
previously reported chinese threat groups could be linked to axiom, or that both could be part of
a larger organization.
while it appears that the identified missions of most if not all units of the third department
remain focused on foreign intelligence and defensive network security, there are some
indications that a few pla bureaus do engage in unconfirmed domestic monitoring to some
degree, including monitoring of domestic broadcasts. nevertheless, based on observed ttps of
identified pla threat groups compared to axiom activity, we believe that axiom operates based
on a different mission and has resources that previously reported and identified pla cyber
operators do not have.
when examining axiom s possible domestic attack activity, we have identified several instances
of hikit present on machines located in china or hong kong, dating at least as far back as
january 2012. this would indicate domestic monitoring in addition to foreign operations, and
may suggest that the group to which axiom belongs is an entity charged with domestic security.
additional telemetry we have observed suggests that axiom may also target chinese citizens,
possibly dissidents, in foreign countries (including the united states and asia-pacific countries),
based on the presence of hikit on machines configured to use simplified chinese. in particular,
at least one hikit sample was observed targeting a chinese-language machine located in the
united states; the filename .tdl appears to reference a browser.
certain indicators from hikit binaries detected on machines in china or hong kong also provide
further insight how these domestic victims are targeted by axiom. the filenames of the malware,
for instance, show that they were likely curated for chinese speakers, as seen with chineselanguage file names including at least one referring to qq, the popular messaging application.
other more generically popular applications like adobe flash player were also used as potential
lures or means of hiding in plain site. novetta has also observed that chinese-related filenames
of commodity malware that has been used by both axiom as well as other threat groups (e.g.,
poison ivy, plugx, etc.) may also reflect a lively underground trade; some of the filenames we
have observed are listed below.17
table: filenames of some malware binaries present on machines located in china
original filename translation malware family
although this information does not conclusively determine that axiom conducts such operations,
when compared with some binary file names it could indicate deliberate targeting.
additionally, axiom has used at least one chinese companies certificate to sign a hikit binary:
(anwei iflytek information technology co. ltd.), which
specializes in voice recognition software and is owned in part by china mobile, a state asset.
while we do not know if domestic companies were compromised for axiom s purposes or,
alternatively, have cooperated with axiom campaigns, it again suggests axiom ability and
potential desire to stage domestic operations. other chinese companies as well as popular
asian gaming companies have also been used to digitally sign malware samples.
likely the online game league of legends
in addition to hikit, we have observed other axiom-related malware targeting domestic
organizations, including a few universities and research institutions in both hong kong and
mainland china. though this cannot be linked conclusively to axiom hikit operators, education
institutions, particularly those in hong kong, would likely be of extreme importance for any
monitoring of domestic activity -- not only is china worried about liberal academics, but also
students, who have historically been leaders in pro-democracy movements as recently as this
past summer with the occupy central protests in hong kong.
tactics, techniques, and procedures of axiom
a wide range of mechanisms are used to reach the stage of an operation where hikit is
deployed. observed methods include the traditional use of spear phishing, leveraging of generic
and strategic website compromises, and targeted attacks against public facing infrastructure.
one of the many disturbing attributes of axiom and their affiliated groups is their ability to create
and leverage large pools of compromised machines, sift through them to identify the
organizations of interest, and quickly (within hours or days) begin secondary follow-up
exploitation operations. this rapid transition from identification to action on the objective
demonstrates the level of sophistication and focus of these actors; it also suggests an integrated
targeting element, with possible inputs from an authoritative tasking entity, which is responsible
for issuing dynamic taskings. this modus operandi does not suggest that axiom relies solely
upon casting a large net for victimization, rather that the axiom actors have a well-established
tradition and capabilities that support focused targeting of both individuals and organizations.
once inside an enterprise, axiom begins reconnaissance almost immediately to establish where
they are in the target s network, and to identify any changes that have been made to the
environment. once this initial reconnaissance stage has been completed and the information is
collected, axiom typically moves quickly to escalate privileges on compromised machines via
previously compromised administrative accounts, local exploits, or remote exploits as
demonstrated in the zoxrpc malware. this escalation of privileges is typically in an attempt to
dump the latest credentials they can gain access to on the victim network. this information is
quickly accessed, compressed, encrypted, and exfiltrated by the actors. the turnaround for the
use of this information after collection can vary from minutes to months.
the axiom threat actor group has also demonstrated the operational flexibility of leveraging
systems administration tools available within targeted organizations (e.g., remote desktop
protocol (rdp), remote administration tools). it has been observed several times that axiom
operators have even leveraged these capabilities as a means of maintaining additional
persistence via setting sticky keys for rdp sessions. they also use custom tools containing
network and local exploits, hacking utilities, and legitimate security tools for privilege escalation
and lateral movement. by leveraging tools already available within a target organization axiom,
can forgo the need to potentially raise their profile by deploying additional malware that may
trigger antivirus or ids indicators. as a typical scenario when compromising an organization,
this actor group will aim to orient themselves, move laterally, escalate privileges, dump19
credentials, and install other families of malware to hedge against detection of any one variant
of their malware.
it has been observed in many of axiom s victim environments that the total number of malware
families leveraged can exceed four separate layers of malware. these families of malware
range in uniqueness from extremely common (poison ivy, gh0st, zxshell) to more focused
tools used by axiom and other threat groups directed by the same organization (derusbi, fexel)
to tools only seen used by axiom (zoxpng/zoxrpc, hikit). this is likely done to ensure a
certain level of persistence and redundant command and control should one of the families ever
become compromised. additionally, once into later stages of their operations, axiom operators
will create and deploy shell utilities that are customized to the operational environment.
operators will also install data archival and compression tooling that may not already exist on
the target machine. the flexibility and fluency of axiom s toolset, including the ability to produce
custom tools, is yet another indicator of the technical and operational sophistication of this
entity.
in support of this flexible tooling capability, axiom has demonstrated a relatively sophisticated
use of large amounts of legitimate and compromised internet infrastructure. axiom has been
observed grooming and leveraging an array of compromised proxy infrastructure within the
united states, south korea, taiwan, hong kong, and japan. novetta has observed indications
in various datasets that this compromised infrastructure can be created per campaign or target,
or can be shared within a cluster of related targets. it is surmised that this method is a means to
create confusion for any investigation into activity related to an axiom intrusion, by leveraging
the capabilities of axiom tools and interweaving legitimate traffic to the same ip address during
the compromise. the net effect of this tactic is to create a set of network traffic that at first
glance appears to be legitimate traffic.
beyond this generally stealthy technique for hiding malicious traffic, the ability to have access to
a continual pool of compromised infrastructure in which to overlay their operations speaks to the
ability of axiom actors. they do not just comprise various internet facing platforms, but also
have the organizational ability to deal with the capture, grooming, and maintenance of a large
set of compromised infrastructure while in parallel executing technical operations and creating
new targeting information for pursuit. on top of axiom s usage of compromised infrastructure
they also maintain supporting infrastructure accounts, such as dynamic dns services, and
vps/hosting providers from a variety of united states and chinese providers. this ability to
leverage both compromised and legitimate infrastructure enables axiom to adjust to a target s
security posture and potentially extend their access to a targeted organization.
victim life cycle
based on observed victim environments infiltrated by axiom, novetta believes that there are at
least six separate tiers of responsibilities that service different stages of the victim lifecycle.20
axiom, for its part, largely conducts operations in later stages of the overall victim
compromise. currently, we believe that the victim lifecycle is split into the following stages:
stage 0: target identification and reconnaissance
stage 1: initial access, validation and internal target reconnaissance
stage 2: lateral movement, and creation of additional footholds
stage 3: compromised infrastructure creation and grooming
stage 4: stealthy identification and exfiltration of targeted data
stage 5: maintain access and understanding of environment
the level of sophistication seen by this multistage life cycle implies a number of things about the
adversary s ability to command resources and coordinate within itself. it is this structure and
coordination that truly sets axiom and its associated groups apart from other actors in this
space.
structure of adversary
we also assess that different groups associated with the axiom threat actor group likely
perform various phases. this deduction is supported by the number of differences in the
observed activity during these compromise stages which suggest a number of separate teams
with varying responsibilities during their operation lifecycle. for instance, examinations of
differences in command and control (c2) and midpoint proxy infrastructure displayed by the
stage 1, stage 2 and stage 4 binaries have led us to believe that the operational tempo,
security policies, and acceptable risk levels are drastically different. this coordination of
different operators, infrastructure, and tools between stages in the same environment suggests
a common operating picture within a large organization.
it cannot be overstated that the operational timelines observed imply that axiom and other stage
operators operate with a cohesive long-term strategic goal. the ability of any organization to
consider strategic objectives over a multi year period implies that organization both believes that
their operations will have far reaching effects, and that the organization itself will exist for an
extended time. extended operations require meaningful resources, both in terms of financial
capital (salaries), as well as physical resources (money for vps s and traditional server
infrastructure), as well as a logistic overhead for coordinating, planning, and researching attack
vectors, creation/purchasing and distribution of 0-day exploit code and associated exploit
frameworks34, and campaign coordination between subgroups.
finally, threat actors at all the described stages, including axiom, display a clear level of
discipline in using their compromised resources. there is no meaningful level of information
leakage due to resource access, or due to visiting personal websites with these resources.
while this level of discipline has been observed outside of governmental organizations and
funded operations, it displays a level of familiarity with investigative and forensics operations
that clearly sets them apart from the less sophisticated threat actors.
command and control (c2) infrastructure
the infrastructure practices of these linked groups often change depending on the current stage
of operation as well as the intended target, ultimately culminating in axiom operations. a good
example would be the watering hole attacks observed targeting japanese entities in 201335.
because broad-spectrum watering hole attacks are widely noticed and reported on, stage 1
operators appear to have heavily segregated their infrastructure from the infrastructure used
during later stages of operation in order to better evade detection.
operation smn partners have a great deal of insight into the network characteristics and c2 of
the stage 2 tools and techniques (i.e., derusbi, hydraq, deputydog) which serve as secondary
persistence and lateral movement tools. here, unlike stage 1, the tools frequently reuse
infrastructure and other resources, and there is even some historical overlap between second
level domains used by the stage 2 actors and the stage 4 operators (axiom). isight partners reporting has discussed the usage of domains in watering hole attacks that have been used to
gain initial access to target networks for later stage persistence. passive dns analysis has
demonstrated that the linkages between stage 2 and stage 4 c2 domains are indirect, but
present, establishing a possible link between the stages. unlike other threat actors, operators of
all stages, particularly from stage 3 onwards, take operational practices and security seriously.
there was no observed activity outside of campaign activity on the identified operational
infrastructure across 76 unique stage 4 campaigns.
for stage 3 and 4 operations, axiom is believed to have established a complex c2
infrastructure, which, based on campaign identifiers extracted from configuration files embedded
in hikit binaries, has been used to manage at least 76 unique campaigns that this operation has
discovered. operation smn partners believe that many more organizations have been affected
by axiom, but are currently unaware of any compromise due to axiom s hyper targeting and
stealth at this stage of activities. we hope that by highlighting some of axiom s techniques,
tactics, and procedures we will increase the visibility of this group for awareness and detection.
the curated infrastructure that appears to be used strongly suggests that the axiom actors are
given the capacity and mandate to target and develop long-term strategic assets. within
observed compromises, axiom actors have been seen performing complex actions with their c2
infrastructure during the stage 4 operational cycle. configuration files extracted from hikit
binaries indicate that c2 callback locations are tailored to the specific country and network
environment in which the target resides. c2 domains will consistently be named and hosted in
such a way that traffic appears legitimate, likely in an effort to fool network security operators of
target organizations. axiom and its linked groups have been known to conduct extensive
research prior to compromising a target in order to determine ideal hosting locations. to achieve
this, these threat actors often compromise secondary targets in order to obscure their c2
infrastructure and data exfiltration endpoints from their intended victims.
additionally, past attacks have displayed that these linked groups are capable and willing to
construct supply-chain attacks to allow them access to hardened targets. these supply-chain
attacks will extend to elements of the target s security supply chain. the observed tempo in
these supply-chain attacks suggest that axiom operators are capable of coordinating rapid
responses to roadblocks in their goals, even when those roadblocks represen sophisticated
security organizations, such as bit9.
hikit command and control (c2) configuration
axiom s rather distinct network operations and ttps for setting up c2 infrastructure separate
them from other threat actors. in particular, axiom s midpoint centric c2 infrastructure has
resulted in unique fingerprints. each hikit binary is configured for a specific target, often
included in or referenced within the campaign indicator field of the respective configuration file.
hikit operators (axiom) appear to use a significant amount of c2 infrastructure isolation between
targets, with different targets rarely sharing identical c2 locations. this isolation provides a high
degree of resiliency and operational security in the event that one operation becomes
compromised, other operations are less likely to be interrupted or affected.
it is important to note that prior to hikit generation 2, we have no direct evidence of any c2
infrastructure due to the nature of hikit generation 1 s functioning. during the transition between
the generation 1 and generation 2 codebases, hikit development teams made the decision to
include an embedded configuration file in the binary itself. the first evidence of hikit samples
containing this configuration information, with embedded c2 information, appears to have been
initiated on april 12, 2012.
during this time, two stages of hikit binary creation were observed. during their initial stage of
work (those binaries with compile dates prior to april 2012), axiom appeared to use both
traditional dns hosting services and dynamic dns services equally. while axiom did not
appear to have any obvious criteria for deciding which dns provider would be used during this
period, a preference for using dnspod (a chinese-based dns provider) and dtdns (a usbased dynamic dns service) was clear. the reasons for the selection of dtdns are unknown at
this time but, the selection of dnspod can be assumed to be due to the geographic location of
the provider itself. the use of dynamic dns services is interesting, due to the confounding
effect that it generally has on investigations. after 2012, however, we have observed a general
avoidance of dynamic dns services.
naming conventions of these hikit domains is also notable due to the pattern that defines them.
under almost all conditions, the domains are expressed as a 3ld format, where the youngest
child domain represents the intended campaign target. as an example, the domain format for
acmeinc would be acmeinc.basedomain.tld . this naming convention, as well as the usage of
dns providers, is exclusive to stage 4 infrastructure. in fact, for all stage 3 cases, no second
level domain is directly used. instead, whenever malicious activity is observed, it can only be23
strongly correlated to the child domain (of the dnspod domains), while the second level
domain remains relatively static and clean in asian geographic locations.
historical examination of the base second level domains base, however, suggests that the
second level domains were once used to launch attacks, similar to those domains seen in stage
2 operations. as this activity was last observed in 2010, it is theorized that current operational
strategies were then developed and adhered to.
as noted above, most of the observed hikit (stage 4) campaigns rely on dns services for c2
location and coordination. while the a records for the child domains of the mothership (second
level domain) dns names are typically located on compromised infrastructure as previously
discussed, there are a few identifying characteristics which have been noted. firstly, these
domains have extremely short times of existence within the us. secondly, they display long
distance relationship behavior, wherein they have ns records in countries outside the location
of the child domain. heuristic detection for candidate c2 domains involves looking for domains
that have had rdata that exhibits travel between geographically disperse countries, and
correlating that towards displayed naming and linguistic characteristics of the domain names.
hikit binaries have also been observed as members of complex internal routing structures for
the purposes of stealthy data exfiltration as well as access and persistence to internal
resources. this activity is rarely caught in practice, as many security teams neglect to perform
flow analysis on internal-to-internal network traffic.
at all points during axiom stage 4 infections, evidence suggests that there are humans directly
orchestrating operations. stage 1 and stage 2 operations may have varying levels of human
involvement. as a result, exhaustive lists of domain names and ip s used in c2 operations are
somewhat useless; blacklisting will be ineffective and present a large amount of collateral
damage due to the use of compromised infrastructure. interestingly, despite the general
usefulness of large scale passive dns analysis in most threat research, there are indications
that many of the hits for axiom c2 domains in this research exist because of independent
security researchers or it security teams conducting investigations. this activity, while reliable
for observing network c2 behavior, does make operational end dates difficult to determine for
stage 3 and 4 campaigns.
remediation
currently, organizations that wish to protect themselves from the malware that axiom has been
observed using should download and utilize the latest msrt release. this tool has been
verified to provide protection against malware families that axiom favors, and is freely available
to all microsoft installations. it is suggested that enterprise organizations push out and execute
msrt on a monthly basis. additionally, all members of the operation smn group have up-todate signatures and heuristics for detecting the axiom malware families, as well as any vendors
involved in microsoft s via program.24
it is strongly advised that organizations seeking protection from axiom avoid the temptation of
solely deploying network based signatures. because axiom continually creates new c2
infrastructure for each new target and can quickly transition to new malware tooling, it is very
unlikely that existing network iocs will offer any meaningful level of protection for organizations
whose infections are new or previously undiscovered.
network operators can and should learn from the axiom group s tradecraft; security teams and
it staff should be especially wary of any traffic going to destination servers that does not match
the apparent intent of these servers. for example, large data transfers moving towards dns
nameservers on port 53 with no observable dns content that are associated with known or
related partners should be viewed as suspect. hikit s usage of internally routed proxy nodes can
complicate this task, and only advanced network analytics that includes a holistic view of
internal and external network traffic can provide anything near 100% certainty. network
boundaries of all types should be monitored. if an internal network can route from restricted
zones to ones of lower restriction, it should be monitored for data exfiltration in the same
manner as a traditional border network. above all there is absolutely no substitute for continued
vigilance -- by the time hikit is installed on a victim s infrastructure, the operation is in its final
stages, and the attackers generally have free reign over the victim network.
enterprises are advised that while axiom represents an advanced attacker, their power comes
from their discipline and logistics. ultimately, the removal of common low hanging fruit in
network and endpoint security will go far to prevent axiom from easily accessing networks.
additional suggestions for protection against axiom s attacks would be:
block or sinkhole the dnspod name servers. dnspod seems to be the preferred
provider for dns services for axiom, and many organizations can block these resources
without adverse effect on business needs.
install and execute microsoft s emet on endpoint machines, and configure it to your
environment.
globally edit windows policies to disable the sticky keys functionality.
restrict all remote access (rdp, ssh, citrix, vpn, etc.) and ensure that this access is
only given to people that need it versus by default for the whole company; wherever
possible, implement two-factor authentication for any remote access.
keep strong monitoring on vpn endpoints -- axiom has demonstrated the ability to enter
networks after compromising vpn client user credentials.
two-factor protection to webmail services should be added where possible.
ensure that local administrative accounts are not universal across your network, as a
single compromise can bring the security of the entire network into question. ensure that
local firewalls are configured and restrict access to both servers and workstations to only
those subnets and users that require it.
implement application whitelisting to prevent execution of unauthorized executables --
microsoft applocker, bit9, and other third party solutions are all improvements over
default installations without whitelisting.
encrypt e-mail where possible, even between internal users.25
ensure antivirus software is reporting to a central, monitored location. axiom s binaries
can flag antivirus rules that end up ignored, a security failing that they rely on.
ensure proper auditing and review of security firewall rules, antivirus updates, ids
signatures, and other security controls. axiom actors during active compromises have
been observed to disable key signatures or rules to force victim organizations to lose
visibility.
apply security patches in a timely manner. while axiom does make use of 0-day
vulnerabilities, the group has also used disclosed, patched vulnerabilities that are found
on outdated systems in a target s network.
reference information provided by the fbi in their flash report - additional remediation
information and suggestions are included36.
operation smn and the subsequent actions taken by the group members could not have
occurred without the generosity and talent of several organizations. while the publicly
acknowledged members of the group made critical contributions there are other firms that were
critical to the findings contained in this report. their datasets, services, and software allowed
coalition members to construct a substantially stronger case than would have been otherwise
possible. farsight security generously provided novetta with unrestricted access to their
historical passive dns dataset, allowing analysts to investigate the c2 infrastructure used by
axiom over a wide window of time. endgame provided novetta with extensive proprietary threat
data and analytical processing capabilities allowing novetta to gain a deeper insight into
compromised network footprints. novetta would also like to thank those organizations and
individuals who quietly contributed to the content covered in this report.27
appendix a: malware key findings
in the case of axiom, the actors will utilize an array of capabilities, some more unique than
others, for various phases of their exploitation operations. the following capabilities are general
a general list of the backdoors leveraged by this threat.
poison ivy
gh0st rat
plugx
zxshell
hydraq/9002 rat
deputydog / fexel
derusbi
hikit
zoxfamily (zoxpng, zoxsmb, etc)
hikit generation 1
capability features:
file management: upload and download
remote shell
network tunneling (proxying)
ad-hoc network generation (connecting multiple hikit infected machines to create a
secondary network on top of the victim's network topology)
no config stored in sample, no command line parameter passing of c2 (listens for magic
bytes)
interesting facts:
relies on a ndis (network) driver to communicate between the network and the
malware
the infected machine acts as the server while the controlling machine is the client ,
therefore at least one hikit infection must be on an internet facing machine
contains no configuration information at all
the ndis (network) driver is a mixture of several open source pieces of code, most
notably the passthru ndis driver example from a 2003 blog37.
the client authenticates to the server at the ndis driver layer by providing a specific set
of strings that mimic http requests
authors routinely forgot to remove the pdb strings revealing at least two compile
machines
earliest known variants from early 2011
hikit generation 2
capability features:
file management: upload and download
remote shell
network tunneling (proxying)
ad-hoc network generation (connecting multiple hikit infected machines to create a
secondary network on top of the victim's network topology)
interesting facts:
comes in 64-bit and 32-bit versions depending on the target's infrastructure
32-bit versions use a rootkit driver to hit the malware process, network endpoints,
registry keys and files.
the rootkit is based heavily on the agony rootkit which is open source
unlike gen1, the malware acts as a client to the c2's server.
uses the same xor encryption scheme as gen 1
developmental overlap found between gen 1 and gen 2 (new gen1 sample found
during the gen 2 time span)
has at least 5 known sub-generations with the gen 2 lineage
spanning from late 2011 to 2013
zox family
capability features:
basic file management: upload, download, create directory, list
write files, delete files, move files
enumeration of attached drives
process management: list processes, kill process by pid
ability to run arbitrary code from c2
remote shell
some samples appear to have exploit/spreading capabilities
interesting facts:
evidence suggests that zox has variants dating back to at least 2008, and may have
multiple generations, and may have evolved from a simple spreader into something a bit
more rat like.
uses png file format as the carrier format for data to and from the c2
the sample from 2008 uses smb to communicate indicating it was originally a local
exploitation tool instead of a remote tool
does not contain any c2 information as the attacker must provide the information at
runtime via the command line29
evidence in zox family of tools suggests a focus on china, taiwan, us/uk, korean
language sets for exploits offsets leveraged in spreading functionality.
was observed being leveraged by attackers via base64 encoded cab file that was then
installed via a login script for a specific user. very few samples have been found
compared to all the other malware families the effort is tackling.
derusbi (server variant)
capability features:
file management: upload, download, create directory, list files, enumerate entire folder
trees, move files, delete files, rename files, get file attributes, mimic timestamps of other
files (e.g. copying the timestamp of to another file to allow for blending in)
derusbi may have a windows gui component for the operator (based on file system
behavior, and patterns of use).
remote shell
basic (limited) network proxying
interesting facts:
uses a 64-byte handshake of seemingly random data with four bytes specifically
configured to act as the handshake
the infected machine acts as the server while the controlling machine (the attacker's
machine) is a client (the reverse of typical malware communication)
does not contain any configuration information related to the attacker's ip, only contains
the campaign code
appears to be able to co-exist with other running services on the same port
[unconfirmed, but speculated based on network capture evidence]30
appendix c: signatures
yara signature links:
signatures from novetta and threatconnect can be directly downloaded
ids signatures
as detailed here38, cisco, as a member of the overall coalition has released ids signatures for
their products.
similar signatures that cover the tools used by axiom can be obtained via the emergingthreats
open signature set below39. novetta is working with both partners to insure that the signatures
they have provide the best coverage possible.
appendix d: malware names index
operation smn name other industry names
hydraq mcrat, hydraq/hidraq, naid, homux,
homeunix, mdmbot, roarur
gh0st moudoor, mydoor
plugx korplug, sogu, kaba, destroyrat, tvt,
thoper
poison ivy breut, darkmoon
derusbi photos, etso, ocrums, win32.agent.dbwr
hikit hikiti
fexel deputydog
zoxpng gresim
zoxrpc
appendix e: malware hashes
to the best of our abilities, novetta has filtered some of the sample hashes collected from the
below sample hashes. this has been due to the highly targeted nature of some of the malware
samples operation smn has collected. the defensive value of knowing those samples or the
hashes for organizations other than the targeted is nil given the technical information produced
and shared by this effort. the below hashes are for sample families that leverage shared
generic infrastructure between multiple compromised infrastructure or contain no configuration
information in the binary.