fireeye has discovered a campaign leveraging the recently announced zero-day cve-2013-3893. this campaign, which we have labeled operation deputydog', began as early as august 19, 2013 and appears to have targeted organizations in japan. fireeye labs has been continuously monitoring the activities of the threat actor responsible for this campaign. analysis based on our dynamic threat intelligence cluster shows that this current campaign leveraged command and control infrastructure that is related to the infrastructure used in the attack on bit9. campaign details on september 17, 2013 microsoft published details regarding a new zero-day exploit in internet explorer that was being used in targeted attacks. fireeye can confirm reports that these attacks were directed against entities in japan. furthermore, fireeye has discovered that the group responsible for this new operation is the same threat actor that compromised bit9 in february 2013. fireeye detected the payload used in these attacks on august 23, 2013 in japan. the payload was hosted on a server in hong kong and was named although it had a file extension, it was not an image file. the file, when xored with , was an executable
in order to maintain persistence, the original malware adds this registry key: the registry key has this value: the unique http header agtid: contains 8 characters followed by 08x . the same pattern can be seen in the post content as well. a second related sample was also delivered from on september 5, 2013. the file was a malicious executable with an and it communicated with the same communications protocol described above to the same command and control server at . related samples these samples both had a string that may have been an artifact of the builder used to create the binaries. this string was dggydsyrl , which we refer to as deputydog . as such, we developed the following yara signature, based on this unique attribute: rule apt_deputydog_strings
according to bit9, the attackers that penetrated their network dropped two variants of the hikit rootkit. one of these hitkit samples connected to a command and control server at downloadmthat resolved to . this same ip address also hosted , a known malicious domain, between march 6, 2012 and april 22, 2012. the domain yahooeast[.]net was registered to 654@ . this email address was also used to register blankchair[.]com the domain that we see was pointed to the , which is the callback associated with sample , and has been already correlated back to the attack leveraging the zero-day vulnerability. threat actor attribution deputydog conclusion while these attackers have a demonstrated previously unknown zero-day exploits and a robust set of malware payloads, using the techniques described above, it is still possible for network defense professionals to develop a rich set of indicators that can be used to detect their attacks. this is the first part of our analysis, we will provide more detailed analysis on the other components of this attack in subsequent blog post.
