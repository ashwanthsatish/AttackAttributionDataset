analysis summary
visualization of open source intelligence on apts reveals overlapping infrastructure, tools, and exploits used in the voho campaign and operations aurora, deputydog, and ephemeral hydra.
two vulnerabilities were identified as exploited by hidden lynx in its voho campaign (2012) and the elderwood gang responsible for operation aurora (2010). command and control infrastructure was also shared between hidden lynx and threat actors responsible for two campaigns during 2013: operation deputydog and operation ephemeral hydra.
threat intelligence derived from disparate open web sources bolsters security efforts by identifying and contextualizing links between threat actors.
when the new york times and mandiant last year unmasked a large scale chinese hacking operation, pinpointing its location down to the building, the report drew mainstream attention to what security professionals already well knew: sophisticated threat actors carry out persistent cyber operations over months and years. this post illustrates how open source intelligence (osint) from the web is not only useful but crucial to threat intelligence teams analyzing advanced persistent threats. through osint analysis, we discover clues to apt attack methods that link together the research of independent threat intelligence teams, suggesting new lines of analysis that were not prominent when looking at the work of any single threat intel team in isolation. we will detail how the c&c infrastructure and tools used by hacker group hidden lynx during its voho campaign (2012), excellently documented by symantec researchers last september, overlap with tools used in other high profile operations during the past few years. the other campaigns evaluated are operation aurora (2010), operation deputydog (2013), and ephemeral hydra (2013). history of hidden lynx malware
security researchers have shown time and again that cyber actors frequently recycle effective attack methods. these attack methods retain telltale signatures even as a threat actor s targeting and tools evolve. therefore, our investigation looked for clues that linked hackers across one or more of the campaigns in question. seeking to tease out any possible links between operation aurora, voho, operation deputydog, and ephemeral hydra, we began with symantec s hidden lynx report as our foundation. the authors of that report identify three primary tools used in the campaigns attributed to hidden lynx: trojan.naid, backdoor.moudoor, and backdoor.hikit. using recorded future, we quickly built a timeline of the reported use of those tools in major security incidents, finding many events prior to the early 2013 expos on hidden lynx. timeline of hidden lynx malware tools click image for larger view
connecting the dots
our analysis, based solely on information openly available on the web, builds on significant technical research that has explicitly linked elements of the aforementioned campaigns. in particular, fireeye during the fall of 2013 called out infrastructure overlap between ephemeral hydra and deputydog. aspects of these two campaigns used tools and c&c infrastructure reportedly used by hidden lynx. these include a hydraq/mcrat variant with lineage traceable to aurora. symantec during 2012 linked the elderwood project to operation aurora; trojan.naid and backdoor.moudoor were also used in aurora, by the elderwood gang, and by hidden lynx. a brief summary of targets for each campaign: aurora: technology, finance, energy and defense
elderwood: defense and supply chain
voho: government, defense, and education (hidden lynx separately targeted finance)
deputydog: government (japan and china)
ephemeral hydra: government and defense
much of the above was well documented. however, some connections described over the course of several years, oftentimes by different research teams published across a variety of sources, are difficult to recall or might even be obscured by more recent information. what links did we discover in analysis using recorded future? two vulnerabilities were found to be exploited by both the elderwood gang and hidden lynx:
one of those common exploits, targeting cve-2012-1889, was on november 22, 2012 reportedly added to the popular gong da exploit kit.
three c&c servers were known to be shared between voho and various elements of operation deputydog and operation ephemeral hydra:
backdoor.hikit, which appears to have been developed post-operation aurora, was used in both voho and deputydog campaigns.
reported use of the hydraq trojan from aurora (2010) fell off until september 2012. the delivery method appears to have then switched from spearphishing to a watering hole attack when a variant of hydraq was discovered in ephemeral hydra during november 2013.
network of hidden lynx malware tools the above network shows relationships between three tools used by hidden lynx during its voho campaign: trojan.naid, backdoor.moudoor, and backdoor.hikit. the connections indicate actors, targets, vulnerabilities, and technical information related to those tools. note the density of connections between moudoor and naid, which are commonly reported as complementary tools. trojan.naid specifically was used to attack security firm bit9 ultimately compromising its digital code signing certificate. this allowed the hackers to then take on higher value targets as part of the voho campaign. naid was also used in the 2010 campaign known as operation aurora. one of the key findings noted above was the identification of two vulnerabilities that were exploited by both hidden lynx and the elderwood gang, which has been linked to operation aurora. are at the center of the network below, surrounded by targets and other related vulnerabilities. network of hidden lynx and operation aurora vulnerabilities after visualizing these links, we explored the vulnerabilities at the edges of the graph, looking for connections with exploits used in other campaigns. we found such a link in cve-2013-3893, which was leveraged in the august 2013 attacks on japanese targets that fireeye dubbed operation deputydog. similar to our approach with symantec s report on hidden lynx, we used recorded future to organize the technical details about the deputydog attacks to reveal technical information described in the open source reporting across multiple campaigns. network of deputydog details the above network shows technical details and locations, both server hosts and targets, related to operation deputydog. this enabled creation of useful lists for us to seek overlap with other operations, establish the timing of exploits and c&c infrastructure used, and arrange alerts for ongoing monitoring. to wrap up our investigation, we built a timeline of events related to the ip addresses associated with both hidden lynx campaigns as well as operations deputydog and ephemeral hydra. the timeline details events related to the three previously cited ips used in both the bit9 attacks and either deputydog or ephemeral hydra. analysts were able to track to an email address linking deputydog and the hidden lynx voho campaign. separate analyses in november 2013 describe c&c servers used by trojan.apt.9002 also used in the hidden lynx attacks against bit9. timeline of ips for operations deputydog and ephemeral hydra revealing links and context with web intelligence
this investigation sheds new light on these campaigns, without depending on private or freshly disclosed technical intelligence. once assembled and structured for analysis, the collective knowledge about hidden lynx and many other apt campaigns, some publicly available for years, allows us to better understand intent and capabilities. we often hear leaders lament the present state of intelligence sharing, and advocate for new approaches with hold great promise. meanwhile, large amounts of intelligence are already being shared in open source reporting. to yield insights, we must deal with great variety in sources and formats. the above data points were derived from pdfs, blog posts, and write ups from security firms coming from hundreds of websites. recorded future captures and structures that information, and provides analytic tools to help quickly make sense of this information from disparate sources. the results of such threat actor and campaign analysis, corroborating evidence across multiple sources and linking technical details across security blogs, social media, and research forums, are insights that are useful from incident response to threat intelligence.
