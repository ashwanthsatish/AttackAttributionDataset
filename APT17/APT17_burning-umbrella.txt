key judgements
we assess with high confidence that the winnti umbrella is associated with the chinese state intelligence apparatus, with at least some elements located in the xicheng district of beijing. a number of chinese state intelligence operations from 2009 to 2018 that were previously unconnected publicly are in fact linked to the winnti umbrella. we assess with high confidence that multiple publicly reported threat actors operate with some shared goals and resources as part of the chinese state intelligence apparatus. initial attack targets are commonly software and gaming organizations in united states, japan, south korea, and china. later stage high profile targets tend to be politically motivated or high value technology organizations. the winnti umbrella continues to operate highly successfully in 2018. their tactics, techniques, and procedures (ttps) remain consistent, though they experiment with new tooling and attack methodologies often. operational security mistakes during attacks have allowed us to acquire metrics on the success of some winnti umbrella spear phishing campaigns and identify attacker location with high confidence. the theft of code signing certificates is a primary objective of the winnti umbrella s initial attacks, with potential secondary objectives based around financial gain. report summary
the purpose of this report is to make public previously unreported links that exist between a number of chinese state intelligence operations. these operations and the groups that perform them are all linked to the winnti umbrella and operate under the chinese state intelligence apparatus. contained in this report are details about previously unknown attacks against organizations and how these attacks are linked to the evolution of the chinese intelligence apparatus over the past decade. based on our findings, attacks against smaller organizations operate with the objective of finding and exfiltrating code signing certificates to sign malware for use in attacks against higher value targets. our primary telemetry consists of months to years of full fidelity network traffic captures. this dataset allowed us to investigate active compromises at multiple organizations and run detections against the historical dataset, allowing us to perform a large amount of external infrastructure analysis. background
the winnti umbrella and closely associated entities has been active since at least 2009, with some reports of possible activity as early as 2007. the term "umbrella" is used in this report because current intelligence indicates that the overarching entity consists of multiple teams/actors whose tactics, techniques, and procedures align, and whose infrastructure and operations overlap. we assess that the different stages of associated attacks are operated by separate teams/actors, however in this report we will show that the lines between them are blurred and that they are all associated with the same greater entity. the winnti and axiom group names were created by kaspersky lab and symantec, respectively, for their 2013/2014 reports on the original group. the name winnti is now primarily used to refer to a custom backdoor used by groups under the umbrella. multiple sources of public and private threat intelligence have their own names for individual teams. for example, lead is a common alias for the group targeting online gaming, telecom, and high tech organizations. other aliases for groups related include barium, wicked panda, gref, passcv, and others. this report details how these groups are linked together and serve a broader attacker mission. the many names associated with actors in the greater intelligence mission are due to the fact that they are built on telemetry of the intelligence provider which is typically unique and dependent on their specific dataset. this report focuses heavily on networking related telemetry. we assess with high confidence that the attackers discussed here are associated with the chinese state intelligence apparatus. this assessment is based on attacker ttps, observed attack infrastructure, and links to previously published intelligence. their operations against gaming and technology organizations are believed to be economically motivated in nature. however, based on the findings shared in this report we assess with high confidence that the actor s primary long-term mission is politically focused. it s important to note that not all publicly reported operations related to chinese intelligence are tracked or linked to this group of actors. however, ttps, infrastructure, and tooling show some overlap with other chinese-speaking threat actors, suggesting that the chinese intelligence community shares human and technological resources across organizations. we assess with medium to high confidence that the various operations described in this report are the work of individual teams, including contractors external to the chinese government, with varying levels of expertise, cooperating on a specific agenda. in 2015 the people s liberation army of china (pla) began a major reorganization which included the creation of the strategic support force (ssf / plassf). ssf is responsible for space, cyber, and electronic warfare missions. some of the overlap we observed from groups could potentially be related to this reorganization. notably, key incident details below include attacker mistakes that likely reveal the true location of some attackers as the xicheng district of beijing. tactics techniques and procedures (ttps):
though the ttps of the attacking teams vary depending on the operation, their use of overlapping resources presents a common actor profile. key interests during attacks often include the theft of code signing certificates, source code, and internal technology documentation. they also may attempt to manipulate virtual economies for financial gain. while unconfirmed, the financial secondary objective may be related to personal interests of the individuals behind the attacks. initial attack methods include phishing to gain entry into target organization networks. the group then follows with custom malware or publicly available offensive tooling (metasploit/cobalt strike), and may use a number of methods to minimize their risk of being detected. such techniques include a particular focus on living off the land by using a victim's own software products, approved remote access systems, or system administration tools for spreading and maintaining unauthorized access to the network. we have observed incidents where the attacker used other victim organizations as a proxy for unauthorized remote access. in these cases, organization 1 had been compromised for a long period of time, and the attacker accessed victim organization 2 via the organization 1 network. delivery and c2 domains routinely have subdomains which resemble target organizations. additionally, their c2 domains are used across many targets, while subdomains tend to be created and removed quickly and are unique to a particular target or campaign. also noteworthy is that the actors set their domains to resolve to when not in use, similar to what was originally reported on by kaspersky lab (see below). the actor often uses tls encryption for varying aspects of c2 and malware delivery. as noted in the infrastructure analysis section of this report, the actor primarily abuses let s encrypt to sign ssl certificates. we also observed many cases in which self-signed certificates were used in attacks. overall, the winnti umbrella and linked groups are lacking when it comes to operational security. however, some activities linked to these groups follow better operational security and infrastructure management approaches. this may be a clue to the division of responsibilities by team and skill level within the broader organization. targets:
the winnti umbrella and linked groups initial targets are gaming studios and high tech businesses. they primarily seek code signing certificates and software manipulation, with potential financially motivated secondary objectives. these targets have been identified in the united states, japan, south korea, and china. based on the infrastructure, links to previous reporting, and recently observed attacks, the broader organization s main targets are political. historically this has included tibetan and chinese journalists, uyghur and tibetan activists, the government of thailand, and prominent international technology organizations. one example of a politically focused lure by the winnti umbrella and linked groups is an end of 2017 document titled resolution 2375 (2017) strengthening sanctions on dpr of korea which is a malicious file associated with the c2 infrastructure described here some key public reports:
kaspersky lab publicly reported on the original winnti group, technical details around the winnti samples, and various honeypot analysis methods. most noteworthy is the winnti umbrella s targeting of gaming organizations in search of code signing certificates, virtual currencies, and updating mechanisms which could potentially be used to attack victims clients. interestingly, this was the first identified trojan for the 64-bit microsoft windows operating system with a valid digital signature as noted by the author. the abuse of signed applications is a very effective attack approach that the entity continues to use. novetta released an outstanding report detailing operation smn, in which they collaborated with a number of private organizations on a large scale malware eradication operation which is linked to the original winnti group by the malware being delivered. in the report, the actor is named axiom. novetta reported links to publications from as far back as 2009 that also link the group to the chinese state intelligence apparatus with high confidence. links exist to various known attacks and actor groups, such as operation aurora, elderwood group s successful 2010 attack against google and many other organizations. another link exists to the successful compromise of the security organization bit9 in 2013, where their own product was used to sign and spread malware to their customers. in addition, fireeye s operation deputydog detailed attacks on japanese targets from the same attacker infrastructure. many other incidents are detailed in the operation smn report. following all of these details back in time, we can see an overlap in ttps and targets from the apt1 report by mandiant, which serves as a great historical example of chinese intelligence cyber operations in their most basic form. cylance released a blog post reporting on digitally signed malware used in targeted attacks against gaming organizations in china, taiwan, south korea, europe, russia, and the united states. cylance refers to the attacking entity as passcv in their reporting. cylance successfully identified a large quantity of malware binaries which were signed with valid certificates stolen from a number of gaming studios in east asia. in addition to detailing the individual certificates and signed malware, they identified a significant amount of network infrastructure which contain various interesting links to our own findings. trend micro reported on attacks that abused github for use in malware command and control, which they attributed to the original winnti group. amusingly, trend micro later reported on an individual linked to the group and the attacks who happens to be a fan of pigs. citizen lab reported on attacks against journalists by an actor mimicking china-focused news organizations hk01, epoch times, mingjing news, and bowen press. as citizen lab noted, these news organizations are blocked in china for their political views. the report notes that malware used in these attacks was linked to a stolen code signing certificate mentioned in the cylance passcv post. that overlap, in addition to infrastructure links from a palo alto unit 42 blog post, strongly links this attack to the previously mentioned reports as well as to our own. as unit 42 reports, the attacks against entities in the government of thailand used the bookworm trojan. protectwise 401trg published our own findings and an update on lead using open source and public tooling in attacks against japanese gaming organizations. these attacks are linked with high confidence to ongoing operations in the united states and east asia. in 2017, multiple supply-chain attacks occurred which had some similarities to the winnti umbrella and associated entities. for example, kaspersky reported on shadowpad, a large-scale compromise of netsarang, which resembles the winnti and plugx malware. in addition, kaspersky and intezer identified notable code similarities to the winnti umbrella and apt17 in the compromise of piriform, which allowed attackers to sign and spread altered versions of the ccleaner software to a large customer base. throughout 2017 and 2018, protectwise 401trg was involved in a number of detection and incident response engagements with our customers that linked back to the winnti umbrella and other closely associated entities. through the analysis of public and private intelligence, we have successfully identified similar attacks, which allow us to assess with high confidence that the details below follow a global attack trend as the chinese intelligence operations have evolved over time. one of the most common tactics used by the winnti umbrella and related entities is phishing users whose credentials may provide elevated access to a target network. we have observed spear-phishing campaigns that target human resources and hiring managers, it staff, and internal information security staff, which are generally very effective. in 2017 the entity focused most of its efforts around technical job applicant email submissions to software engineering, it, and recruiting staff, which we originally reported on at our blog. the phishing lures used multiple languages, including japanese as in the below example: job applicant phishing example the approximate translation is as follows: i saw your job posting. my main languages are object-c, java, and swift, and i have 7 years experience with ruby and 6 years experience with php. i have 5 years experience developing ios apps, as well as android apps, aws, jenkins, microsoft azure, zendframework, and smartphone application payment processing. i also have 5 years experience with mssql, mysql, oracle, and postgresql. please see here: [malicious link] the process that followed a target clicking the malicious link evolved as the attacker progressed through the campaigns. the links consistently sent the victim to a fake resume, but the exact format of that resume changed over time; we have observed resumes being delivered as doc, xls, pdf, and html files. once opened, the fake resumes performed various actions in an effort to download malware onto the victim host. during the same time period, we also observed the actor using the browser exploitation framework (beef) to compromise victim hosts and download cobalt strike. in this campaign, the attackers experimented with publicly available tooling for attack operations. during this infection process, the actor was known to check the target operating system and deliver malware, signed by a previously stolen key, for the appropriate host environment. in some cases, valid apple certificates stolen from victims were used in this process, which linked the attack to additional victim organizations. post-compromise actions by the attacker followed a common pattern. first they attempted to spread laterally in the network using stolen credentials and various reconnaissance efforts, such as manually examining shares and local files. the primary goal of these attacks was likely to find code-signing certificates for signing future malware. the secondary goals of the attackers depended on the type of victim organization, but were often financial. for example, gaming organizations tended to fall victim to manipulation or theft of in-game virtual currencies. non-gaming victims may have experienced theft of intellectual property such as user or technology data. 2018 operations:
more recently, various attack campaigns from the winnti umbrella and associated groups have been very successful without the use of any exploits or malware. phishing remains the initial infection vector but the campaign themes have matured. in 2018, the campaigns have largely been focused on common services such as office 365 and gmail. google account phishing example it is important to note that attackers likely have additional information on their target organizations' preferred email solutions based on previous incidents or open source intelligence. in more recent phishing campaigns conducted by the winnti umbrella and associated groups, url shortening services have been used. for example, google s url shortening service was used over the past weeks, allowing us to gain insight into the scale of this campaign using publicly available analytics. as you can see from the above screenshot, this particular phishing campaign ran from march 20th to march 28th, 2018. notably, the link was created on february 23rd, 2018, indicating roughly three weeks of preparation for the attacks. these metrics allow us to gain insight into who clicked the link in a phishing email and was directed to a phishing or malware delivery landing page. according to google analytics, there were a total of 56 clicks. 29 were from japan, 15 from the united states, 2 from india, and 1 from russia. 33 of the clicks were from google chrome, and 23 were from safari. 30 were from windows os hosts, and 26 were macos hosts. in general, the attackers phish for credentials to a user s cloud storage, and would be expected to later attempt malware delivery in the cases of a failed credential phish or valueless cloud storage. in cases where the victim uses o365 and/or g-suite for enterprise file storage, the attackers manually review the contents for data of value. if code signing certificates are stored here, the primary mission has been accomplished, as they may be easily downloaded. in other cases, the attackers attempt to use other files and documentation in the cloud storage to help them traverse or gain privileges on the network. the targets in 2018 include it staff, and commonly sought out files include internal network documentation and tooling such as corporate remote access software. once the attackers gain remote access to the network via malware or stolen remote access tooling and credentials, the operation continues as we ve seen, though their post-compromise actions have become more efficient and automated. internal reconnaissance is performed by scanning the internal network for open ports 80, 139, 445, 6379, 8080, 10022, and 30304. the choice of ports by the attacker indicates a strong interest in internal web and file storage services. an interesting addition is the use of 30304, which is the peer discovery port for ethereum clients. in the attackers ideal situation, all remote access occurs through their own c2 infrastructure, which acts as a proxy and obscures their true location. however, we have observed a few cases of the attackers mistakenly accessing victim machines without a proxy, potentially identifying the true location of the individual running the session. in all of these cases, the net block was the china unicom beijing network, xicheng district. visualizing attacker infrastructure
based on the various incidents we have been involved in, in addition to past public reporting and open-source intelligence, we can construct a map representing the infrastructure most closely associated with the winnti umbrella and closely related entities. for the sake of producing an accurate representation of the infrastructure, we are excluding any shared infrastructure (such as hosting provider ips used for many unrelated domains) and low confidence indicators. please note this is not an exhaustive list of all active infrastructure in use by the group. as detailed below, this infrastructure spans at least eight years of activity by the winnti umbrella and related groups. please note, as this section heavily references the some key public reports section, above, we recommend reading that first. indicators are provided in appendix a of pdf (see top of page). 1. the area of the map labeled #1 is the phishing, malware delivery, fake resume, and c2 infrastructure. this includes domains, ips, malware hashes, ssl certificates, and whois information. in this section of the infrastructure, we primarily observe the network and file indicators which would be used against targets valued for code signing certificates, software manipulation, and potential financial manipulation. the indicators detailed in the 2017 & 2018 initial target section of this report are located in #1. infrastructure in this area is currently in use and not entirely historical. 2. this area is a network that we assess is associated with the umbrella with low confidence. the most interesting findings here are the large number of let s encrypt ssl certificates in use and the overlap with attacker exclusive infrastructure. this proposed relationship is generated by infrastructure links alone, as no malicious activity has been confirmed to or from region #2. infrastructure in this area is currently in use and not historical. 3. area #3 is linked to the initial attack infrastructure (#1) by domain whois details, likely from operational security mistakes. we assess with high confidence that these infrastructures are linked. based on the lax structure and naming of this section, it is highly probable that it is used for attacker experimenting and development. some examples include domains such as 4. this area has various links to #3 in which an individual software developer is identified. we asses this connection with low to medium confidence and will refrain from publicly sharing details in this report. this area contains many personally operated domains and ssl certificates. infrastructure in this area is currently in use and not historical. 5. area #5 of the map is part of what novetta reported on as operation smn in 2014. infrastructure in this area is purely historical and based on novetta s reporting, which we can link to area #1 via known umbrella infrastructure. the vast majority of indicators in this area are the many associated hashes, combined with their c2 destination domains and ips. 6. this area of the map is what cylance reported on as passcv in 2016. the vast majority of infrastructure and indicators here are stolen code signing certificates, malware signed with the certificates, and c2 domains. this area contains information on many victims of campaigns related to area #1. infrastructure in this area is historical. we assess that this area is linked to the winnti umbrella with high confidence. 7. this section represents infrastructure identified by citizen lab in their july 5th 2017 reporting on attacks against journalists. as they originally identified, one of the netwire binaries was signed with a stolen certificate linked to #6, the cylance passcv report. we were able to further expand this section by pivoting off of additional domain whois information. 8. lastly is area #8, which links back with high confidence to #7 (citizen lab reporting) and #6 (passcv). this area consists of domains, ips, md5 file hashes, and further whois operational security mistakes. this area is similar in functionality to #1 and #3, serving as infrastructure for both high-value politically focused attacks and developer personal use. this section links to the online identities of an individual we asses to be associated with the winnti umbrella or a closely related group at a medium to high confidence. infrastructure in this area is currently in use and not historical. one example of malicious activity in this area was the document detailing the strengthening of sanctions against north korea, above. these activities are similar to the type of politically motivated targeted attacks citizen lab reported on. some infrastructure in this area is currently in use and is not completely historical. map of infrastructure and links investigative findings
based on incident response engagements, research into the associated attacker infrastructure, and previously reported research, we can summarize our findings as follows: 1. the chinese intelligence apparatus has been reported on under many names, including winnti, passcv, apt17, axiom, lead, barium, wicked panda, and gref. 2. the overlap of ttps and infrastructure between the winnti umbrella and other groups indicates the use of shared human and technology resources working towards an overarching goal. operational security mistakes allow the linking of attacks on lower value targets to higher value campaigns. reuse of older attack infrastructure, links to personal networks, and observed ttps play a role in this overlap. 3. the attackers behind observed activity in 2018 operate from the xicheng district of beijing via the net block 4. initial attack targets are commonly software organizations in the united states, japan, south korea, and china. later stage high profile targets tend to be political organizations or high-value technology companies. 5. the attackers grow and learn to evade detection when possible, but lack operational security when it comes to the reuse of some tooling. living off the land and adaptability to individual target networks allow them to operate with high rates of success.
