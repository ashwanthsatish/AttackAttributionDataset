 forkmeiamfamous : seaduke, latest weapon in the duke armory
low-profile information-stealing trojan is used only against high-value targets.
by: symantec security response symantec employee symantec has uncovered an elusive trojan used by the cyberespionage group behind the duke family of malware. seaduke (detected by symantec as trojan.seaduke) is a low-profile information-stealing trojan which appears to be reserved for attacks against a small number of high-value targets. seaduke has been used in attacks against a number of major, government-level targets. the malware hides behind numerous layers of encryption and obfuscation and is capable of quietly stealing and exfiltrating sensitive information such as email from the victim s computer. seaduke has a highly configurable framework and symantec has already found hundreds of different configurations on compromised networks. its creators are likely to have spent a considerable amount of time and resources in preparing these attacks and the malware has been deployed against a number of high-level government targets. while the duke group began to distribute cozyduke in an increasingly aggressive manner, seaduke installations were reserved only for select targets. seaduke victims are generally first infected with cozyduke and, if the computer appears to be a target of interest, the operators will install seaduke. background
the group behind seaduke is a cyberespionage operation that is responsible for a series of attacks against high-profile individuals and organizations in government, international policy and private research in the united states and europe. it has a range of malware tools at its disposal, known as the dukes, including cozyduke (trojan.cozer), miniduke (backdoor.miniduke) and cosmicduke (backdoor.tinybaron). news of the duke group first emerged in march and april of 2015, when reports detailing attacks involving a sophisticated threat actor variously called office monkeys, euroapt, cozy bear, and cozyduke were published. symantec believes that this group has a history of compromising governmental and diplomatic organizations since at least 2010. the group began its current campaign as early as march 2014, when trojan.cozer (aka cozyduke) was identified on the network of a private research institute in washington, . in the months that followed, the duke group began to target victims with office monkeys - and efax -themed emails, booby-trapped with a cozyduke payload. these tactics were atypical of a cyberespionage group. it s quite likely these themes were deliberately chosen to act as a smokescreen, hiding the true intent of the adversary. figure 1. cozyduke campaign used an office monkeys video as a lure july 2014 the duke group has mounted an extended campaign targeting high-profile networks over extended periods, something which is far beyond the reach of the majority of threat actors. its capabilities include: attack infrastructure leveraging hundreds of compromised websites
rapidly developed malware frameworks in concurrent use
sophisticated operators with fine-tuned computer network exploitation (cne) skills
although cozyduke activity was first identified in march 2014, it wasn t until july that the group managed to successfully compromise high-profile government networks. cozyduke was used throughout these attacks to harvest and exfiltrate sensitive information to the attackers. in parallel, the duke group was also installing separate malware onto these networks, namely backdoor.miniduke and the more elusive trojan.seaduke. it could use these payloads to exploit networks on multiple fronts and providing it with additional persistence mechanisms. the miniduke payload
in july of 2014, the group instructed cozyduke-infected computers to install backdoor.miniduke onto a compromised network. miniduke has been the group s tool of choice for a number of years in espionage operations predominantly targeting government and diplomatic entities in eastern europe and ex-soviet states. nemesis gemina appears to be the internal name for the framework used by the group to identify the project, previously reported by kaspersky. the following debug string was present in the sample used in these attacks: c:\projects\nemesis- this project name has been seen in backdoor.tinybaron (aka cosmicduke) samples, which symantec also attributes to the duke group. this deployment of miniduke and the technical similarities with cozyduke provided strong indicators as to who was behind the attacks. the seaduke payload
these attacks were already well underway when another group began to deploy a previously unknown piece of malware. in october 2014, the seaduke payload began to appear within target networks. although seaduke was developed in python, the overall framework bears a striking resemblance to cozyduke in terms of operation. it s unclear why the attackers waited until october to deploy seaduke. was it reserved for a more specific attack? was part of their cover blown, necessitating the use of an alternative framework? the seaduke framework was designed to be highly configurable. hundreds of reconfigurations were identified on compromised networks. the communication protocol employed had many layers of encryption and obfuscation, using over 200 compromised web servers for command and control. seaduke required a significant investment of time and resources in the preparatory and operational phases of the attack. seaduke delivery
the attackers control cozyduke via compromised websites, issuing instructions to infected machines by uploading tasks to a database file. cozyduke will periodically contact these websites to retrieve task information to be executed on the local machine. one such task (an encoded powershell script) instructed cozyduke to download and execute seaduke from a compromised website. seaduke operation
the attackers can operate seaduke in a broadly similar fashion to cozyduke. the seaduke control infrastructure is essentially distinct, opening up the possibility of sub-teams concurrently exploiting the target network. unlike cozyduke, seaduke operators upload task files directly to the command-and-control (c&c) server; there is no database as such present. seaduke securely communicates with the c&c server over http/https beneath layers of encoding (base64) and encryption (rc4, aes). to an untrained eye, the communications look fairly benign, no doubt an effort to stay under the radar on compromised networks. figure 3. how seaduke operates on the target network seaduke has many inbuilt commands which are available to the attackers. they have the ability to retrieve detailed bot/system information, update bot configuration, upload files, download files, and self-delete the malware from the system. the self-delete function is interestingly called seppuku . this is a form of japanese ritual suicide. seaduke payloads
the attackers have also developed a number of additional payloads. operators can push these payloads onto infected machines for very specific attacks. impersonation using kerberos pass-the-ticket attacks (mimikatz powershell)
email extraction from the ms exchange server using compromised credentials
archiving sensitive information
data exfiltration via legitimate cloud services
secure file deletion
what next?
the duke group has brought its operational capability to the next level. its attacks have been so bold and aggressive, that a huge amount of attention has been drawn to it, yet it appears to be unperturbed. its success at compromising such high-profile targets has no doubt added a few feathers to its cap. even the developers reveled in this fact, naming one of seaduke s functions forkmeiamfamous . while the group is currently keeping a lower profile, there s no doubt it will reappear. some tools may have to be abandoned, some reworked and others built completely from scratch. this attack group is in it for the long haul.
