iranian threat agent oilrig delivers digitally signed malware, impersonates university of oxford
posted on january 5, 2017 by clearsky research team
iranian threat agent oilrig has been targeting multiple organisations in israel and other countries in the middle east since the end of 2015. in recent attacks they set up a fake vpn web portal and targeted at least five israeli it vendors, several financial institutes, and the israeli post office. later, the attackers set up two fake websites pretending to be a university of oxford conference sign-up page and a job application website. in these websites they hosted malware that was digitally signed with a valid, likely stolen code signing certificate based on virustotal uploads, malicious documents content, and known victims other targeted organisations are located in turkey, qatar, kuwait, united arab emirates, saudi arabia, and lebanon. fake vpn web portal
in one of the recent cases, the attackers sent the following email to individuals in targeted organisations: the email was sent from a compromised account of an it vendor. similar emails were sent from other it vendors in the same time period, suggesting the attackers had a foothold within their networks, or at least could get access to specific computers or email accounts. the link provided in the malicious email led to a fake vpn web portal: upon logging in with the credentials provided in the email, the victim is presented with the following page: the victim is asked to install the vpn client (an .exe file), or, if download fails, to download a password protected zip (with the same .exe file inside). the vpn client is a legitimate juniper vpn software bundled with helminth, a malware in use by the oilrig threat agnet: if the victim downloads and installs the file, their computer would get infected, while the legitimate vpn software is installed. the legitimate and the malicious installations can be seen in the process tree when the file is run in a cuckoo sandbox. malicious processes are marked red (click image to enlarge): a detailed analysis of the malware is provided in two posts by palo alto networks and in a post by fireeye, which wrote about previous campaigns by this threat agent. (note that juniper networks was not compromised nor otherwise involved in the attack, except for the attackers using its name and publicly available software). digitally signed malware
the entire bundle (vpn client and malware) was digitally signed with a valid code signing certificate issued by symantec to ai squared, a legitimate software company that develops accessibility software: this suggest that the attackers had got a hold of an ai squared signing key, potentially after compromising their network. alternatively, the attackers might have got symantec to issue them a certificate under ai squared s name. [update 11 february 2017: in a notification in its website, ai squared says that the digital certificate used to certify newer zoomtext and window-eyes software products has been compromised. as a result, our certificate will be revoked on or around january 26th ] university of oxford impersonation
the attackers registered four domains impersonating the university of oxford. note that after completing the registration process , the victim is asked to send the form to an email address in oxford-careers[.]com, which also belongs to the attackers. previously the fake website linked to the following documents in a third fake oxford domain, oxford[.]in: the documents were unavailable during our research, and their content is unknown to us. the attackers used a forth domain, oxford-employee[.]com, to host an oxford job application website: when run, the victim is again presented with a tool created by the attackers, this time a university of oxford official cv creator : both samples mentioned in this section had the following domain used for command and control: other incidents
in an earlier incident, the attackers sent a malicious excel file impersonating israir, an israeli airline (the content of the file was copied from the company s public website and we have no indication of it being compromised or targeted): the file had a macro that if enabled by the user would infect its computer.
in other incidents the attackers used the following files:
infrastructure overlap with cadelle and chafer
in december 2015, symantec published a post about two iran-based attack groups that appear to be connected, cadelle and chafer that have been using backdoor.cadelspy and backdoor.remexi to spy on iranian individuals and middle eastern organizations . backdoor.remexi, one of the malware in use by chafer, had the following command and control host: this suggest that the two groups may actually be the same entity, or that they share resources in one why or another.
