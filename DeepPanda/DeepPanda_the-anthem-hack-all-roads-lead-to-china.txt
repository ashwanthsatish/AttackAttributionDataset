february 27, 2015
the anthem hack: all roads lead to china when news of the anthem breach was reported on february 4th, 2015, the security industry quite understandably went wild. a breach of this magnitude was certainly unprecedented. naturally, many industry professionals were keenly interested in digging into this incident to see what could be uncovered, and the research team at threatconnect was no exception. thanks to our powerful api and third-party partner integrations, we were able to use threatconnect to quickly uncover a wealth of intelligence even when initially hindered by a relative lack of investigative lead information and context, a key requirement of any threat intelligence platform (tip). however, before we delve into what we were able to uncover, let's briefly review the facts as they stood in the wake of the initial discovery announcement. on the morning of february 4th, 2015, several major news outlets broke the story that anthem, inc.'s network defenses had been breached. according to a statement from anthem's ceo, the company fell victim to a "very sophisticated external cyber attack," and the hackers "obtained" the personally identifiable information (pii) of approximately 80m customers. this included social security numbers, birthdays, street addresses, phone numbers and income data - plenty of information to enable identity theft. this was a significant event for several reasons: anthem, formerly known as wellpoint, is the largest managed healthcare company in the blue cross blue shield association, and by extension, one of the largest healthcare organizations in the united states. as such, any compromise, no matter how insignificant, would likely impact countless individuals.
blue cross blue shield provides healthcare coverage for about half the u.s. federal workforce. this means that their information was potentially compromised too.
unlike the sony hack which was destructive in nature and meant to send a message for coercive purposes, the anthem compromise was purportedly very covert, a fact which may suggest something about the adversary's motives.
as of late february 2015, there have not been any indications that the exfiltrated pii data was immediately commoditized on the black market for the purpose of enabling identity theft, as was the case in the home depot breach.
filling the gaps:
obviously, these high-level observations do not provide cybersecurity researchers a great deal of information to work with. however, when presented within the context of a threat intelligence platform (tip), an incomplete trail of evidence can highlight intelligence gaps, a study of which can orient threat researchers towards their analytic objectives. to this end, let's examine what we wanted to discover in the context of the anthem breach: who was responsible for the attack?
what was the objective of the attack? was it cyber theft, an espionage operation, or something different?
who was targeted in the attack? the answer to this question, obscured as it may be, would likely shed some light on the objective of the breach.
what was the timeline of the activity?
the real power of a threat intelligence platform is demonstrated when you are able to collect and maintain a robust dataset of threat indicators, both past and present, which can help orient you in the right direction in the wake of a newly discovered breach. even when you do not have a good deal of information to start with (for example a file hash, or an ip address), you may find leads by pivoting through archived datasets until you uncover key pieces of the puzzle. in the case of the anthem breach, we were able to do just that. anthem themed infrastructure & signed malware:
in september 2014, the threatconnect research team observed a variant of the derusbi apt malware family, md5: , which was signed by a valid digital signature from the korean company dtoptoolz co. derusbi is a family of malware used by multiple actor groups but associated exclusively with chinese apt. threatconnect research began tracking the dtoptoolz signature for additional signed malware samples and memorialized them within our threat intelligence platform over time. analyst comment: the dtoptoolz signature has also been observed in association with korean adware that is affiliated with the actual dtoptoolz co. this adware should not be confused with the apt malware that is abusing the same digital signature. later, in mid-november we discovered another implant that was digitally signed with the dtoptoolz signature. this implant, md5: , was from the "sakula" (aka. sakurel) family of malware, a known variant of the derusbi backdoor, and was configured to communicate with the malicious command and control (c2) domains extcitrix.we11point[.]com and www.we11point[.]com. through our farsight security passive dns integration, we uncovered that this malicious infrastructure was likely named in such a way to impersonate the legitimate wellpoint it infrastructure. passive dns and historic domaintools whois data also provided insights that helped establish an initial timeline dating back to april 2014, when the faux domains came into existence and were later operationalized by the attackers. a threat intelligence platform should allow for analysts to easily put together and organize such insights, collaborate around relevant analysis internally, and share the finished analysis with external industry groups and organizations. in the hopes that our community members could benefit from or provide further insight into this suspicious incident, we immediately shared our threat intelligence including indicators, signatures and analytical context to the threatconnect medical and health community on november 13, 2014. this included sending out a notification to all stakeholders as well as our followers on twitter. when the anthem breach later came to light in early february, we re-shared the signatures, indicators and context freely to the entire threatconnect user base. as we dug further, we expanded our understanding of the malicious we11point[.]com infrastructure, taking particular interest to the subdomains such as "extcitrix.we11point[.]com and "hrsolutions.we11point[.]com". note the "citrix" and "hr" (human resources) prefixes that the adversary used to mirror legitimate remote infrastructure and employee benefits resources in the may 2014 timeframe. this provided initial insights as to the likely targeting themes and or vectors in which the adversary may have used when initiating their targeting campaign. wellpoint-evil2legit the fact that the malicious infrastructure closely mirrored other legitimate wellpoint infrastructure supported our hypothesis that the derusbi / sakula malware was configured to operate and persist within a specific target enterprise. possible premera blue cross infrastructure:
retrospective analysis of other targeted malware samples using the dtoptoolz co. digital signature led to the identification of an "httpbrowser" / "httpdump" implant md5: ( ), which was first observed on december 11, 2013. although this malware sample is not derusbi / sakula, it too is strongly believed to be associated with chinese apt activity and in fact may have also been involved in a blue cross blue shield targeting campaign as early as december 2013. premera-update this particular binary is configured to connect to the static ip address 142.91.76[.]134. passive dns of this ip indicates that on december 11th, 2013, the same date as the malware sample was observed, the domain prennera[.]com also resolved to 142.91.76[.]134. it is believed that the prennera[.]com domain may have been impersonating the healthcare provider premera blue cross, where the attackers used the same character replacement technique by replacing the "m" with two "n" characters within the faux domain, the same technique that would be seen five months later with the we11point[.]com command and control infrastructure. section summary:
the derusbi / sakula malware implant types are unique in that they have traditionally been seen within chinese apt espionage campaigns.
the "httpbrowser" / "httpdump" malware implant (while a different family of malware than derusbi / sakula) is also believed to be of chinese origin, and was also digitally signed with the dtoptoolz digitalsignature. this implant connected to a c2 node that overlapped with prennera[.]com.
we believe that the prennera[.]com domain may be impersonating premera blue cross ( ), using a similar character replacement technique seen in the we11point[.]com campaign. vae inc. themed infrastructure & signed malware
another powerful attribute of threatconnect is the ability for analysts to logically group items such as atomic indicators, related documents or signatures, all of which may include individualized custom context enrichments and associations. over time, the ability to memorialize groupings of related or like activity allows analysts to quickly uncover non-obvious relationships within their private datasets. this is exactly what happened as we continued to investigate these incidents. as industry analysts and media speculated chinese apt involvement in the anthem breach, our focus into the derusbi / sakula malware signed with the dtoptoolz co. digital signature shifted from the we11point[.]com incident to another cluster of activity that occurred later in may 2014. we immediately reviewed incident 20140526b: vaeit apt, an incident that we initially shared to our subscriber community on september 29, 2014 after conducting retrospective analysis.
well-vae-overlaps just as was the case with the we11point[.]com and prennera[.]com incidents, the vae, inc. incident is also believed to be associated with chinese apt espionage activity. in this case the adversary also used derusbi / sakula malware that was signed with the dtoptoolz co. digital signature and configured to communicate with faux infrastructure appearing to be masquerading as internal resources for the department of defense contractor vae, inc. additionally, in response to an inquiry from krebsonsecurity, vae, inc. would later confirm that it had indeed been a target of a failed spearphishing attempt in may 2014 which used the malicious faux vae, inc. themed domain. the targeted incident relied upon the sakula executable md5: which had a xor 0x9a encoded c2 callbacks to the ip address 192.199.254[.]126 (registered to wehostwebsites[.]com - "tom yu" of baoan, shenzhen city, guangdong province, china) as well as a hardcoded callback to sharepoint-vaeit[.]com. passive dns of the static c2 ip 192.199.254[.]126 revealed a single suspicious domain of interest - topsec2014[.]com. this domain had historic resolution around may 8, 2014 within a month of the first observed sakula activity using the ip 192.199.254[.]126 as c2. using historic whois, we discovered that topsec2014[.]com was initially registered by li2384826402@yahoo[.]com on may 6th, 2014. although the li2384826402@yahoo[.]com registrant is likely a reseller given that it has been observed registering several thousands of other domains, the fact that it was used to register both the faux vae, inc. c2 infrastructure and the overlapping domain topsec2014[.]com within the same month suggests that there may be a relationship between the client of the reseller for the vae, inc. infrastructure and the client for topsec2014[.]com. topsec2014-hist just four minutes after the initial registration of topsec2014[.]com, the whois records were updated from the initial registrant, li ning - li2384826402@yahoo[.]com to topsec china - topsec_2014@163[.]com. this domain record has been unchanged since may 7th 2014. the we11point[.]com infrastructure and by extension the faux vae inc. infrastructure is associated with cluster 2 of the scanbox framework by pwc. the latest pwc update to scanbox states that there are "links between the domain allegedly used in the anthem hack ( ) to cluster 2 through shared whois details." opm themed infrastructure
one notable pattern was how the domain whois registration information for the vae, inc. themed infrastructure was quickly updated and obfuscated with pseudorandom 10 character email addresses and using the names of various comic book characters from the iron man franchise. this comic-themed naming convention has been previously documented by our friends at crowdstrike in what they characterize as being associated with a chinese apt group they have dubbed "deep panda". leveraging our domaintools partnership, we were able to correlate the outlier domain opm-learning[.]org. this domain was also purportedly registered by the iron man movie hero "tony stark" on july 28, 2014. this infrastructure naming convention suggests a possible office of personnel management (opm) theme. however, in this case we lacked any specific sample of malware to verify our initial suspicions that this infrastructure was operational. the possible opm reference in the domain name is noteworthy considering it was revealed in july of 2014 that opm had been compromised by a likely state-sponsored chinese actor in mid-march of that year. the fact this domain was registered after the breach occurred suggests that opm could be an ongoing direct target of chinese state-sponsored cyber espionage activity. our attention then turned to the fbi flash report a-000049-mw that was publicly reported by brian krebs on february 6th, 2015. this fbi flash report was issued on january 27th, 2015, the same day an anthem administrator detected suspicious activity according to an internal memo. this memo goes on to indicate that the fbi would not be party to the anthem breach until they were notified on january 29th, 2015; based on these facts we assess with high confidence that it is very unlikely that the fbi flash report was directly related to the anthem breach. rather, we suspect that the fbi flash report likely references the usis breach that was announced on august 6, 2014, or the previous opm breach, considering the statement that the breach involved "compromised and stolen sensitive business information and personally identifiable information (pii) from us commercial and government networks through cyber espionage." the malware referenced within the fbi report is associated with a derusbi backdoor subvariant named "infoadmin" / "kakfum" where the fbi specifically references open source reporting of "deep panda" as being related to the malware observed in the attack. the malicious infrastructure highlighted in the report are the domains images.googlewebcache[.]com and smtp.outlookssl[.]com. both of these top level domains were included with other related domains, all of which were shared on september 16th, 2013 to the threatconnect subscriber community in incident 20130823c: some.trouble apt domains, roughly a year and half prior to the fbi flash report. it is important to mention that both the domains images.googlewebcache[.]com and smtp.outlookssl[.]comas were also previously identified in an october 2014 pwc blog post as seen within cluster 1 of the scanbox framework, while the sakula activity with we11point and vaeit is contained within cluster 2 of that report. this implies that the actor referenced within the fbi flash report uses shared capabilities (in this case the scanbox kit) with the sakula / we11point actor. section summary:
the derusbi / sakula malware seen in both the we11point[.]com and vae inc. campaigns were structurally the same and digitally signed with the dtoptoolz signature.
the emerging theme is that this particular signature and family of malware is highly indicative of a particular chinese apt activity.
within this web of malicious infrastructure, there is an interesting overlap with the topsec2014[.]com domain and attack infrastructure.
threatconnect research identified a domain opm-learning[.]org that had a similar superhero themed whois registrant to the sakula / vae inc. infrastructure. the possible opm reference is noteworthy considering the office of personnel management (opm) was compromised in march 2014. additionally, an fbi flash report 0000-49mw referenced indicators that were possibly associated with the usis hack and a derusbi variant called "kakfum" / "infoadmin". both the fbi flash infrastructure and the sakula / vae inc. infrastructure are tied to the capability usage of the scanbox framework, residing in clusters 1 and 2 respectively.
unveiling song yubo and southeast university:
the professor
we conducted open source research in pursuit of further information on the topsec_2014@163[.]com email registrant. a keyword search returned several results for "topsec2014@163[.]com" in association with a number of academic institutions in nanjing, china. although the email address wasn't an exact match to the topsec2014[.]com domain registrant (notice the absence of the underscore), such a similarity warranted further investigation.
screen shot 2015-02-25 at 5.20.37 pm we examined the links for any relevant intelligence, and discovered that nearly all of the search results led to pages that contained an announcement for an information security competition sponsored by the southeast university-topsec information security and mobile internet technology joint research center. this entity appears to be a joint research venture between the university and chinese networking giant beijing topsec network security technology co., a.k.a. beijing topsec. screen shot 2015-02-23 at 9.22.35 am the announcements list a professor "song yubo" as the point of contact for the event, and directs interested parties to his email address, topsec2014@163[.]com, for further questions. translation according to his linkedin page, song is a teacher at the southeast university, specifically interested in the field of telecommunications. additionally, he is an avid researcher, and has published numerous academic papers on computer network exploitation on various e-journal publication sites, such as google scholar. further, he lists skills such as "cryptography," "penetration testing" and "computer network security," etc. on his research gate profile. yubo-stacked-china-hack as we continued to develop a profile on professor song, we began to have the sense that his interest in information security research strongly overlapped with that of someone who might be interested in or at least capable of conducting sophisticated cyber attacks. however, interests alone are not enough to warrant reasonable suspicion, so we had to do more digging. additionally, the soft link between topsec_2014@163[.]com and topsec2014@163[.]com alone was not sufficient to make associations with any reasonable confidence, but as it turns out, yubo has in fact been previously named as a person of interest in the context of offensive chinese cyber activity. the university
in march 2012, northrop grumman presented a commissioned report to congress detailing chinese cyber warfare capabilities. the report asserts with high confidence that both song and the information security research center at southeast university have received numerous state-sponsored research grants, and by extension, cooperated with the government of china in conducting information security research and development (r&d). as stated on southeast university's own website, the main purpose of these grants are to develop technical acumen amongst its students via providing support for "state-owned scientific research institutions, state key enterprises, government agencies and people's liberation army (pla) units."
relationshipssoutheast university is one of only three chinese academic institutes that receives funding from all five of the state grant programs. song himself has also conducted his fair share of state-sponsored research, notably under the national ministry of state security 115 program - a highly sensitive research grant to fund ambiguous information warfare r&d, almost certainly in support of pla programs. the competition
as we can see, the evidence continued to stack up. the real smoking gun, however, was when we began to notice a strong temporal overlap with the various stages of the topsec cup that song and beijing topsec were organizing, and the registration dates of malicious infrastructure as well as the malware compilation dates. based upon the translated registration form that we obtained from song yubo's personal baidu document sharing account, open registration for the "topsec cup" began on may 4th, 2014 and would close on may 14th, 2014. the details of the competition that were shared on the announcement are extremely ambiguous, and probably for good reason. the introductory paragraph mentions that the primary goal of the event is to facilitate the training and discovery of new talent, noting that exceptional participants would receive priority consideration for internships and jobs with beijing topsec. the event itself was broken down into several distinct rounds of competition. firstly, the preliminary round required that all eligible registrants would attempt to remotely access and navigate through the network. should a participating team perform exceptionally in the preliminary qualifying round, they would be invited to participate in the final round on-site in nanjing. in this final round, participants would be required to build their own "information systems and network environments." the announcement notes that the students must rely upon their own laptop and software tools to accomplish this task. further, the announcement notes that participants are prohibited from attacking the provided server as well as their competitors. section summary:
song yubo and his research center at southeast university appear to be central players in this narrative, as highlighted by their financial connections to the government of china, in particular the ministry of state security (mss), china's premier human intelligence agency.
if the mss was involved, we can deduce that the anthem hack could have been for the purposes of gathering sensitive information for follow-on humint targeting via blackmail, asset recruitment or technical targeting operations against individuals at home.
song's use of the topsec email alias suggests a greater association w/ topsec.
it seems as if the competition is almost certainly the cause for the topsec2014[.]com domain. what is very curious, however, is the initial registration by the reseller li2384826402@yahoo[.]com, which is a tactic seen within the confirmed malicious faux vae inc.infrastructure.
the overlap between the competition website and the static command and control infrastructure seen in the derusbi / sakula implant is was likely an error made by the attackers. tianrongxin, a.k.a. beijing topsec technology co:
the company
to enhance our open-source capabilities, we partnered up with dr. james mulvenon and his team of china experts at defense group, inc. (dgi). we shared with them everything that we knew at the time, walking through the technical details which led us all the way to song yubo and the competition announcement. from there, they were able to uncover a wealth of very consequential background information on beijing topsec technology co (beijing topsec), the sponsoring organization for song yubo's information security competition. dgi's research indicated that beijing topsec is one of the largest information security hardware providers in china. in 1996, they were the first chinese company to break into the market with the release of china's first indigenously-manufactured firewall. since then, they have expanded their business to include a consulting practice focused on issues such as vulnerability mining, software code analysis, threat intelligence, and encryption r&d, amongst other things. the company served as a core technical support unit for network security at the 2008 olympic games - an event which was tightly controlled by the state. additionally, beijing topsec is a known partner of the chinese military. since 2009, the company has possessed information publication credentials for military network procurement. since 2013, they have been publicly recognized as the chinese equivalent of a cleared defense contractor. the links between beijing topsec and the chinese government are fairly substantial, highlighted by long-standing partnerships between even the most shadowy elements of the chinese military. the leaked cable
a very compelling piece of evidence is found in the contents of a leaked 2009 diplomatic security cable from the department of state, published by the guardian. the cable is a daily digest of diplomatic security alerts - essentially a situational awareness primer for state department employees to inform them of new and existing threats. in one section, the cable highlights that the founder of beijing topsec, he weidong, had openly talked about receiving directives from the pla in an interview with china news network. in the interview, the founder quite curiously states that topsec is less a commercial entity, but rather a research institute, and that the company received about half of its start-up capital directly from the pla. the cable further claims that topsec actively recruits for the pla cyber army. lin-yong-lion-china-hack it would also appear that not only does beijing topsec have deep ties to state-run cyber activity, but also within the independent hacker community as well. of note, the company hired the notorious hacker lin yong, a.k.a. "lion" (of the honker union of china) in the early 2000s as a security service engineer and to conduct network training. section summary:
it is not surprising that the chinese government would be interested in partnering with a private organization such as beijing topsec for use as a front for state-sponsored activity.
the association between southeast university and beijing topsec as manifested in the joint information security research center highlights the possibility of growing links between state-sponsored activity and academic institutions, particularly those that receive funding from the central government.
all in all, it would seem that china is pursuing a unified approach to cyber operations, relying on all unique facets of the workforce: academia, private industry, and independent hackers, as well as the pla to achieve their strategic goals.
conclusion:
the anthem breach exposes the insidious reality of modern chinese cyber espionage as it continues its unrelenting strikes at the soft underbelly of the american way of life. moreover, it demonstrates the imposing yet increasingly common reality of conducting threat intelligence analysis without substantial threat intelligence to start with. fortunately for us, we were able to deduce informed answers to some of the outstanding questions to this breach by scrutinizing our archival data troves that are efficiently stored within our threat intelligence platform and partner integrations. in the field of cyber security, industry professionals must learn to play the long game in order to generate a proactive sense of situational awareness, allowing for greater efficiency and flexibility in mitigating future threats. additionally, this incident underscores the frustrating disparity of the industry when it comes to naming conventions. with so many threat actors and indicators floating around, it is can be frustrating to keep track of all the disparate pieces of evidence, especially when countless naming conventions are applied. without the use of a threat intelligence platform to keep track of the flood of incoming threat data, this task would be extraordinarily time consuming at best and crippling at worst. moving forward, it is important to bear in mind that the adversary, regardless of country of origin, shall almost certainly leverage our every weakness against us. even something as seemingly innocuous as confusion over names can easily consume analytical bandwidth, creating a window of opportunity to strike. we - that is security professionals, private industry and governments alike - must proactively harden our network defenses and hasten our incident responses as a united, synchronous entity. we have shared details on song yubo and affiliated indicators within the threatconnect common community. this share also includes the full-text dgi "blue heron" research which provides greater insight into song yubo, southeast university and beijing topsec.
