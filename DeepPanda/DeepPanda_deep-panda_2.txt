chinese vpn service as attack platform? hardly a week goes by without a news story about state-sponsored chinese cyberspies breaking into fortune 500 companies to steal intellectual property, personal data and other invaluable assets. now, researchers say they ve unearthed evidence that some of the same chinese hackers also have been selling access to compromised computers within those companies to help perpetrate future breaches. the so-called great firewall of china is an effort by the chinese government to block citizens from accessing specific content and web sites that the government has deemed objectionable. consequently, many chinese seek to evade such censorship by turning to virtual private network or vpn services that allow users to tunnel their internet connections to locations beyond the control of the great firewall. terracottavpn security experts at rsa research say they ve identified an archipelago of chinese-language virtual private network (vpn) services marketed to chinese online gamers and those wishing to evade censorship, but which also appear to be used as an active platform for launching attacks on non-chinese corporations while obscuring the origins of the attackers. dubbed by rsa as terracotta vpn (a reference to the chinese terracotta army), this satellite array of vpn services may represent the first exposure of a prc-based vpn operation that maliciously, efficiently and rapidly enlists vulnerable servers around the world, the company said in a report released today. the hacker group thought to be using terracotta to launch and hide attacks is known by a number of code names, including the shell_crew and deep panda. security experts have tied this chinese espionage gang to some of the largest data breaches in u.s. history, including the recent attack on the u.s. office of personnel management, as well as the breaches at u.s. healthcare insurers anthem and premera. according to rsa, terracotta vpn has more than 1,500 nodes around the world where users can pop up on the internet. many of those locations appear to be little more than servers at internet service providers in the united states, korea, japan and elsewhere that offer cheap virtual private servers. but rsa researchers said they discovered that many of terracotta s exit nodes were compromised windows servers that were harvested without the victims knowledge or permission, including systems at a fortune 500 hotel chain; a hi-tech manufacturer; a law firm; a doctor s office; and a county government of a u.s. state. the report steps through a forensics analysis that rsa conducted on one of the compromised vpn systems, tracking each step the intruders took to break into the server and ultimately enlist the system as part of the terracotta vpn network. all of the compromised systems, confirmed through victim-communication by rsa research, are windows servers, the company wrote. rsa research suspects that terracotta is targeting vulnerable windows servers because this platform includes vpn services that can be configured quickly (in a matter of seconds). rsa says suspected nation-state actors have leveraged at least 52 terracotta vpn nodes to exploit sensitive targets among western government and commercial organizations. the company said it received a specific report from a large defense contractor concerning 27 different terracotta vpn node internet addresses that were used to send phishing emails targeting users in their organization. out of the thirteen different ip addresses used during this campaign against this one (apt) target, eleven (85%) were associated with terracotta vpn nodes, rsa wrote of one cyber espionage campaign it investigated. perhaps one of the benefits of using terracotta for advanced threat actors is that their espionage related network traffic can blend-in with otherwise-legitimate vpn traffic. digging deeper rsa s report includes a single screen shot of software used by one of the commercial vpn services marketed on chinese sites and tied to the terracotta network, but for me this was just a tease: i wanted a closer look at this network, yet rsa (or more likely, the company s lawyers) carefully omitted any information in its report that would make it easy to locate the sites selling or offering the terracotta vpn. rsa said the web sites advertising the vpn services are marketed on chinese-language web sites that are for the most part linked by common domain name registrant email addresses and are often hosted on the same infrastructure with the same basic web content. along those lines, the company did include one very useful tidbit in its report: a section designed to help companies detect servers that may be compromised warned that any web servers seen phoning home to 8800free[dot]info should be considered hacked. a lookup at for the historic registration records on 8800free[dot]info show it was originally registered in 2010 to someone using the email address xnt50@ . among the nine other domains registered to xnt50@ is 517jiasu[dot]cn, an archived version of which is available here. domaintools shows that in 2013 the registration record for 8800free[dot]info was changed to include the email address jzbb@ . helpfully, that email was used to register at least 39 other sites, including quite a few that are or were at one time advertising similar-looking vpn services. pivoting off the historic registration records for many of those sites turns up a long list of vpn sites registered to other interesting email addresses, including adsyb@ , asdfyb@ and itjsq@ (click the email addresses for a list of domains registered to each). armed with lists of dozens of vpn sites, it wasn t hard to find several sites offering different vpn clients for download. i installed each on a carefully isolated virtual machine (don t try this at home, kids!). here s one of those sites: one of the sites offering the vpn software and service that rsa has dubbed "terracotta."
a google-translated version of one of the sites offering the vpn software and service that rsa has dubbed terracotta. all told, i managed to download, install and use at least three vpn clients from vpn service domains tied to the above-mentioned email addresses. the chinese-language clients were remarkably similar in overall appearance and function, and listed exit nodes via tabs for several countries, including the canada, japan, south korea and the united states, among others. here is one of the vpn clients i played with in researching this story: 517vpnconnected this one was far more difficult to use, and crashed repeatedly when i first tried to take it for a test drive: us-vpn2 none of the vpn clients i tried would list the internet addresses of the individual nodes. however, each node in the network can be discovered simply by running some type of network traffic monitoring tool in the background (i used wireshark), and logging the address that is pinged when one clicks on a new connection. rsa said it found more than 500 terracotta servers that were u.s. based, but i must have gotten in on the fun after the company started notifying victim organizations because i found only a few dozen u.s.-based hosts in any of the vpn clients i checked. and most of the ones i did find that were based in the united states appeared to be virtual private servers at a handful of hosting companies. the one exception i found was a vpn node tied to a dedicated windows server for the web site of a company in michigan that manufactures custom-made chairs for offices, lounges and meeting rooms. contacted by krebsonsecurity, the company confirmed that its serve was infected and beaconing home to the control servers described in the rsa report. in addition to the u.s.-based hosts, i managed to step through a huge number of systems based in south korea. i didn t have time to look through each record to see whether any of the korean exit nodes were interesting, but here s the list i came up with in case anyone is interested. i simply haven t had time to look at and look up the rest of the clients in what rsa is calling the terracotta network. here s a more simplified list of just the organizational names attached to each record. assuming rsa s research is accurate (and i have no reason to doubt that it isn t) the idea of hackers selling access to hacked pcs for anonymity and stealth online is hardly a new one. in sept. 2011, i wrote about how the russian cybercriminals responsible for building the infamous tdss botnet were selling access to computers sickened with the malware via a proxy service called awmproxy, even allowing customers to pay for the access with paypal, visa and mastercard. it is, after all, incredibly common for malicious hackers to use systems they ve hacked to help perpetrate future cybercrimes particularly espionage attacks. a classified map of the united states obtained by nbc last week showing the victims of chinese cyber espionage over the past five years lights up like so many exit nodes in a vpn network.
