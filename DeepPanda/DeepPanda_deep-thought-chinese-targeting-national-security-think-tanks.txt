for some time now, crowdstrike has been working with a number of national security think tanks and human rights organizations on a pro bono basis to help them with their security posture. these organizations face some of the most advanced nation-state adversaries china, russia, and iran, just to name a few. the individuals who are typically targeted at these institutions tend to be former senior government officials who still have lots of contacts within western governments and, as such, their private correspondence is of extreme interest to these attackers. the intelligence services of these nation states are always on the lookout for any clues they may extract from such private communications that may give them an advanced insight into what options government policy makers are considering on particular issues of interest. at the same time, with access to the victim email mailboxes, the adversaries can craft very realistic spear-phishing lures to the government contacts of targeted think tank personnel by piggybacking on ongoing real conversations and increasing their chances of a successful compromise of an official government email account. despite this high threat level, these think tanks are organized as non-profits and often do not have the budgets of commercial organizations to afford cutting-edge security technologies that can help them effectively detect these threats. for this reason, crowdstrike has provided our falcon host endpoint security technology to many of these organizations at no charge to them to help detect and attribute these attackers on their networks in real time, as well as to receive instantaneous full forensic visibility into their behavior to help with full remediation of any incident. recently, falcon host has detected multiple simultaneous compromises at several national security think tanks from an actor we call deep panda, one of the most advanced chinese nation-state cyber intrusion groups. for almost three years now, crowdstrike has monitored deep panda targeting critical and strategic business verticals including: government, defense, financial, legal, and the telecommunications industries. at the think tanks, falcon host detected targeting of senior individuals involved in geopolitical policy issues, in particular in the china/asia pacific region. however, last week the unprecedented real-time visibility provided by falcon host into this actor s escapades allowed analysts to observe a radical change in targeting. this actor, who was engaged in targeting and collection of southeast asia policy information, suddenly began targeting individuals with a tie to iraq/middle east issues. this is undoubtedly related to the recent islamic state of iraq and the levant (isis) takeover of major parts of iraq and the potential disruption for major chinese oil interests in that country. in fact, iraq happens to be the fifth-largest source of crude oil imports for china and the country is the largest foreign investor in iraq s oil sector. thus, it wouldn t be surprising if the chinese government is highly interested in getting a better sense of the possibility of deeper u.s. military involvement that could help protect the chinese oil infrastructure in iraq. in fact, the shift in targeting of iraq policy individuals occurred on june 18, the day that isis began its attack on the baiji oil refinery. the attacks crowdstrike s falcon host technology used by these think tanks consists of a tiny (under 5mb in size) kernel sensor that is deployed on windows and mac servers, desktops, and laptops and is able to do real-time detection and recording of all adversary activities taking place on the system. in addition, by matching the detected activities against our vast adversary intelligence repository, falcon host can automatically attribute the attack to a known adversary group and provide details about their motivations, capabilities, and key tactics, techniques, and procedures (ttps). recently, we detected breaches of these networks via the use of powershell scripts deployed by the adversary as scheduled tasks on windows machines. the scripts are passed to the powershell interpreter through the command line to avoid placement of extraneous files on the victim machine that could potentially trigger av- or indicator of compromise (ioc)-based detection. the scripts were scheduled to call back every two hours to the deep panda command and control (c2) infrastructure. the script in the command line is base64 encoded, but when decoded it translates to the following code snippet: once executed, it downloads and executes from memory a .net executable (typically named wafer), which in turn typically downloads and runs madhatter .net remote access tool (rat), one of the favorites of deep panda. by running them from memory, it leaves no disk artifacts or host-based iocs that can be identified in forensic analysis. this is typical for deep panda stealth is their specialty and they prefer to operate in a way that leaves a minimal footprint on a victim system and often allows them to evade detection for a very long time. for this same reason, deep panda likes to use webshells to keep low-footprint persistent access to the victim network, as we ve covered in our prior blogs. this case was no exception, and that initial webshell implant allowed them to execute reconnaissance commands such as tasklist, net view, and net localgroup administrators, and then afterward to deploy the powershell scripts. the adversary used stolen credentials to mount network shares via net use command. in one case, they brought in cult of the dead cow s nete tool onto the system, but most of the time they leveraged existing windows tools and avoided bringing many new tools into the environment that could make them noisy and easily detectable by technologies that scan for static iocs. after using compromised credentials to mount file shares, the adversary was seen compressing data using 7-zip. they were adding different document types to compressed files by wildcarding the extensions, such as: they knew exactly which users to target based on their research policy area, and they rapidly pivoted from china/asia pacific policy experts to iraq/middle east policy experts once their tasking collection requirements changed. aggressive use of ping to determine which machines of interest are online on one of the compromised machines, the adversary brought in a command-line version of rar archiver that was named and placed it into c:windowstemphotfix directory. the files were encrypted (both file data and headers) with uinfw password and the archive files were named after the initials of each user that had been targeted and stored in the same c:windowstemphotfix directory. for lateral movement, they used wmi to deploy the powershell scripts remotely and setup scheduled tasks on the remote systems. despite the fact that we were seeing nearly identical ttps used across multiple think-tank targets, there is evidence to indicate that these operations had different individuals behind the keyboard based on the intricacies of how certain powershell command lines had been used in each case. summary deep panda presents a very serious threat not just to think tanks, but also multinational financial institutions, law firms, defense contractors, and government agencies. due to their stellar operational security and reliance on anti-forensic and anti-ioc detection techniques, detecting and stopping them is very challenging without the use of next-generation endpoint technology like falcon host. not only was falcon host able to detect this adversary without relying on static signatures or iocs, but it was able to provide instantaneous and full forensic analysis of what had occurred on each of the compromised endpoints without the need to pull hard drives and do costly and time-intensive forensics, substantially reducing the time needed for remediation. if you are a non-profit think tank or a human rights organization that would like to take advantage of our no-charge offer of falcon host licenses for your servers and desktops, please email us at sales@ with the subject non-profit falcon host offer. our falcon intelligence subscribers have had access to multiple reports on the deep panda actor that includes full analysis of their attribution, tradecraft and ttps, as well as detection indicators and signatures and remediation instructions. and our crowdstrike services has worked on multiple intrusion investigations related to deep panda in the last year. if you would also like to see a demo of falcon host or falcon intelligence in action or discuss our services offerings, please contact our sales team to schedule a personal briefing. stay safe and keep a watchful eye on the pandas, bears, kittens, and other adversaries who are relentlessly preying on your data!