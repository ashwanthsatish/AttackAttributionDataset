
over the last few months, the crowdstrike intelligence team has been tracking a campaign of highly targeted events focused on entities in the u.s. defense industrial base (dib), healthcare, government, and technology sectors. this campaign infected victims with sakula malware variants that were signed with stolen certificates. investigation into this activity led to associations with the adversary known to crowdstrike as deep panda. on 31 july 2014, an executable was identified, which, at the time, was not detected by any anti-virus products. when this file was executed, it caused the victim to view a website by using the shellexecute() api to open a url. the site s domain name was meant to spoof that of a site set up to provide information on an alumni event for a u.s university. this page requested that the visitor download an adobe-related plugin in order to view the content. the downloaded plugin file included a variant of sakula malware. [1] the sakula malware in this campaign utilized the dynamic link library (dll) side-loading technique most commonly associated with plugx activity. in the aforementioned university-related incidents, a legitimate executable named which, in turn, was used to load the sakula executable this final executable was also signed with a certificate assigned to an organization called dtoptoolz co., ltd. command-and-control (c2) communications in this incident went directly to ip address a sample get request is below: sakula get further investigation revealed similar activity stretching back to at least april 2014, when similar ttps were used to target a healthcare organization and a u.s.-based it company with high-profile clients in the defense sector. two other incidents were also identified in august 2014 targeting a company in the dib and a mongolian government entity. all incidents in this campaign were similar in that they utilized malicious droppers masquerading as installers for legitimate software applications like adobe reader, juniper vpn, and microsoft activex control. they display progress bars that make it appear as if the specified software is being updated or installed. example of installer progress bar displayed by dropper in addition, the droppers all directed victims to login pages for services specific to the target organization like webmail, document sharing, or corporate vpn. in all cases except one, the victims were directed to legitimate login pages. the one exception was a case in which victims were sent to a login page hosted on a domain that spoofed that of the legitimate one. it is unclear whether redirecting victims to these login pages was part of credential-collection activity or merely meant to deceive victims into believing that the activity was legitimate. the campaign appeared to be over by the end of august, but a file was recently discovered that suggests it may be ongoing. the intended target again appeared to be a mongolian government entity, and the file masqueraded as an installer for microsoft activex software. it dropped the side-loaded sakula malware just like in the other incidents; however, in this instance, the sakula payload was signed with a certificate assigned to a different organization, career credit co., ltd. the malware used the domain www[.]xha-mster[.]com for c2 which was created in mid-september and is registered with the email address wendellom@ and registrant name tonyy starke (hence the name, ironman-related title for this blog). below is a chart showing the relevant relationships to this deep panda campaign. the bottom of the chart shows an infrastructure connection between an ip address used this campaign and also used in recently observed deep panda activity. association with recent scanbox activity in september 2014, crowdstrike intelligence identified a malicious file signed with the dtoptoolz co., ltd. certificate. analysis of this file revealed it to be derusbi malware (a favorite rat of deep panda) that used the domain vpn[.]foundationssl[.]com for its c2. at the time of discovery, crowdstrike did not attribute the file to deep panda based on the malware alone, but the use of the dtoptoolz certificate to sign a malware variant known to be heavily used by this adversary makes it likely that this signed derusbi sample is also attributable to deep panda. in a recent public report from pwc, another foundationssl[.]com domain was linked to activity involving the strategic web compromise (swc) framework more commonly known as scanbox. in that operation, the scanbox code was placed on the website of a u.s.-based think tank and utilized the malicious domain, news[.]foundationssl[.]com. the use of the two foundationssl[.]com subdomains suggests that the same adversary (in this case deep panda) was responsible for the signed derusbi malware file and the think tank swc activity. furthermore, crowdstrike publicly reported on deep panda targeting of think tanks in july 2014. 