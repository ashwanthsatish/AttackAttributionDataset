we reported at the end of april and the beginning of may on an apt threat group leveraging a zero-day vulnerability in internet explorer via phishing email attacks. while microsoft quickly released a patch to help close the door on future compromises, we have now observed the threat actors behind operation clandestine fox shifting their point of attack and using a new vector to target their victims: social networking. an employee of a company in the energy sector recently received an email with a rar archive email attachment from a candidate. the attachment, ostensibly containing a resume and sample software program the applicant had written, was from someone we ll call emily who had previously contacted the actual employee via a popular social network. fireeye acquired a copy of the suspicious email shown below in figure 1 and attachment from the targeted employee and investigated. the targeted employee confirmed that emily had contacted him via the popular social network, and that, after three weeks of back and forth messaging she sent her resume to his personal email address. [caption id="attachment_5658" align="aligncenter" width="441"]clandestine2 figure 1: sample email illustrating how emily attacks a victim employee[/caption] working our way backwards, we reviewed emily s social network profile and noticed a few strange aspects that raised some red flags. for example, her list of contacts had a number of people from the victim s same employer, as well as employees from other energy companies; she also did not seem to have many other friends that fit her alleged persona. her education history also contained some fake entries. further research and discussions with the targeted company revealed that emily, posing as a prospective employee, had also contacted other personnel at the same company. she had asked a variety of probing questions, including inquiring who the it manager was and what versions of software they ran all information that would be very useful for an attacker looking to craft an attack. it s worth emphasizing that in the instances above, the attackers used a combination of direct contact via social networks as well as contact via email, to communicate with their intended targets and send malicious attachments. in addition, in almost all cases, the attackers used the target s personal email address, rather than his or her work address. this could be by design, with a view toward circumventing the more comprehensive email security technologies that most companies have deployed, or also due to many people having their social network accounts linked to their personal rather than work email addresses. details - email attachment #1 the archive contained three files: a weaponized version of the open-source ttcalc application (a mathematical big number calculator), a benign text copy of the ttcalc readme file, and a benign pdf of emily s resume. the resume was a nearly identical copy of a sample resume available elsewhere on the internet. the file details are below. upon execution, drops the two files listed below, and also launches a legitimate copy of ttcalc v0.8.6 as a decoy: the file is the actual malware executable, which we detect as backdoor.apt.cookiecutter. (variants of this family of backdoor are also referred to as pirpi in the security industry). in this case, the malware was configured to use the following remote servers for command and control: through additional research, we were able to obtain another rar archive email attachment sent by the same attackers to an employee of another company. note that while there are a lot of similarities, such as the fake resume and inclusion of ttcalc, there is one major difference, which is the delivery of a completely different malware backdoor. the attachment name this time was my resume and , but this time it was protected with the password ttcalc. conclusion in short, we attributed these attacks to the same threat actor responsible for operation clandestine fox, based on the following linkages: the first-stage malware ( ) is a slightly updated version of the backdoor.apt.cookiecutter malware dropped during operation clandestine fox
based on our intel, backdoor.apt.cookiecutter has been used exclusively by this particular threat group
finally, the command and control domain inform[.]bedircati[.]com seen in this activity was also used during the clandestine fox campaign
another evolutionary step for this threat group is that they have diversified their tool usage with the use of the kaba/plugx/sogu malware something we have never seen them do before. as we have noted in other blog posts, apt threat actors take advantage of every possible vector to try to gain a foothold in the organizations they target. social networks are increasingly used for both personal and business reasons, and are one more potential threat vector that both end-users and network defenders need to think about. unfortunately, it is very common for users to let their guard down when using social networks or personal email, since they don t always treat these services with the same level of risk as their work email. as more companies allow their employees to telecommute, or even allow them to access company networks and/or resources using their personal computers, these attacks targeting their personal email addresses pose significant risk to the enterprise. 