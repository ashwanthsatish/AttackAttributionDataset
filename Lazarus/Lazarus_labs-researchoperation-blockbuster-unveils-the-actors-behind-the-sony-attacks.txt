operation blockbuster unveils the actors behind the sony attacks today, a coordinated coalition involving alienvault and several other security companies led by novetta is announcing operation blockbuster. this industry initiative was created to share information and potentially disrupt the infrastructure and tools from an actor named the lazarus group. the lazarus group has been responsible for several operations since at least 2009, including the attack that affected sony pictures entertainment in 2014. part of our research on this actor was presented at the kaspersky security analyst summit (sas) in tenerife, spain on february 9th, 2016 as a joint talk between alienvault and kaspersky s global research and analysis team. in the research that alienvault and kaspersky collaborated on, we attributed several campaigns to this actor. armed with some of the indicators that us-cert made public after the sony attack, we continued to analyze different campaigns in 2015 that we suspected were being launched by the same actor. eventually we were also able to attribute previous activity to the same attackers including: besides several campaigns were the lazarus group has utilized wipers to perform destructive attacks, they have also been busy using the same tools to perform data theft and cyber espionage operations. today, as part of the operation blockbuster release, we want to share some of our findings and ttp s from the lazarus group that allowed us to link and attribute all the campaigns and tools into the same cluster of activity. we highly recommend that you read the comprehensive report novetta published today http:// [no longer available] that includes details on the project s scope and the more than 45 malware families identified, and includes signatures and guidance to help organizations detect and stop the group s actions. encryption/shared keys
one of the key findings that gave us the opportunity to link several families to the same actors was finding a dropper that the attackers use. this dropper contains a compressed resource (zip) with the name myres that is protected by a password. the attackers have reused the same password in different occasions and we were able to find droppers containing different families used by the group. this actor also reuses the code libraries they utilize to perform rsa encryption. we were also able to find the exact same public key in multiple variants. batch scripts
this actor often uses bat files that share the same skeleton in order to delete the initial files after infection. we have seem them reuse this technique across multiple droppers and payloads. obfuscation functions
the lazarus group uses a few different methods to obfuscate api functions and dynamically load them. one of them consist on using a simple xor schema. you can find other examples of api function obfuscation in the novetta http:// [no loner available] report. network communications
this actor has different malware families in their toolset that implement a similar c&c protocol. the protocol looks like tls but it is in fact a fake tls protocol that mimics it. one of the characteristics we have identified is how they choose the values for certain fields when generating tls packets, especially the clienthello packet. we have identified different families exhibiting slightly different behaviors: on the other hand, most of the samples we have analyzed communicate with ip addresses that are part of compromised infrastructure. since the attackers don t leverage domain names for c2 it makes it hard to pivot using whois data, and passive dns. in addition, there is no way to sinkhole since there is no domain infrastructure. another example is the use of user-agent values that contain the misspelled mozillar string. hangul hwp document exploits hangul is an office suite and word processing application mainly used in south korea, especially in the government. we have observed this actor launching spearphishing campaigns with malicious hwp documents as attachments. an example is a campaign that was launched on september 2015 that used a zeroday vulnerability (cve-2015-6585) in the hangul word processor which was reported by fireeye. based on obtained samples and decoy documents we observed that they were likely targeting a wide range of victims including government, industrial and political entities. sample decoy documents fake installers it appears another vector the lazarus group uses to infect victims is distributing backdoored software. we have found a few samples using this technique but it is not quite clear to us how they were distributing the files. an example is a backdoored version of a remote desktop client:
