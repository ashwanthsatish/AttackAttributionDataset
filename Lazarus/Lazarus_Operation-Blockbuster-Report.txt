
operation blockbuster unraveling the long thread of the sony attack novetta novetta novetta is an advanced analytics company that extracts value from the increasing volume,variety and velocity of data. by mastering scale and speed, our advanced analytics software andsolutions deliver the actionable insights needed to help our customers detect threat and fraud, protect high value networks, and improve the bottom line. for innovative solutions for today's most mission-critical, advanced analytics challenges, contact novetta: phone: (571) 282-3000 | caveats to the best of novetta's knowledge and belief,participants in this effort did not disclose,access, or utilize any confidential informationthat would result in violation of any thirdparty agreements including, but not limitedto, non-disclosure agreements or customeragreements. while this report discusses previous attributionclaims made by outside parties, novetta cannotdefinitively confirm any such attribution throughthe technical analysis detailed in this and otheroperation blockbuster reports. the name lazarus group, referenced throughoutthis report, has no affiliation or association withbusiness or associations named lazarus group. please note that this report includes terms that will not befamiliar to everyone. we have included a glossary at the endof this report and denoted such defined terms with thesuperscript for your convenience. operation blockbuster:unraveling the long thread of the sony attack 1. executive summary: peration blockbuster is a novetta-led coalition of private industry partners, createdwith the intent to understand and potentiallydisrupt malicious tools and infrastructure thathave been attributed to an adversary that novettahas identified and named as the lazarus group.this group has been active since at least 2009, andpotentially as early as 2007, and was responsiblefor the novemberdestructive wiper attackagainst sony pictures entertainment (spe). chapter 101: j00110.001''0111 j0011010001010100110.0000010111000-- joc000.100000000011010 000110.01010 00j110 1000l1110001: the attack against sony pictures entertainment(spe) was unprecedented in its media coverageand overt use of malicious destructive capabilitiesagainst a commercial entity. the spe attack brokenew ground not only as a destructive malwareattack on a u.s. commercial entity but also dueto the fact that the u.s. government attributedthe attack to north korea and enacted smallreciprocal measures. while the debate over whowas responsible - north korea, hacktivists, or speemployees - was the primary subject played outin the media, the attack presented much largerimplications, such as how little resistance a moderncommercial enterprise is able to provide in theface of a capable and determined adversary withdestructive intent. "north korea and the sony hack: exporting instability through cyberspace. stephen haggard, jon r. lindsay.analysis from the east-west center. may 2015. http:// ovetta operation blockbuster:unraveling the long thread of the sony attack 1. executive summary (continued) further, novetta's analysis of the observed tooling and ttpse suggests that the group has executed numerous successfulattacks due in large part to their organization and determination, more so than due to any highly sophisticated malwaresuch as those reportedly used by similar classes of threat actors reported in the last few years, e.g., hdd malware andsatellite turla. through careful analysis outlined in this report and other associated reverse engineering technical reports, novetta hasbeen able to link the malware used in the spe attack to a widely varied malicious toolset. this toolset includes malwaredirectly related to previously reported attacks, suggesting that these malicious tools have been actively developed andused over a span of at leastyears, and that the attackers responsible for the spe attack have a much larger collectionof related malware outside of the set of reported spe destructive malware. due to this, we strongly believe that the speattack was not the work of insiders or hacktivists. instead, given the malicious tools and previous cyber operations linkedto these tools, it appears that the spe attack was carried out by a single group, or potentially very closely linked groupssharing technical resources, infrastructure, and even tasking. we have dubbed this group the lazarus group. althoughour analysis cannot support direct attribution of a nation-state or other specific group due to the difficulty of properattribution in the cyber realm, the fbi's official attribution claims could be supported by our findings. while the spe attack occurred over a year ago, we are releasing this report now to detail our technical findings, clarifydetails surrounding the spe hack, and profile the lazarus group, who has continued to develop tools and target victimssince then. most importantly, novetta continues to work with our public and private partner organizations in thisoperation to ensure that novetta's signatures and other data will have a meaningful impact on the lazarus group'sabilities to function, as well as help potential victims understand in great detail not only the technical but also theoperational methods. novetta feels that this combination of sharing highly technical analysis with both the public andprivate industry is the best way to interdict these types of actors. 19114joubo110hd11110011 diciel group cemag hid"nsa planted stuxnet-type malware deep within hard drive firmware." the hacker news. february 16, 2015. http:// n92"satellite turla: apt command control in the sky." securelist. september 9, 2015. on sony investigation." fbi. december 19, 2014. 69) novetta operation blockbuster:unraveling the long thread of the sony attack 1.1 key takeaways i. the lazarus group is a well-established group that appears to be comprised of various sets of developers and operators for their custom malware.
2. the lazarus group demonstrates varying levels of technical aptitude and proficiency in computer network operations (cno).
3. from a binary analysis perspective, this threat actor demonstrates a heavy reliance on shared code, techniques, and ideas from other previously developed lazarus group tool components as well as outside sources. due to this,malware used in the novemberspe attack can be linked to a much wider set of the lazarus group's malware that has been under active development since as early as 2009.
4. the malware analyzed in this operation and attributed to the lazarus group has been used to target government, media, military, aerospace, financial, and critical infrastructure entities in a limited geographic area, primarily south korea and the united states.
5. because of the depth and scope of malware tools, structure of the analyzed code bases, ttp overlap with similar attacks, and long trail of activities attributed to the lazarus group, novetta does not believe that the spe attack wascarried out by insiders or hacktivists, but rather by a more structured, resourced, and motivated organization. 6. the set of malware uncovered and analyzed during this operation, more thanunique families to date, consists of a wide variety of attack tools: o rats installers spreaders loaders hard drive wipers . :: general tools uninstallers proxy keylogger ddos bot 7. the frequency and type of code sharing across malware families may suggest the same group of author(s) across families or extensive sharing of resources between closely linked groups8. the lazarus group has also been observed to share cryptographic keys across malware families as well as general techniques observed in other unrelated malware families. iovetta operation blockbuster:unraveling the long thread of the sony attack operation details chapter operation blockbuster began in december 2014, independent of any investigation conducted by law enforcement or sony, withthe intent to not only identify and impact themalicious tools and infrastructure used bythe lazarus group, but also to clarify detailssurrounding the novemberspe attack,which was the subject of widespread confusion.
by investigating the malware linked to this attack, we have determined that the lazarus group hasoperated largely unfettered for nearly a decade,conducting cyber espionage, denial of serviceattacks, data theft, and destructive attacks. outc before discussing novetta's hunting methods,it is important to note that the majority of ourmalware samples and other data were sourcedfrom public sources such as virustotal. asa result, our samples are biased towards thefootprint and usage of this service. we do havesome partners who provided malware samples,representing commercial ecosystem protectorsand maintainers. here again, our visibility islimited to the visibility of these partners. lio1 10t ovetta operation blockbuster:unraveling the long thread of the sony attack 1 hunting method on december 14, 2014, us-cert released an alerts entitled "targeted destructive malware.
" the alert described a setof malware families used by undefined attackers to compromise large network infrastructures and deploy hard drivewiping malware, rats, and proxy trojans. while the document did not specifically call out the guardians of peace(gop)'s attack against spe from the previous month, and only provided some basic yara signatures and import hashes,members of the security community released specific hashes for the malware used within the spe attack. from thesehashes (md5s listed below), a baseline of the lazarus group's malware capabilities was established. novetta hunting methodology: iddi identify startingsample(s)in this case, the startingsamples were identified bythe industry as being fromthe spe attack begin analysis ofsamples attempt to identify uniquecomponents of the code basethat can provide highconfidence signatures write high confidencesignaturessignatures can help captureother samples that use thesame or very similar codesnippets identified in step #2 run high confidencesignatures against a largecorpus of malwarethis is more easily accomplishedusing totem or similar elasticmalware analysis or file triagingframework fitteet+eftiteparte d-b repeat steps 4-7until done collect and verify theaccuracy of resultsby checking the signaturematch, samples can beverified to ensure that thereare no false positives, or torefine high confidencesignatures identify any divergencein samplessuch a divergence may communicatesome structure change or change incapabilities, and in turn provide moreinformation about a threat group'stoolset, development activity, andcapabilities write new highconfidencesignatures for those portionsof codeus-cert. s that aresecaratasan spects origuration novetta novetta _remas terteminare sem er operation blockbuster:unraveling the long thread of the sony attack by analyzing the base set of malware associated with the lazarus group,novetta determined that there were common code and libraries being usedacross multiple malware families (see sectionfor more details). from these common snippets of code and use of library functions, signatures were generated to detect additional malwaresamples using both open-source tools and totem,an open-source, novetta-developed framework for large-scale fileanalysis and triage. while attempting to acquire all malware associated with a particular threat group is a sisyphean task,given the active development of multiple various toolsets, novetta was able to detect and analyze more thandistinctmalware families that fall under the lazarus group's toolset. a thorough discussion on these families, organized by usageand intention, can be found in novetta's supplemental reports. in our investigation, we were able to scan signatures over hundreds of millions of samples we collected as well as usingindustry partners' av scanning engines. the use of such a large corpus of malware allowed novetta to fine-tune thesignatures for shared code components to ensure a high reliability that the code fragments used for detection werespecific to the lazarus group and not the result of commodity code. from the billions of files scanned, novetta'ssignatures produced approximatelysamples, of whichwere manually vetted and catalogued as belonging tothe lazarus group.
https://github.
com/novetta/totem 69) novetta novetta _sormat mencapaian saya operation blockbuster:unraveling the long thread of the sony attack lazarusgroup details chapter three dy identifying the malware linked to the spe attack (section 2.
1) and other relatedsamples and capabilities, novetta has been ableto compile a picture of a group that has beenactive for nearly a decade. based on analysis of theextensive malware set collected, as well as detailsfound in public reporting from linked attacks,the lazarus group appears to have resources thatallow for development of custom malware toolsfor extensive, targeted, and coordinated attacks,including long periods of reconnaissance. thelazarus group has also displayed the technicalcapability and will to perform destructive attacksagainst targets. the following sections detail thespe attack and subsequent media reporting, thegroup's ttps, targets based on known attacks andmalware artifacts, and previous cyber campaignsthat we have directly linked to the lazarus group. 1 the spe attack and conflicting attribution lo thel lazarus which in november 2014, sony pictures entertainment (spe) was attacked with destructivemalware whose various components were publicly reported as destover or wiper andwhich novetta identified in this operation as whiskeyalfa, malware associated with the lazarus group threat actors (see section 4.
1 for details about the naming scheme used forgroup malware attributed to the lazarus group). publicly, a previously unknown hacker group named guardians of peace (gop) took credit for the wiper attack and stolen data. thegroup eventually publicized the files stolen from spe networks, including unreleased movies, usernames, passwords, andother it details for internal spe networks, employees' personal information, payroll information, employee terminationdetails, tv scripts, and company emails. following the attack, an initial fbi investigation concluded that the hack was the work of the north korean government,as the malware used in the attack was linked to other malware attributed to north korean actors - specifically, codesnippets, encryption algorithms, data deletion methods, and compromised infrastructure used during the attack.
.
infrastructure used in the spe attack has previously been linked by the u.
s. government directly to other identifiednorth korea cyber activity. several security researchers also stated that the destructive attack could be linked to malwarevariants used in attacks that have been suggested to be the work of north korea, with similar ttps as previous eventsattributed to north korea,lo ii and shared infrastructure.
tz however, others stated that the evidence for north korean involvement is circumstantial. for instance, while theinfrastructure used in the spe attack overlaps with infrastructure attributed to malicious cyber activity linked to northkorea, previously malicious ip addresses are not necessarily still used by the same attackers. in fact, the publicly reportedc2 addresses were almost all public proxies used by a variety of malware operators in the past. other reporting claimedthat the spe attack was the work of insiders rather than a nation-state,and that the ability to thoroughly infiltratethe spe network and steal sensitive data required insider knowledge. the data leaked included details of plannedlayoffs, suggesting a motivation for disgruntled employees to aid or provide stolen data to other attackers, such as piracyhacktivists targeting spe. the attackers also dumped the stolen data, rather than keeping it secret as, some allege, a statepower interested in intelligence or propaganda might do instead. in contrast, previous destructive attacks against southkorean organizations in march 2013, which were linked to north korea, involved no extortion demands from attackers.
notably, other public comments even doubted that north korea had the capabilities to launch such an attack largely duesony's it blueprints leaked by hackers.
htmlnovetta operation blockbuster:unraveling the long thread of the sony attack to insufficient infrastructure,or that other nation-states were involved. in addition to the conflicting attribution of the attacks, some initial reporting suggested that the attack shared somelinks to shamoon, the destructive malware that hit saudi aramco and other oil company networks in august 2012. thiswas based on the use of the same commercially available drivers (eldos rawdisk) and attack techniques rather than anyshared malware code.
19 from novetta's analysis of shamoon, there is no clear link between shamoon and any destructivemalware variants tracked in this operation that would indicate shared author(s). however, the author(s) behind the spedestructive malware may have copied shamoon's attack techniques, or vice versa. it is worth noting that the two nation-states publicly blamed for the saudi aramco and spe attacks (iran and north korea, respectively) have had a technologysharing treaty since 2012, with a specific focus on cyber.
20 while some critics of the spe attribution do ask important questions, such as whether the use of public proxies or open-source code libraries is sufficient evidence for attribution, many who have written off any possible nation-state involvementdue to gop's public actions have not fully considered the possible motives of a state's interest in attacking spe. furthermore,to discount nation-states like north korea as too underdeveloped ignores the demonstrated fact that cyber attacksare no longer limited to highly resourced nation-states.
22the cyber footprint of not only governments and criticalinfrastructure, but also corporate enterprises, has grown significantly while still largely lacking in sophisticated securityoperations, effectively lowering the barrier to entry even further for threat groups. although novetta is unable to determine via technical malware analysis whether or not the spe attack was carried outby an identified nation-state, we have been able to link the malware used in this attack to a widely varied malicioustoolset profiled in this operation, including tools directly related to previously reported attacks (section 3-4). this linkto known attacks suggests that these malicious tools have been actively developed and used over a span of at least 7years, and that the attackers responsible for the spe attack have a much larger collection of related malware outside ofthe spe destructive malware. due to this finding, we strongly believe that the spe attack was not the work of insiders orhacktivists. furthermore, given the malicious tools and previous cyber operations linked to these tools, it appears thatthe spe attack was carried out by a single group, or potentially very closely linked groups sharing technical resources,infrastructure, and even tasking. we have dubbed this organization the lazarus group. however, rather than focus on thespecifics of attribution, this report and subsequent technical reports are intended to detail our technical findings on thescope of the lazarus group's known tools and capabilities. due to this finding, we strongly believe that the spe attack was not thework of insiders or hacktivists. furthermore, given the malicious tools andprevious cyber operations linked to these tools, it appears that the speattack was carried out by a single group, or potentially very closely linkedgroups sharing technical resources, infrastructure, and even tasking. wehave dubbed this organization the lazarus group.
"former anonymous hacker doubts north korea behind sony attack.
2 tactics, techniques, and procedures (ttps) taarifa the lazarus group has developed an extensive and varied toolset which effectively combines a number of methods fordelivering additional malicious tools, exfiltrating data, and launching destructive attacks. while the group's combinedcapabilities are not necessarily as polished or advanced as other publicly reported apt groups, the ttps and malwareconnected to the lazarus group demonstrate that it is a capable and determined adversary. particularly when consideringthe state of most, if not all, organizations who struggle with the complexity of computer network defense, it is clear thatthe lazarus group is taking advantage of a cyber attacker's asymmetric advantage in these scenarios. the generally laxdefensive capabilities of their targeted organizations are reflected by the structure and complexity of their tooling andhow they use these tools operationally - the lazarus group's tools are sufficiently advanced for the intended targets andlevel of impact. this is also typically seen in most malware tooling discovered and reported on, from the more advancedand complex malware frameworks like flameand satellite turla,both observed targeting a narrow, hardened set ofvictims, to the off-the-shelf and simple malware (plugx, poison ivy, etc.
) often used for softer targets or for initial accessto target networks. some threat groups make use of a full spectrum of malware, as was observed in novetta's previousoperation smn reporting,where the axiom group leveraged different tools and techniques dependent on the securityposture and capabilities of target organizations. compared to axiom, novetta's analysis of the lazarus group's toolsetsdid not demonstrate the same widespread distribution between advanced, moderately advanced, and basic capabilities. yetthis clearly was not an impediment to the operators in the lazarus group, given the success of their attacks. despite evidence suggesting that their attacks to date have succeededwithout the need for some of the more advanced techniques or capabilities,the lazarus group has shown creativity in their operations that setthem apart. despite evidence suggesting that their attacks to date have succeeded without the need for some of the more advancedtechniques or capabilities, the lazarus group has shown creativity in their operations that set them apart. for example,the group has several malware variants with tls mimicking capabilities (section 4.
1) to evade network detection,as well as a pepe malware family that serves as a platform for an operator to access all infected instances. the lazarusgroup has also used master boot record (mbr) wiper malware since at least 2009, marking some of the earliest knowninstances of targeted destructive malware. furthermore, the willingness to use destructive malware in such a wide scope,seen with the spe attack as well as other linked attacks, distinguishes them from many other apt groups. however, thelazarus group is not limited solely to the deployment of destructive malware. in fact, the toolset identified during thisoperation suggests that the lazarus group encompasses a wide spectrum of cno capabilities, including distributeddenial of service (ddos) malware, keyloggers, and rats, and even a p2p malware family that allows operators toestablish a common program base and remote administration across all infected machines.
"meet 'flame' the massive spy malware infiltrating iranian computers. dns-calc apt trojan uses dns queries to generate c&c port number25 "satellite turla: apt command control in the sky.
pdf 69) novetta operation blockbuster:unraveling the long thread of the sony attack among the ttps we have seen, based on the identified malware corpus and linked cyber campaigns tied to the lazarusgroup, including spe, the lazarus group's primary ttps are: ddos malware espionage campaigns marked by a long initial reconnaissanceperiod of targeted networks, including malware customizedspecifically for target networks destructive malware compromised ips and websites as command-and-control (c2) extensive use of various types of obscure encryption proxies to mask true c2 integration of publicly available tools, libraries, and other code email as c2 re-use of malicious code across multiple malware families mimicking tls as a means of network detection evasion multiple attack components/vectors v spear phishing targeting of south korean av and indigenous korean software use of other legitimate software to gain access to victim networks decoy documents decoy documents 69) novetta novetta operation blockbuster:unraveling the long thread of the sony attack remis enamorata 3.
3 targeting # the lazarus group has targeted a number of industry verticals over theyears, including government, military, financial, media and entertainment,and critical infrastructure. according to previous public research and reporting, the lazarus group has targeted a number of industry verticals overthe years, including government, military, financial, media and entertainment, and critical infrastructure. these victimshave largely been limited to south korea and the united states. based on three months of telemetry gathered from initialsignatures created and shared with industry partners, however, possible infections were found in a much wider geographicarea, including concentrations of detected lazarus group malware found in other asian countries like taiwan, china,japan, and india. while these initial signature detections provide a general overview of some possible malicious activity,these numbers should not be considered reflective of the totality of lazarus group tools detected in this operation, due tothe nature of our approach in this effort and our partners' visibility into these geographic areas. korea (south) serbia 3% pakistan 49% brazil40% other27% india5% japan69 count laly china10% taiwan2190 united states 11% several recent examples of targeting were observed in spear-phishing documents dropped by samples of an installerdeveloped by the lazarus group, which novetta has named indiaalfa.
pdf 69) novetta novetta _coperis ne dam one sony a operation blockbuster:unraveling the long thread of the sony attack figure 3-1: decoy document dropped by indiaalfa variant relating to the mayparliamentary election in south korea the above example is a media report discussing the maysouth korean parliamentary election, which includedcandidates for the saenuri party, south korea's ruling party since 2008. interestingly, saenuti has taken a muchstronger stance toward north korea aggressions in comparison to the pre-2008 sunshine policy" which actively soughtcooperation between the two states. saenuri actively supports the north korean human rights law and founded openradio for north korea, an organization which spreads information about democracy. saenuri is also a major advocate ofcyber security and the national intelligence service. despite being amidst corruption allegations, the saenuri party wonthree of the four parliamentary seats during the election. | novetta novetta operation blackbuster:unraveling the long thread of the sony attack 0 conference in may another document dropped by india alfa includes information about the government 3.
0 conference, held in may 2015south korea's government 3.
0 emphasizes transparency and collaboration. of note is the program's 24-hour online portalservice which connects citizens to multiple central and local government agencies. more recently, a variant compiled in octobercontains a decoy document asking speakers at the society for aerospacesystem engineering's (sase)autumn conference to register their papers. a warning that same month warnedusers not to click on these sase documents, as it exploits a vulnerability (cve-2015-6585) in the hangul word processor(hwp) to deliver a malicious payload. this same vulnerability, patched in september 2015, was reportedly exploited inzero-day attacks tied by researchers to north korean threat actors.
29[warning] do not open an e-mail thatincludes a document tited fall conference announcement).
" livisim of information security, seaul national university. the society for aerospace system engineering figure 3-3: document dropped by an indiaalfa sample asking speakers to register papers for the upcoming society for aerospace systemengineering (sase) conference the above decoy document is a hwp file, meant to be used with hangul word processor (hwp), an indigenous southkorean word processing software. other indiaalfa samples have also been observed dropping other decoy documents forhwp, such as a korean-language resume and a directory for the saejong institute's national strategy training courses,the latter of which was identified in an article referencing north korean spear-phishing strategies. in fact, hwp appearsto be a popular attack vector for targeting south korean victims,32 which may be due to the fact that 80% of documentsattached to south korean government and public agencies' websites are reportedly hwp documents.
33 based on the analysis of malware identified in this operation and tied to the lazarus group based on code reuse, as wellas the public reporting of events that we have linked to the lazarus group's activity, we believe that this threat group hastargeted a wide variety of victims, in addition to the spe attack.
public institutions urged to use caution. high likelihood of precision attacks targeting specific users).
3.
4 links to previous reporting some of the malware variants identified during operation blockbuster have been correlated to previously reportedincidents and attacks, either because the malware was specifically identified in the attack, the lazarus group malwareshared notable code overlap with the publicly reported malware, or the c2 infrastructure publicly reported was also foundhard coded in malicious tools used by the lazarus group. additionally, several events also had ttps highly similar tothose of the lazarus group and have been linked to other notable attacks by security researchers. while some of theseindicators, such as overlapping c2s or some ttps, may not be definitive proof of a linked activity, the collective picture ofthese events together provide a stronger link. these ties strongly suggest that the lazarus group has been active since at least 2009, and potentially as far back as 2007, orhas extensively shared resources with other closely linked groups responsible for these attacks. in the scenario that the gopwere a real organization and responsible for the spe attack, this would suggest that spe was not the only operation by thehacktivist group. however, novetta's analysis and findings suggest that the spe attack was one of several attacks attributableto the lazarus group, who may have posed as the pop up hacktivist collective to mislead or distract the public. the lazarus group timeline march 7, 2007: development of first generation malwareused in "operation flame," activity thatis eventually tied to operationimission," "operation troy," and thedarkseoulattacks. july 4, 2009: a large scale ddos attack on us andsouth korean websites uses the mydoomand dozer ma lware, which is suspected to have arrived in email messages. the malware places the text "memory ofindependence day" in the master boot record (mbr). 2009-2013:operation troy cyber e spionage campaignis active for several years, culminatingin the marchdarkseoul attacks. march 2011: "ten days of rain" attack targets southkorean media, financial, and critical infrastructure targets. compromisedcomputers within south korea are used to launch ddos attacks. april 2011: ddos attack targets nonghyup bank. 2012: operation 1mission" campaign, also linked to the marchdarkseoulattacks, begins. attackers behind thisactivity have reportedly been active since 2007.
