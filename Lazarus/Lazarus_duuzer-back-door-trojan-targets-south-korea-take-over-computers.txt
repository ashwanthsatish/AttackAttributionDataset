duuzer back door trojan targets south korea to take over computers
backdoor.duuzer targets south korean organizations to gain full control of computers. the threat is linked to w32.brambul and backdoor.joanap, which have also been affecting the region.
by: symantec security response symantec employee
created 26 oct 2015
symantec has found that south korea is being impacted by an active back door trojan, detected as backdoor.duuzer. while the malware attack has not been exclusively targeting the region, it has been focusing on the south korean manufacturing industry. duuzer is a well-designed threat that gives attackers remote access to the compromised computer, downloads additional files, and steals data. it s clearly the work of skilled attackers looking to obtain valuable information. there is also evidence to suggest that the actors behind duuzer are spreading two other threats, detected as w32.brambul and backdoor.joanap, to target more organizations in south korea. brambul and joanap appear to be used to download extra payloads and carry out reconnaissance on infected computers. duuzer: an advanced back door threat
duuzer is an ongoing threat that is being delivered in targeted attacks. while the exact distribution method is unknown, it s likely that the malware is spreading through spear-phishing emails or watering-hole attacks. the trojan has been designed to work on both 32-bit and 64-bit computers. it also detects whether the computer it has infected is a virtual machine that was made using virtual box or vmware. if this is the case, then duuzer stops executing. this allows duuzer to attempt to evade detection from security researchers who are running virtual machines that are designed to be compromised with malware for analysis. once duuzer infects a computer, it opens a back door, giving the attackers access to almost everything. the attackers can securely connect to the compromised computer through the threat and perform the following activities: gather system and drive information
create, enumerate, and end processes
access, modify, and delete files
upload and download files
change the time attributes of files
execute commands
the duuzer attackers have been observed trying to disguise their malware on an infected computer. they do this by identifying what software is installed and runs on startup, then renaming their malware to a similar title of an existing, legitimate program. based on our analysis of duuzer, the attackers behind the threat appear to be experienced and have knowledge about security researchers analysis techniques. their motivation seems to be obtaining valuable information from their targets computers. the attackers appear to be manually running commands through the back door on affected computers. in one case, we observed the attackers creating a camouflaged version of their malware, and in another, we saw them attempting, but failing, to deactivate symantec endpoint protection (sep). duuzer in disguise
the attackers began by querying the run key in the registry, redirecting the output to a temporary file: the attackers discovered that a particular program was installed on the affected computer and decided to mimic that software. they created a new folder with the same name as the identified application, but in a different location. they then copied their malware into that folder: the attackers listed out the attributes for the file that they attempted to mimic. they then changed the attributes of their malicious file to match those of the clean one. finally, the attackers created a new registry entry in the run subkey to load their malware. again, they used a similar name to the legitimate application to mimic it. the attackers launched the camouflaged version of the malware, ended the old instance process, and deleted the first instance of the malware. at this point, having blended into the victim process, the attackers began to explore the local network using standard network enumeration tools. failing to deactivate symantec endpoint protection
on a separate computer, during their network-mapping exercise, the attackers were unable to bypass sep detections and attempted to disable the application. to do this, they installed an api-hooking tool in an effort to discover how the security application was interfacing with windows and deactivate it. however, they were unable to stop sep s monitoring activities. the brambul/joanap connection
during our research, we found a dropper that infects computers with a worm known as brambul and a back door trojan called joanap. it s unclear how the dropper is being distributed, but it s likely that it comes from malicious emails. our analysis into duuzer indicates that the trojan is associated with both brambul and joanap. computers infected with brambul have been used as command-and-control (c&c) servers for duuzer and have also been compromised with duuzer. the brambul worm uses brute-force attacks to propagate. the threat connects to random ip addresses through the server message block (smb) protocol using a hardcoded list of user names and passwords. the passwords are quite common or easy to guess, such as 123123 , abc123 , computer, iloveyou, login , and password . after brambul compromises a computer, it creates a net share to give attackers access to the system drive (usually the c: drive). it sends a message with the computer s details and login credentials to a hardcoded email address. brambul s variants may be able to drop additional threats. joanap is dropped alongside brambul and registers itself as a service with the display name smartcard protector. this threat can open a back door, send specific files to the attackers, save or delete files, download and run executables, and launch or end processes. joanap also sends commands and configuration data over an rc4-encrypted connection to other computers infected with these threats. these commands could include running or ending processes, moving or deleting files, and updating c&c details. mitigation
duuzer, brambul, and joanap are just a small selection of many threats affecting south korea. the nation has been impacted in high-profile, targeted campaigns over the last few years. according to the region s national computing & information agency (ncia), there have been more than 114,035 attacks targeting government agencies between 2011 and 2015 so far. the numerous malicious campaigns in the region highlight how attackers continue to see south korea as an attractive target. symantec recommends that users and businesses adhere to the following best practices to prevent their computers from being compromised with this malware: change default user names and passwords
avoid using common or easy-to-guess passwords. the norton security center has advice on how to pick strong passwords.
ensure that the operating system and software is regularly updated to prevent known vulnerabilities from being exploited
don t open suspicious emails. these messages typically distribute malware through malicious links and attachments.
keep security software up-to-date with the latest definitions
protection
norton security, symantec endpoint protection, and other symantec security products protect users against these threats through the following detections: system infected: backdoor.joanap activity
we ve also provided the indicators of compromise for duuzer, brambul, and joanap, as follows:
