summary
this report describes an elaborate phishing campaign against targets in iran s diaspora, and at least one western activist. the ongoing attacks attempt to circumvent the extra protections conferred by two-factor authentication in gmail, and rely heavily on phone-call based phishing and real time login attempts by the attackers. most of the attacks begin with a phone call from a uk phone number, with attackers speaking in either english or farsi. the attacks point to extensive knowledge of the targets activities, and share infrastructure and tactics with campaigns previously linked to iranian threat actors. we have documented a growing number of these attacks, and have received reports that we cannot confirm of targets and victims of highly similar attacks, including in iran. the report includes extra detail to help potential targets recognize similar attacks. the report closes with some security suggestions, highlighting the importance of two-factor authentication. update: iranian gov-linked media respond to coverage of this report
iranian media outlet masregh news, which is reportedly close to iran s intelligence and security services, published a response to the reporting around this post. the masregh article specifically took issue with an ib times report that draws a connection between citizen lab s report and iran s revolutionary guards. it is important to note that the citizen lab report does not make this attribution.
the mashregh news report dismisses the connection made in the ib times, and calls the link between this attack and previous phishing around the 2013 election irrelevant. the article also intimates that because iranian media have previously reported on phishing attacks, the iranian government is not responsible. part 1: background
what is two-factor authentication?
two-factor authentication (2fa) is an authentication tool used by many services to increase account security against password theft and phishing. the most commonly used form of 2fa is to send users a text message with a code once they have entered their password. the text message goes to a previously registered phone. when enabled, 2fa frustrates attackers who have simply stolen users passwords.
implementing 2fa raises the bar on phishing attempts: in order to work, the attacker must gain access to both the victim s password, and the single-use code. typically codes expire quickly, presenting an additional hurdle to an attacker. attacks on 2fa: nothing new under the sun
as researchers have observed for at least a decade, a range of attacks are available against 2fa. bruce schneier anticipated in 2005, for example, that attackers would develop real time attacks using both man-in-the-middle attacks, and attacks against devices. the real time phishing against 2fa that schneier anticipated were reported at least 9 years ago. today, researchers regularly point out the rise of real-time 2fa phishing, much of it in the context of online fraud. a 2013 academic article provides a systematic overview of several of these vectors. these attacks can take the form of theft of 2fa credentials from devices (e.g. man in the browser attacks), or by using 2fa login pages. some of the malware-based campaigns that target 2fa have been tracked for several years, are highly involved, and involve convincing targets to install separate android apps to capture one-time passwords. another category of these attacks works by exploiting phone number changes, sim card registrations, and badly protected voicemail. iranian phishing
many previous phishing campaigns have been described and linked to iranian attackers. for example, attacks against gmail accounts have been regularly noted, including a report on the google security blog (also available in farsi here) describing a campaign that escalated before elections in 2013. at the time, google also linked this attack to a previous attempt to use fake ssl certificates for targeted attacks against gmail accounts within iran. in many other cases, iranian attackers have coupled phishing with other forms of malware attack (see below: not their first time: links with other campaigns). while attacks against 2fa are widely documented in the context of online fraud, the rise in use of 2fa by users of free online services may be leading other categories of attackers, such as political attackers, to begin developing their own versions of these attacks. part 2: three real time attacks
attack 1: the iran is logging in to your account!
how does this attack work?
this real time attack attempts to phish both the user password and the 2fa one-time code. the attacker does this by showing fraudulent pages that simulate the gmail 2-step login process to the victim. the attacker collects the victim s input, while simultaneously logging in to the real gmail page. the attacker s login attempt triggers google to send a genuine 2fa code to the victim, which the attacker then collects and enters themselves. we have seen several versions of the attack, including one not accompanied by smses. attack narrative
this section gives a narrative of how one version of this attack unfolded. (personally identifiable information has been redacted to protect the target s identity.) step 1: sms from google to create fear of an account compromise the attack began with an early morning sms message sent to the target. the message copied the style of google sms alerts and notified the target that there was an unexpected sign-in attempt. the sending number was unknown to the target. we believe this message was an attempt to create a pressing concern on the part of the target that a personal account had been compromised. step 2: immediate follow up with sign-in attempt notification less than 10 minutes after receiving the first sms, the target received an e-mail masquerading as a gmail log-in attempt notification. importantly, the e-mail was carefully populated with personalized details of the target including the target s name, e-mail, and profile picture. notably the fake unexpected sign-in attempt notification states that the attempt is from the iran. for a target concerned about being hacked by groups in iran, this could easily create a sense of concern.
the displayed message sender is also an attempt to create a lookalike for a gmail domain. we found that domain was used in at least one other attack of this type. step 3: trick target into entering password and wait for the 2fa code clicking on the reset password link yields a carefully crafted phishing page. we have partially redacted the page url to protect the privacy of the target.
the page is personalized for the target, and includes the target s e-mail address and name. it includes additional code, borrowed from google, to create the appearance that the target is viewing a genuine google page. entering information in this page and clicking on change password leads to a second page that appears to be a 2fa code request.
for this attack to work, the attackers must actively monitor the phishing page. once the target enters their password into the phishing site the attackers likely use the credential to attempt to log in to gmail. the attacker s login attempt then triggers the sending of a 2fa code from real google to the target. they then wait for the target to enter the 2fa code from google. once the target enters the code, the attackers are able to take control of the account and (presumably) change the credentials. step 4: keep up the pressure with fake 2fa notifications in this case, the attack failed. the target sensed something was not right and did not enter any credentials. over the next hour, perhaps growing frustrated, the attackers sent the target a stream of fake sms messages. these messages purported to be a google 2fa verification code. the target received more than 10 messages in short succession. most messages came from different numbers, all unknown to the target. we suspect that these messages were an attempt to put psychological pressure on the target, and enhance the fiction that an attacker already had the target s password. the attackers must have hoped that enough messages would trigger action. the final ruse failed, and the attack was unsuccessful. attack 2: relax, i already know a lot about you
how does this attack work?
this second attack, which we tie to the same actors, has similar characteristics. in this case, the bait is slightly different, involving a phone call and a proposal. the ultimate goal, again, is to convince the target to enter both their password and 2fa code. attack narrative
step 1: call up target with a proposal the attack began with a morning call from a number in the uk. a male voice spoke in farsi under the pretext of offering a potential collaboration. the attacker mentioned that it was related to activities in which the target was involved, both on and offline. the caller, presumably one of the attackers (or a confederate), demonstrated extensive knowledge of the target s personal hobbies and professional activities. after making several comments, which served to alarm rather than reassure the target, the unknown caller proposed a business project related to the target s activities. the call ended with the caller promising to send the target a proposal. step 2: immediate follow up with a proposal and a fake google drive link shortly after the phone call, the target received an email on a personal account that was not publicly used. the e-mail continued the deception, and used the same name as the caller. the e-mail is written in a way that roughly mimics a google drive shared file notification. the body text proposes a project sweetened by the promise of tens of thousands of dollars. step 3: trick target into entering password and wait for the 2fa code clicking on the link leads to a fake login page for google drive. again, the login is pre-populated with the e-mail and name of the target, indicating a high degree of customization. the domain of the page (logins- ) is clearly an attempt at looking official, as is the excessive subdomain (again redacted to protect the identity of the target). http://login.setting.verification.configuration.user.action.first.step.edit.check.privacy.view.document.setting.verification.configuration.user.login.logins-verify[dot]com/[redacted]
entering text into the login page and clicking on view document yields a fake 2fa authentication page. attack 3: just open the file, i m a journalist!
how does this attack work?
this attack is similar to attack 2, although in these cases the attack masquerades as a request from a member of the media. the calls also come from uk numbers, one of which was shared across multiple attacks. one such attack targeted jillian york, director for international freedom of expression at the electronic frontier foundation. she has agreed to allow us to name her and share additional details on the attack that targeted her. york is the only non-iranian target we are aware of, and may have been included because her work includes extensive professional contact with iranian advocacy groups. attack narrative
step 1: early morning phone call
jillian york of the electronic frontier foundation was woken early in the morning by a phone call from a number in the uk.1 a male voice identified himself as a journalist with reuters and began with small talk that indicated some knowledge of her activities. the connection was not good and the caller immediately rang back. he said there was something he wished to discuss and verified that he had the correct e-mail address for york. step 2: send the bait immediately after the phone calls, york received an e-mail masquerading as sent from the reuters news agency s tech dep and promising an interview. the spoofed e-mail contains some errors, including the misspelling of reutures. the e-mail is slightly more sophisticated than those seen in earlier google docs style phishing from the same group as with the other attacks the e-mail masquerades as a google docs e-mail share but is, in fact, a link to a phishing site, lightly disguised with a google redirect. interestingly, the text reutures, tech dep has shared the following pdf contains a link to the following gmail address. the same address is present in the reply to of the message.
other attempts also contain e-mail addresses in the e-mail body, but we are not including them to preserve the anonymity of other targets. step 3: keep up the pressure the target did not immediately click the link, and the attacker, probably anxious for his effort to pay off, called back. york prudently said that if he wished to send a message it should be included in the message body. step 4: if at first you don t succeed the attacker then sent a second message, this time using another name. the message contained another fake google doc link. this time the attacker used a different e-mail address with a western sounding name alex anderson. the phishing link is the same as the earlier message. image 11: the attacker then sent a second message, this time using another name, the message contained another fake google doc link.
image 11: the attacker then sent a second message, this time using another name, the message contained another fake google doc link.
the attacker followed up with another call, further attempting to persuade york to open up the document. the efforts failed, with the attacker s tone becoming increasingly belligerent. this is from my personal address! just open it! - the increasingly frustrated attacker on the phone in total, the attacker called york more than 30 times over the next day. the attack had failed. step 5: other avenues while this attack was ongoing, york s facebook account was targeted with password reset attempts. as the attacker did not control her recovery e-mail accounts, the attempts failed. part 4: the attacker? many clues
the attacks we have reported here stand out by virtue of both the extensive effort expended by the attackers, and their seemingly detailed knowledge of the public and private activities of their targets. we have observed this campaign over several months, and note that it has undergone slight evolution. phishing infrastructure
the attacks share a wide range of features, and in some cases the same domain. a key feature of the domain registrations is impersonating the whois for google. for example, attacks 1 and 2 both use the domain logins-verify[dot]com many of the attacks disguise the phishing page url by using a redirect through google.
the whois for this domain also contains a fake google registration, although it lacks the misspelling found in the other domains. currently, the domain resolves to the following: finally, the phishing site described in attack 3 appears, unlike the others, to be a compromised domain belonging to a malaysian company that provides bus services in southeast asia. many, but not all of the attacks, spoofed the domains of legitimate sites. the attackers appear to be using a php mail script loaded onto compromised websites. for example, many attacks used the website of a texas lawyer specializing in injuries during birth. we contacted the firm, and they deleted the malicious scripts and updated their site. in other cases, the attackers seemed to have used lookalike domains in the reply-to, like: although we were not able to confirm whether the attackers control this domain, the whois for this domain may represent an interesting avenue for future research: has been previously associated with another potential phishing domain:
finally, several of the messages came from e-mail accounts hosted on free mail services, like gmail. for example: interestingly, some of the addresses used in the phishing campaign are associated with active (although likely fraudulent) social media profiles. not their first time: links with other campaigns
the misspelling in the whois record also directed us towards previous reports: thamar reservoir: an iranian cyber-attack campaign against targets in the middle eastclearsky sec	http:// operation woolen-goldfish: when kittens go phishing
the clearsky sec report notes other attacks described by security companies with similarities in practices used by attackers (but not always similarities in infrastructure). these include: interestingly, the shared connections, tools, techniques and practices across threat groups do not necessarily indicate collaboration, or conclusive attribution. it may be that these threat actors actively share techniques and practices that work. this report expands on what is known about the targets of interest to this group, and further indicates an interest in iranis in the diaspora, and particularly those who are activists. conclusion
two-factor authentication won t eliminate phishing, but this case shows how it increases the time and effort attackers must expend. in this case, attackers had to phish two pieces of information: the password and the two-factor authentication code. the deception had to last through an entire falsified login flow. this approach required a more involved deception than a simple one-off phish, which the attackers may have learned through trial and error. moreover, they had to phish in real time, given the expiration time of the two-factor authentication code. the effort involved suggests that, without serious automation, this attack technique will not scale well. the attack also revealed several telling details about these attackers that complement previous reports. first, the attackers have targets that extend beyond the groups mentioned in reports by clearsky and trend micro, and into activist circles. second, these attackers have clearly conducted some detailed research into their targets activities, further suggesting a highly targeted attack. although real time attacks against two-factor authentication have been described for at least a decade, there are few public reports of such attacks against political targets. it may be that, as a growing number of potential targets have begun using two-factor authentication on their e-mail accounts out of a concern for their security, politically-motivated attackers are borrowing from a playbook that financial criminals have written over the past decade. practical note: two steps attackers hate!
use two factor authentication
the extra deception that the attackers were forced to use in these cases was spotted by those who shared attacks with us. by using two-factor authentication and staying vigilant, the targets stayed safer. implementing two-factor authentication on all of your accounts is an important security step for everyone. click here for a comprehensive list of two-factor authentication providers. google also recommends that, for increased security, you use the google authenticator app over the text-message based approach. click here for a guide to setting up the google authenticator app. if you want to take the next step and prevent this whole class of phishing, consider investing in an inexpensive u2f key to use with compatible online accounts. one quick check to spot these (more obvious) fakes!
when you are logging into gmail or other mail services you should always see https://www.accounts.google. com or similar at the front of the webpage url. here is a real gmail login (left) and a fake login page (right).2 some fakes won t be so sloppy. some attackers may get a certificate for a malicious domain, and it is possible (although difficult to do and hide) to get a fraudulent certificate for a major domain. still, looking to make sure the base domain is correct is a simple practice worth following.
