symantec official blog
shamoon: multi-staged destructive attacks limited to specific targets
recent attacks involving the destructive malware shamoon appear to be part of a much wider campaign in the middle east and beyond. created 27 feb 2017
recent attacks involving the destructive malware shamoon ( ) were launched by attackers conducting a much wider campaign in the middle east. while the attackers have compromised multiple targets in the region, only selected targets in saudi arabia were infected with shamoon. on february 15, publications from ibm (the full shamoon) and palo alto (magic hound) separately discussed a persistent attack campaign operating primarily in the middle east with links to shamoon. this campaign was conducted by a group we identify as timberworm. the group appears to have facilitated the third wave of destructive attacks involving shamoon in january 2017. timberworm operates in the middle east and beyond. only specific organizations affiliated with saudi arabia appear to have been earmarked for destructive wiping attacks. during the january attacks, symantec discovered a high correlation between timberworm and the presence of shamoon in a number of organizations in saudi arabia. timberworm appears to have gained access to these organizations networks weeks and, in some cases, months before the shamoon attacks occurred. once on the network, the attackers' primary goal appeared to be similar to greenbug (an actor previously discussed in relation to the november 17 wave of attacks): detailed network reconnaissance, credential harvesting, and persistent remote access. when timberworm had sufficient access to a number of high value organizations, shamoon was then preconfigured with a wipe date and the necessary credentials to maximize the overall impact during a coordinated attack. this procedure is consistent with what was observed during greenbug operations prior to the november 17 attacks, which may indicate that multiple groups are cooperating to facilitate these destructive attacks, possibly at the direction of a single entity. stage 1: timberworm recon
timberworm s carefully planned operation saw the attackers send spear phishing emails to individuals at targeted organizations. in some cases, the emails contained microsoft word or excel files as attachments. in others, the emails contained malicious links, which if clicked, downloaded similar word or excel files. computer network exploitation
opening the document invoked powershell from a malicious macro, which provided the attackers with remote access to the compromised computer. some basic reconnaissance was then performed using existing system tools to determine if the target was of interest. once timberworm was satisfied, it then deployed custom malware, hacktools, and software traditionally used in system/network administration. some of the tools deployed during these attacks included: psexec, a tool for executing processes on other systems from microsoft sysinternals
paexec, a free re-implementation of psexec from poweradmin
netscan, a multipurpose ipv4/ipv6 network scanner
samdump, a hacking tool that dumps windows password hashes
mimikatz (hacktool.mimikatz), a hacking tool to harvest credentials
tightvnc, an open-source remote desktop access application
plink, a command line network connection tool supporting encrypted communications
rar, archiving utility for compressing files before ex-filtration.
during this phase, once the attacker appeared to have achieved the desired level of network access, plink was executed to provide an additional avenue of remote access (fex reverse rdp over ssh connections). this pattern of activity is also consistent with what was observed during greenbug operations in 2016, before the eventual deployment of shamoon. stage 2: shamoon destruction
at this point the attackers configured the shamoon payloads per organization and then coordinated the attacks on a pre-determined date. in the january 23 attacks symantec observed consistent usage of paexec across numerous organizations to initially deploy . after it was deployed, it would self-propagate and wipe accessible computers across the network. multiple teams cooperating?
timberworm appears to be a much larger operation, infiltrating a much broader range of organizations beyond those affected by the recent shamoon attacks. similarly, greenbug targeted a range of organizations in the middle east beyond those affected by shamoon, including companies in the aviation, energy, government, investment, and education sectors. while both groups leveraged two distinct toolsets, their targets, tactics, and procedures align very well and in close proximity to the coordinated wiping events. living off the land the shamoon attacks illustrate how a growing number of targeted attack groups are relying on common-off-the-shelf tools to compromise targets. the shamoon attackers managed to get access to targets networks using socially engineered spear-phishing emails and abusing office macros and powershell to gain initial footholds. in particular, the use of powershell has been a popular tactic of late. recent symantec research found a total of 111 malware families that use the powershell command line. more than 95 percent of the powershell scripts analyzed through the bluecoat malware analysis sandbox were found to be malicious. the appeal of living off the land is obvious. attackers believe malicious activity will be more difficult to detect if legitimate tools are involved and malware use is kept to a minimum. the use of legitimate tools may also serve to thwart attribution to specific actors. protection
symantec and norton products protect against shamoon with the following detections: