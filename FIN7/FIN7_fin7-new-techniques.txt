fin7 hacking group is switched to new techniques to evade detection
october 10, 2017 by pierluigi paganini the financially-motivated fin7 apt group (also known as carbanak or anunak) recently changed attack technique again to evade detection.
the financially-motivated fin7 apt group (also known as carbanak or anunak) recently changed attack technique again and has been implementing a new malware obfuscation method. the group that has been active since late 2015, it was highly active since the beginning of 2017. fin7 was spotted early this year to have been targeting personnel involved with united states securities and exchange commission (sec) filings at various organizations with a new powershell backdoor dubbed powersource. in april, the hacking group adopted new phishing techniques, it leveraged on hidden shortcut files (lnk files) to compromise targets. the hackers used fileless malware, but to evade detection they have since switched to using cmd files instead of lnk ones. in the documents released today, fin7 appears to have pivoted from using ole embedded lnk files to using ole embedded cmd files. when executed, the cmd file writes jscript to under the current user s home directory. the batch script then copies itself to , also under the current user s home directory, before running wscript using the jscript engine on the file. this jscript code will read from the file , skipping the first four lines (the cmd code itself), but otherwise evaluating anything after the first character for each line in the file. reads the analysis published by security experts. both cmd and lnk file formats result in code execution, but the shift towards using cmd files may indicate a desire to stay ahead of detection authors. the shift towards using ole embedded cmd files results in code execution on the victim s machine. the fin7 hackers also implemented a series of changes to the obfuscation technique for their unique backdoor, halfbaked, that was continuously improved over the years. over the course of the past year, the actor s unique backdoor, halfbaked, has continued to morph to improve capabilities and reduce detection surface. in the newest observed version, icebrg observed a slight tweak in the obfuscation strategy. continues the analysis. previously, different stages of the halfbaked codebase utilized base64 encoding, stored in a string array variable called srctxt . the attacker now obfuscates that name and continues to break up the base64 string into multiple strings within an array icebrg discovered the halfbaked backdoor now includes a built-in command called getnk2 which was designed to retrieve the target s microsoft outlook email client auto-complete list. the presence of getnk2 suggests the fin7 group aims to launch phishing attacks within a victim organization. experts noticed nk2 files are used only for microsoft outlook 2007 and 2010, newer versions of outlook no longer use them, so fin7 hackers leveraged a custom-functionality to handle newer versions of outlook within the same getnk2 command. fin7 backdoor improvements the changes in the fin7 attack techniques demonstrate that they are highly adaptable. detection authors must make trade-offs to optimize signature performance; narrow signatures lead to high fidelity detections, but risk missing changes in actor behaviors, meanwhile broader detection patterns provide better coverage, at the risk of more false positives. combatting a well-resourced and adaptive adversary requires a layered approach of both signature styles, concludes icebrg. anunak apt banking cyber crime fin7 hacking russia
