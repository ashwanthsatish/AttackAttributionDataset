fin7 spear phishing campaign targets personnel involved in sec filings
march 07, 2017 | by steve miller, jordan nuce, barry vengerik | advanced malware
in late february 2017, fireeye as a service (faas) identified a spear phishing campaign that appeared to be targeting personnel involved with united states securities and exchange commission (sec) filings at various organizations. based on multiple identified overlaps in infrastructure and the use of similar tools, tactics, and procedures (ttps), we have high confidence that this campaign is associated with the financially motivated threat group tracked by fireeye as fin7. fin7 is a financially motivated intrusion set that selectively targets victims and uses spear phishing to distribute its malware. we have observed fin7 attempt to compromise diverse organizations for malicious operations usually involving the deployment of point-of-sale malware primarily against the retail and hospitality industries. spear phishing campaign
all of the observed intended recipients of the spear phishing campaign appeared to be involved with sec filings for their respective organizations. many of the recipients were even listed in their company s sec filings. the sender email address was spoofed as edgar <filings@ > and the attachment was named (md5: ). an example email is shown in figure 1. figure 1: example of a phishing email sent during this campaign we have observed the following ttps with this campaign: the malicious documents drop a vbs script that installs a powershell backdoor, which uses dns txt records for its command and control. this backdoor appears to be a new malware family that fireeye isight intelligence has dubbed powersource. powersource is a heavily obfuscated and modified version of the publicly available tool dns_txt_pwnage. the backdoor uses dns txt requests for command and control and is installed in the registry or alternate data streams. using dns txt records to communicate is not an entirely new finding, but it should be noted that this has been a rising trend since 2013 likely because it makes detection and hunting for command and control traffic difficult.
we also observed powersource being used to download a second-stage powershell backdoor called textmate in an effort to further infect the victim machine. the textmate backdoor provides a reverse shell to attackers and uses dns txt queries to tunnel interactive commands and other data. textmate is memory resident often described as fileless malware. this is not a novel technique by any means, but it s worth noting since it presents detection challenges and further speaks to the threat actor s ability to remain stealthy and nimble in operations.
in some cases, we identified a cobalt strike beacon payload being delivered via powersource. this particular cobalt strike stager payload was previously used in operations linked to fin7.
we observed that the same domain hosting the cobalt strike beacon payload was also hosting a carbanak backdoor sample compiled in february 2017. carbanak malware has been used heavily by fin7 in previous operations.
victims
thus far, we have directly identified 11 targeted organizations in the following sectors: financial services, with different victims having insurance, investment, card services, and loan focuses
transportation
retail
education
it services
electronics
all these organizations are based in the united states, and many have international presences. as the sec is a u.s. regulatory organization, we would expect recipients of these spear phishing attempts to either work for u.s.-based organizations or be u.s.-based representatives of organizations located elsewhere. however, it is possible that the attackers could perform similar activity mimicking other regulatory organizations in other countries. implications
we have not yet identified fin7 s ultimate goal in this campaign, as we have either blocked the delivery of the malicious emails or our faas team detected and contained the attack early enough in the lifecycle before we observed any data targeting or theft. however, we surmise fin7 can profit from compromised organizations in several ways. if the attackers are attempting to compromise persons involved in sec filings due to their information access, they may ultimately be pursuing securities fraud or other investment abuse. alternatively, if they are tailoring their social engineering to these individuals, but have other goals once they have established a foothold, they may intend to pursue one of many other fraud types. previous fin7 operations deployed multiple point-of-sale malware families for the purpose of collecting and exfiltrating sensitive financial data. the use of the carbanak malware in fin7 operations also provides limited evidence that these campaigns are linked to previously observed carbanak operations leading to fraudulent banking transactions, atm compromise, and other monetization schemes.