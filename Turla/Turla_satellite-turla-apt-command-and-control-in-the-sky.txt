satellite turla: apt command and control in the sky
how the turla operators hijack satellite internet links
by stefan tanase on september 9, 2015. 9:58 am have you ever watched satellite television? were you amazed by the diversity of tv channels and radio stations available? have you ever looked in wonder at satellite phones or satellite-based internet connections wondering what makes them tick? what if we told you that there s more to satellite-based internet connections than entertainment, traffic and weather? much, much more. [youtube ]
when you are an apt group, you need to deal with many different problems. one of them, and perhaps the biggest, is the constant seizure and takedown of domains and servers used for command-and-control (c&c). these servers are constantly appropriated by law enforcement or shut down by isps. sometimes they can be used to trace the attackers back to their physical locations. some of the most advanced threat actors or users of commercial hacking tools have found a solution to the takedown problem the use of satellite-based internet links. in the past, we ve seen three different actors using such links to mask their operations. the most interesting and unusual of them is the turla group. also known as snake or uroburos, names which come from its top class rootkit, the turla cyber-espionage group has been active for more than 8 years. several papers have been published about the group s operations, but until the epic turla research was published by kaspersky lab, little information was available about the more unusual aspects of their operations, such as the first stages of infection through watering-hole attacks. what makes the turla group special is not just the complexity of its tools, which include the uroboros rootkit, aka snake , as well as mechanisms designed to bypass air gaps through multi-stage proxy networks inside lans, but the exquisite satellite-based c&c mechanism used in the latter stages of the attack. in this blog, we hope to shed more light on the satellite-based c&c mechanisms that apt groups, including the turla/snake group, use to control their most important victims. as the use of these mechanisms becomes more popular, it s important for system administrators to deploy the correct defense strategies to mitigate such attacks. for iocs, see the appendix. satellite turla: apt command and control in the sky technical details
although relatively rare, since 2007 several elite apt groups have been using and abusing satellite links to manage their operations most often, their c&c infrastructure. turla is one of them. using this approach offers some advantages, such as making it hard to identify the operators behind the attack, but it also poses some risks to the attackers. on the one hand, it s valuable because the true location and hardware of the c&c server cannot be easily determined or physically seized. satellite-based internet receivers can be located anywhere within the area covered by a satellite, and this is generally quite large. the method used by the turla group to hijack the downstream links is highly anonymous and does not require a valid satellite internet subscription. on the other hand, the disadvantage comes from the fact that satellite-based internet is slow and can be unstable. in the beginning, it was unclear to us and other researchers whether some of the links observed were commercial internet connections via satellite, purchased by the attackers, or if the attackers had breached the isps and performed man-in-the-middle (mitm) attacks at the router level to hijack the stream. we have analyzed these mechanisms and come to the astonishing conclusion that the method used by the turla group is incredibly simple and straightforward, as well as highly anonymous and very cheap to operate and manage. real satellite links, mitm attacks or bgp hijacking?
purchasing satellite-based internet links is one of the options apt groups can choose to secure their c&c traffic. however, full duplex satellite links can be very expensive: a simple duplex 1mbit up/down satellite link may cost up to $7000 per week. for longer term contracts this cost may decrease considerably, but the bandwidth still remains very expensive. another way of getting a c&c server into a satellite s ip range is to hijack the network traffic between the victim and the satellite operator and to inject packets along the way. this requires either exploitation of the satellite provider itself, or of another isp on the way. these kinds of hijacking attacks have been observed in the past and were documented by renesys (now part of dyn) in a blogpost dated november 2013. according to renesys: various providers bgp routes were hijacked, and as a result a portion of their internet traffic was misdirected to flow through belarusian and icelandic isps. we have bgp routing data that show the second-by-second evolution of 21 belarusian events in february and may 2013, and 17 icelandic events in july- august 2013. in a more recent blogpost from 2015, dyn researchers point out that: for security analysts reviewing alert logs, it is important to appreciate that the ip addresses identified as the source of incidents can and are regularly spoofed. for example, an attack that appeared to come from a comcast ip located in new jersey may really have been from a hijacker located in eastern europe, briefly commandeering comcast ip space. it is interesting to note that all six cases discussed above were conducted from either europe or russia. obviously, such incredibly apparent and large-scale attacks have little chance of surviving for long periods of time, which is one of the key requirements for running an apt operation. it is therefore not very feasible to perform the attack through mitm traffic hijacking, unless the attackers have direct control over some high-traffic network points, such as backbone routers or fiber optics. there are signs that such attacks are becoming more common, but there is a much simpler way to hijack satellite-based internet traffic. satellite turla: apt command and control in the sky satellite link (dvb-s) hijacking
the hijacking of satellite dvb-s links has been described a few times in the past and a presentation on hijacking satellite dvb links was delivered at blackhat 2010 by the s21sec researcher leonardo nve egea. to hijack satellite dvb-s links, one needs the following: a satellite dish the size depends on geographical position and satellite
a low-noise block downconverter (lnb)
a dedicated dvb-s tuner (pcie card)
a pc, preferably running linux
while the dish and the lnb are more-or-less standard, the card is perhaps the most important component. currently, the best dvb-s cards are made by a company called tbs technologies. the tbs-6922se is perhaps the best entry-level card for the task. satellite turla: apt command and control in the sky tbs-6922se pcie card for receiving dvb-s channels the tbs card is particularly well-suited to this task because it has dedicated linux kernel drivers and supports a function known as a brute-force scan which allows wide-frequency ranges to be tested for interesting signals. of course, other pci or pcie cards might work as well, while, in general the usb-based cards are relatively poor and should be avoided. unlike full duplex satellite-based internet, the downstream-only internet links are used to accelerate internet downloads and are very cheap and easy to deploy. they are also inherently insecure and use no encryption to obfuscate the traffic. this creates the possibility for abuse. companies that provide downstream-only internet access use teleport points to beam the traffic up to the satellite. the satellite broadcasts the traffic to larger areas on the ground, in the ku band (12-18ghz) by routing certain ip classes through the teleport points. how does satellite internet hijacking work?
satturla_ani to attack satellite-based internet connections, both the legitimate users of these links as well as the attackers own satellite dishes point to the specific satellite that is broadcasting the traffic. the attackers abuse the fact that the packets are unencrypted. once an ip address that is routed through the satellite s downstream link is identified, the attackers start listening for packets coming from the internet to this specific ip. when such a packet is identified, for instance a tcp/ip syn packet, they identify the source and spoof a reply packet (e.g. syn ack) back to the source using a conventional internet line. at the same time, the legitimate user of the link just ignores the packet as it goes to an otherwise unopened port, for instance, port 80 or 10080. there is an important observation to make here: normally, if a packet hits a closed port, a rst or fin packet will be sent back to the source to indicate that there is nothing expecting the packet. however, for slow links, firewalls are recommended and used to simply drop packets to closed ports. this creates an opportunity for abuse. abused internet ranges
during the analysis, we observed the turla attackers abusing several satellite dvb-s internet providers, most of them offering downstream-only connections in the middle east and africa. interestingly, the coverage of these beams does not include europe or asia, meaning that a dish is required in either the middle east or africa. alternatively, a much larger dish (3m+) can be used in other areas to boost the signal. to calculate the dish size, one can use various tools, including online resources such as : satellite turla: apt command and control in the sky sample dish calculation (c) www. the table below shows some of the command-and-control servers related to the turla actor with domains resolving to an ip belonging to satellite-based internet providers:
the observed satellite ips have the following whois information:
ne interesting case is probably , which falls into the satellite ip range of iabg mbh. this ip is encrypted in the c&c of the following backdoor used by turla group, known as agent.dne : this agent.dne sample has a compilation timestamp of thu nov 22 14:34:15 2007, meaning that the turla group has been using satellite-based internet links for almost eight years. conclusions
the regular usage of satellite-based internet links by the turla group represents an interesting aspect of their operation. the links are generally up for several months, but never for too long. it is unknown if this is due to operational security limitations self-imposed by the group or because of shutdown by other parties due to malicious behavior. the technical method used to implement these internet circuits relies on hijacking downstream bandwidth from various isps and packet-spoofing. this is a method that is technically easy to implement, and provides a much higher degree of anonymity than possibly any other conventional method such as renting a vps or hacking a legitimate server. to implement this attack methodology, the initial investment is less than $1000. regular maintenance should be less than $1000 per year. considering how easy and cheap this method is, it is surprising that we have not seen more apt groups using it. even though this method provides an unmatched level of anonymfor logistical reasons it is more straightforward to rely on bullet-proof hosting, multiple proxy levels or hacked websites. in truth, the turla group has been known to use all of these techniques, making it a very versatile, dynamic and flexible cyber-espionage operation. lastly, it should be noted that turla is not the only apt group that has used satellite-based internet links. hackingteam c&cs were seen on satellite ips before, as well as c&cs from the xumuxu group and, more recently the rocket kitten apt group. if this method becomes widespread between apt groups or worse, cyber-criminal groups, this will pose a serious problem for the it security and counter-intelligence communities. * a full paper on the turla group s use of satellite-based internet links is available to the customers of kaspersky intelligence services.
