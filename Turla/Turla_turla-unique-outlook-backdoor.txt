turla: in and out of its unique outlook backdoor
the latest eset research offers a rare glimpse into the mechanics of a particularly stealthy and resilient backdoor that the turla cyberespionage group can fully control via pdf files attached to emails
eset researchers have investigated a distinctive backdoor used by the notorious advanced persistent threat (apt) group known as turla (or snake, or uroburos) to siphon off sensitive communications from the authorities of at least three european countries. the group has been deploying the tool for years now and we ve found that the list of high-profile victims is longer than previously thought. the victims include germany s federal foreign office, where turla implanted the backdoor on several computers and used it for data theft for almost the whole of 2017. in fact, turla s operators first compromised the network of the country s federal college of public administration, using it as a stepping stone to breaching the network of the foreign office in march 2017. it wasn t until the end of the year that germany s security service detected the breach, which itself was only made public in march 2018. importantly, our own investigation has determined that, beyond this much-publicized security breach, the group has leveraged the same backdoor to open a covert access channel to the foreign offices of another two european countries, as well as to the network of a major defense contractor. these organizations are the latest known additions to the list of victims of this apt group that has been targeting governments, state officials, diplomats, and military authorities since at least 2008. dissecting the backdoor
the backdoor that is the subject of our analysis has come a long way since it was created, possibly as far back as 2009. over the years, its authors have been adding various functionalities to the tool, ultimately endowing it with a rare degree of stealth and resilience. the most recently discovered version, from april 2018, incorporates the ability to execute malicious powershell scripts directly in computer memory, which is a tactic that threat actors of various stripes have been embracing in the past few years. figure 1 turla outlook backdoor timeline the backdoor s more recent iterations target microsoft outlook, although its older versions also took aim at the the bat! email client, which is used mostly in eastern europe. importantly, turla s operators don t exploit any vulnerabilities either in pdf readers or microsoft outlook as attack vectors. unusually, the backdoor subverts microsoft outlook s legitimate messaging application programming interface (mapi) to access the targets mailboxes. rather than using a conventional command-and-control (c&c) infrastructure, such as one based on http(s), the backdoor is operated via email messages; more specifically, through specially crafted pdf files in email attachments. the compromised machine can be instructed to carry out a range of commands. most importantly, these include data exfiltration, as well as the downloading of additional files and the execution of additional programs and commands. data exfiltration itself also takes place via pdf files. the backdoor which comes in the form of a dynamic link library (dll) module and can be placed anywhere on the hard drive is installed using a legitimate windows utility ( ). meanwhile, persistence is accomplished by tampering with the windows registry, which is frequently the case when windows systems are compromised. in this case, turla sticks to a tried-and-tested technique known as com object hijacking . this ensures that every time microsoft outlook is launched, the backdoor is activated. doing the bidding
whenever the victim receives or sends an email message, the malware generates a log that contains metadata about the message, including about its sender, recipient, subject, and its attachment name. on a regular basis, the logs are bundled together with other data and transmitted to turla s operators via a specially-crafted pdf document that is attached to an email message. additionally, in each incoming email, the backdoor checks for the presence of a pdf that may contain commands from the attacker. in fact, it is operator-agnostic , meaning that it accepts commands from anybody who can encode them into a pdf document. as a corollary, turla s operators are able to regain control of the backdoor by sending a command from any email address, should any of their hardcoded but updatable email addresses be blocked. the backdoor s level of resilience to takedowns is almost on a par with that of a rootkit that, in inspecting inbound network traffic, listens for commands from its operators. even though eset researchers haven t obtained any sample of a pdf containing actual commands for the backdoor, the knowledge of its inner workings has enabled them to generate a pdf document (see figure 2) with orders that the backdoor can interpret and execute. figure 2 execution of the commands specified in the pdf document the malware generally goes to great lengths to embed itself out of sight on compromised machines. for example, while it is possible, for a few seconds, to catch a glimpse of an incoming email message in the unread email count indicator, no email received by the attacker ever shows up in the mailbox. similarly, the malware also blocks any notifications of incoming email messages sent by its operators. in conclusion
this is far from the first time that eset researchers have documented the resourcefulness of turla s operators in reaching their goals while staying under the radar. much as our recent analyses of the group s backdoor gazer and its campaign targeting eastern european diplomats have shown, the group continues to employ advanced techniques in a bid to spy on its targets and to maintain persistent malware on compromised machines. the turla backdoor is a fully-fledged backdoor that uses customized and proprietary techniques, can work independently of any other turla component, and is fully controlled by email. in fact, eset researchers are not aware of any other espionage group currently utilizing a backdoor that is entirely controlled by emails, and specifically through pdf attachments. a full and comprehensive list of indicators of compromise (iocs) and samples can be found on github. for a detailed analysis of the backdoor, head over to our white paper turla outlook backdoor: analysis of an unusual turla backdoor.
