september 2, 2016
can a bear fit down a rabbit hole? can a bear fit down a rabbit hole?
threatconnect identifies infrastructure nexus between attacks against state election boards and spearphishing campaign against turkish, ukrainian governments the question on everyone s mind: who is behind the recently reported compromises of arizona and illinois state board of elections (sboe)? the answer is, we don t know. when we reviewed fbi t-ld1004-tt, we initially found a pile of highly circumstantial evidence suggesting the adversary could be of russian origin. the combination of the attacks relying on widely available open source tools and the superficial involvement of russian infrastructure left us thinking russian attribution was plausible but not certain as we were unable to determine if the attacks were criminally motivated or state sponsored with any confidence. we also were unable to identify any additional ties to malicious activity directed against any other state boards of election. however, as we looked into the 5.149.249[.]172 ip address within the fbi flash bulletin, we uncovered a spearphishing campaign targeting turkey s ruling justice and development (ak) party, ukrainian parliament, and german freedom party figures from march - august 2016 that fits a known russian targeting focus and modus operandi. as we explored malicious activity in the ip ranges around 5.149.249[.]172 we found additional linkages back to activity that could be evidence of russian advanced persistent threat (apt) activity. this connection around the 5.149.249[.]172 activity is more suggestive of state-backed rather than criminally motivated activity, although we are unable to assess which actor or group might be behind the attacks based on the current evidence. the timing of this activity is notable, as in mid-july wikileaks published approximately 300,000 emails purportedly obtained via a compromise of the turkish justice and development (ak) party s computer systems. therefore, we cannot definitively attribute the spearphishing campaign as the source of the leak. however, if russian apt actors compromised and leaked ak party emails, it would be consistent with russian collection and influence operations that have recently focused on u.s. politics. collection against the ruling turkish party could provide russia with intelligence that could potentially inform diplomatic relations and military efforts in eastern europe, ongoing military operations in syria, while also potentially providing fodder for influence operations that could be used to publicly denigrate or defame politicians. the graphic below visualizes what we know about the attacks by leveraging the diamond model of intrusion analysis (for a more whimsical example, see how we applied the diamond model to the destruction of the death star). the diamond in the center of the graphic shows the information originally shared about the attacks against the state boards of elections. the callout boxes radiating off the diamond highlight our main findings and their relevance to an attribution assessment. diamond model az il state board election attacks
threatconnect analytic findings arranged using a diamond model representation of the attacks against the arizona and illinois state boards of election circumstantial ties to russia
over the course of our research, we identified several strands that suggest - but do not prove - russian origin: six of the eight ip addresses belong to a russian-owned hosting service
5.149.249[.]172 hosted a russian cybercrime market from january - may 2015
other ips belonging to fortunix infrastructure - the same provider as 5.149.249[.]172 - were seen in 2015 ukraine power grid and news media denial of service attacks
the acunetix and sql injection attack method closely parallel the video from a purported anonymous poland (@anpoland) handle describing how they obtained athlete records from court of arbitration for sport (cas).
russian-owned hosting service. six of the domains identified in the fbi report are owned by king servers (king-servers[.]com), a vps/vds hosting provider. while these ips are physically located in the u.s. and the netherlands, king servers is based out of russia and their website defaults to russian language, as seen below. the use of a russian vps hosting service suggests, but does not definitively indicate, that the individuals behind the activity identified in the fbi report are russian. russian owned king servers election board hack additionally, domaintools historical whois information for the king servers domain identifies that it was originally registered by vladimir fomenko from biysk, russia. a linkedin profile for fomenko also identifies him as the ceo and founder of king servers. state election board hack king servers tor relay vs tor exit node. one of the king server ips, 185.104.9[.]39, was running an active tor relay in august, at the time that the fbi report states it was identified in the intrusion of another state s board of election system. this relay is using the nickname villariba , and is actually not an exit node. this is significant because normally if an attacker was routing activity through tor, the end ip identified in the intrusion should be the ip of an exit node; the fact that this ip has a tor relay that is not an exit implies that the server at this ip address is either hosting an additional proxy service that was used by the attackers, or the attackers are actually controlling the server and may be in control of the tor relay. white paper: 6 easy ways to advance your cybersecurity program
ioc previously hosted russian cybercrime forum. one of the domains previously hosted at 5.149.249[.]172 was rubro[.]cc, which is expired. however, a historical entry for this website in the wayback machine dated august 13, 2015 shows an http 301 redirect to the website https[:]//rubro[.]biz/. this russian language website is called market rubro ltd [sic.], and uses the title rubro , translating to forum rubro - criminal black market. state election board hack russian cybercrime forum other fortunix infrastructure associated with blackenergy activity. ip addresses 5.149.254[.]114 and 5.149.248[.]67 (both netherlands), which are owned by the same fortunix networks company as 5.149.249[.]172, were previously identified in a sentinel report and virustotal respectively as being associated with blackenergybot activity. activity from these ips have targeted the ukrainian power grid and news media. research into fortunix networks indicates that they are owned by hostzealot, a vps and vds hosting provider headquartered in bulgaria, which operates at least 13 ip ranges in various european countries and canada. overlap with open source tools. the fbi report indicated that the attackers used acunetix, sql injection, and sqlmap to target the sboe website(s). these tools and tactics, techniques, and procedures (ttps) are consistent with those that @anpoland, a group that may be associated with russian apt activity, used to scan the cas website and exploit their databases. as these tools and methods are widely used, they are not attributable to one specific group; however, the timing of the sboe and cas activity suggests a circumstantial link between the two. an unexpected development: 5.149.249[.]172 hosting spearphishing attack against primarily turkish, ukrainian government targets
while we were unable to identify any additional information related to the state board of election attacks, reviewing hosting resolutions for the 5.149.249[.]172 ip address clued us into another target of these actors. passive dns analysis of this ip revealed domains typosquatting a website for turkey s ruling ak party hosted between march and august 2016. investigation of this typosquat took us down the rabbit hole that ultimately uncovered evidence of a recent spearphishing campaign primarily targeting individuals affiliated with turkish and ukrainian political organizations. passive dns analysis of 5.149.249[.]172 two of the domains -- akpartl.info[.]tr and supportmail.biz[.]tr -- were hosted at the 5.149.249[.]172 ip address in 2016, during times consistent with the state board of election attacks. the akpartl.info[.]tr domain appears to spoof the legitimate domain belonging to the turkish ak party website, akparti.org[.]tr. at the time of writing, the spoofed domain redirects to a legitimate turkish ak party website akpartiistanbul[.]com. threatconnect passive dns analysis state election board attack the mail server for this spoofed domain, mail.akpartl.info[.]tr, leverages moscow-based webmail provider yandex as a mail exchanger. according to shodan, this host is running a simple mail transfer protocol (smtp) postfix service. attack against state election board smtp service the other domain recently hosted at the 5.149.249[.]172 ip address, supportmail.biz[.]tr, also appears to have been used against the turkish ak party. this domain currently redirects to the aforementioned akpartiistanbul[.]com legitimate domain. both of these domains were registered in january 2016 and later resolved to, and probably were operationalized from, the 5.149.249[.]172 ip address. this timing is significant as the ak party was a recent victim of a july 2016 email leak by wikileaks. however, to identify a more substantial link between 5.149.249[.]172 ip address and the ultimate leak on wikileaks, we had to delve further into the akpartl.info[.]tr spoofed domain. chasing the rabbit down its hole
leveraging threatconnect s farsight passive dns integration, we were able to identify that several subdomains exist for the akpartl.info[.]tr spoofed domain, including ksdafoiuf9w54ygdjoi.akpartl.info[.]tr. threatconnect farsight passive dns state election board spoofed domain visiting the ksdafoiuf9w54ygdjoi.akpartl.info[.]tr subdomain directs the visitor to ksdafoiuf9w54ygdjoi.akpartl.info[.]tr/admins/sign_in where an instance of phishing frenzy, an open source phishing framework, is running. note the title and footer of the page in the screenshot below. state election board hack phishing frenzy after some investigation, we navigated to hxxp://ksdafoiuf9w54ygdjoi.akpartl.info[.]tr/letter_opener, which displayed a list of what appears to be all of the emails these actors have sent in this campaign. phishing attack state election board there were 113 emails listed between march 22, 2016 and august 03, 2016. the bulk of the emails were sent between march 22 and april 20, 2016. state election board breach russian emails
graph of all of the emails sent from this instance of phishing frenzy phishing frenzy emails russian election board attack
graph showing the number of emails, by language, sent from this instance of phishing frenzy in the march-april timeframe. note: 15 of the emails contain multiple languages and, thus, are included in the counts of multiple languages. from the 34 victim email addresses that were found on the command and control server, two stood out as unusual: ali.bolduin[@]yandex[.]com and deputat.babiy[@]gmail[.]com. these two email addresses were found in the very earliest phishing email templates. they do not appear to be connected with a specific target or individual found in the open source. we believe that these two addresses were used to test the phishing attacks before sending the spearphish to an actual target. the use of a yandex account for testing purposes, coupled with akpartl.info[.]tr s aforementioned use of a yandex mail exchanger, provides evidence that the individuals behind this activity are clearly leveraging and abusing russian services to test and carryout attacks. out of the 113 total emails, 48 of them are gmail-themed, designed to look like gmail security emails in order to collect a victim s google account information. the rest are specifically designed to look like an email from an organization with which the target is affiliated or ostensibly interested. at least 16 of the emails are designed to look like ak party emails. there is one email that has a linkedin theme and another that is intel corporation themed. the email bodies are written in a variety of languages including turkish, english, ukrainian, and german. based on the email bodies and the intended recipients, targets of this spearphishing campaign included individuals in the ak party, verkhovna rada (parliament) of ukraine, and german freedom party (die freiheit). of note, 16 of the ak party officials targeted in this campaign show up in the july 19 wikileaks dump of nearly 300,000 ak party emails that included over 1400 ak party email accounts. spearphishing emails state election board hack
graph of the languages represented in the spearphishing emails. note: 15 of the emails contain multiple languages and, thus, are included in the counts of multiple languages. included below are some screenshots of emails from this phishing frenzy site. russian spearphishing election hack russian spearphishing election hack 2 russian spearphishing election hack 3 russian spearphishing election hack 4 russian spearphishing election hack 5 state election board hack fancy bear the gmail-themed emails, roughly translated, read something like: hello user! your account is blocked for violating of terms of service of our company. in the period from 03/29/2016 to 04/01/2016 it was observed that your account has sent mass email advertisements. perhaps you did not, and attackers using special programs to send spam, used your data (email address, name). if you have not sent any emails, go to this link and follow the instructions. your account is under control. you can view and adjust your privacy settings at any time in your account .. do not reply to this letter. if you have any questions, please contact technical support. technical services manager almost all of the links in the phishing emails lead to a subdomain on the srvddd[.]com host, which currently has a handful of phishing domains resolving to it, like the one shown below. russian spearphishing state election board hack subdomain srvddd[.]com was registered using the email address vittorio_80@mail[.]com and is currently hosted at the 5.149.248[.]193 ip address, which is in the same range as the aforementioned fortunix network ip addresses. while not unique, the use of a 1&1 email address to register a domain is a ttp consistent with recent fancy bear activity. based on passive dns, there are several subdomains for the srvddd[.]com domain that most likely have been used in such operations dating back to november 2014. a domaintools screenshot of srvddd[.]com dated may 9, 2015 shows a directory named was present on the server, suggesting it was used to target solydarnist[.]org, the official website of the political party of incumbent ukrainian president petro oleksiyovych poroshenko. another sample of a historical ukraine related malicious targeting attempt using srvddd[.]com is found at http[:]//privatbank-info.io[.]ua/journal.php, where a user bordan posted an html tag inside a comment, attempting to induce a cross-site scripting (xss) attack that would load the javascript found at http[:]//onlysoop.srvddd[.]com/fone/script.js. this suggests that the domain may have been used for other attacks beyond the credential harvesting emails identified in the phishing frenzy campaign. white paper: maturing a threat intelligence program
there is one link that does not direct to a subdomain of srvddd[.]com. instead, this link points visitors to http://mail.akpartl.info[.]tr:35000/login2/loginpage - a credential harvesting page designed to look like a login page for a kerio connect webmail client. submitting this form redirects victims to mail.akpartiistanbul[.]com:35000/webmail/login2/loginpage, the legitimate kerio connect login page for an actual ak party website. kerio connect state election board hack based on these developments, we can expand our original diamond model graphic to show how new infrastructure and capabilities were leveraged to target additional victims. tc diamond model state election board hack discussion, analysis, and conclusions
fancy bear state election board hack
a visual representation of how the sboe and spearphishing activity fit with previous research on fancy bear activities. since we started researching the dnc breach back in june, this story has taken us on one crazy turn after another. we have identified links between breaches and outlets for strategic leaks that give us greater confidence in our attribution assessments. that said, this chapter feels like the most bizarre yet and leaves us with more questions than answers, including: how widespread is the targeting effort against state board of elections? so far we know of two, but we do not know if arizona and illinois represent our sample size.
does the reliance on open source tools reflect an inexperienced adversary or an adaptive adversary? using open source tools may identify an adversary that cannot create their own custom tools. it can also reflect an adversary that intentionally leverages open source tools for operational security purposes like avoiding attribution or the use of sensitive tools or methods.
are the attackers really after voter registration information or was this a phase one operation? without clear attribution to a specific actor or apt group, we cannot determine the actors motivations and what they would ultimately seek to do to or later target with any collected intelligence.
is there a relationship between the ak party spearphishing effort and the wikileaks dump of ak party emails? there s an overarching storyline that seems appealing here: a major political party in a country with a strained geopolitical relationship with moscow gets hacked and large amounts of embarrassing data gets dumped on a leak website. however, there is much less evidence available to weigh with the ak party emails than the dnc breach.
further complicating the situation, phineas fisher, a hacktivist that gained notoriety for his hack against gamma group and hacking team, claimed he compromised the ak party and provided their emails to wikileaks. at this time, we cannot refute or verify phineas fisher s claims and wikileaks is the only authoritative source that can confirm his involvement. if phineas fisher s claims are false, it would strengthen the argument that the phishing frenzy activity ultimately resulted in the leak. if phineas fisher s claims are true, there are three conceivable explanations to the situation: phineas fisher and the actors behind the activity in the fbi report both targeted and compromised the ak party.
phineas fisher was the only one to actually compromise the ak party and none of the aforementioned phishing frenzy efforts were successful.
phineas fisher and the actors behind the activity in the fbi report are connected.
if a russian apt group is conducting this activity seeking to hack the ruling turkish political party, collected intelligence and follow-on operations could ultimately allow for the following: informed diplomatic relations - russia s diplomatic relations with turkey are integral based on their close proximity and turkey s status as a nato member. having insider intelligence from the ruling party detailing turkey s foreign relations and diplomatic efforts can inform russia s own foreign relations as well.
informed military efforts - turkey s geographical location, situated south of russia between the middle east and eastern europe, means that it is a key piece to russian military efforts in the region. for example, intelligence from the ak party could ultimately inform russia s military preparations and actions in syria.
influence operations or leverage - similar to russian apt influence operations against the u.s. democratic party, russia may seek to release some compromised intelligence to sway public opinion or defame political ideologies in a country that is integral to russia s foreign policy.
retaliations or leverage - as evidenced by russia s efforts against the world anti-doping agency and cas, russia may seek to publicly or privately denigrate or influence individuals or organizations that cast a negative light on russia. similarly, sensitive and incriminating information that might be compromising could be held over party members or leaders heads with the threat of public disclosure.
so how did we get from the sboe to turkish ak party? as you can see, it s a long story, but the takeaway is this: whether it is to ultimately collect intelligence, influence public opinion, or sow discord, doubt, or contempt with respect to political ideologies -- the individuals behind this activity, whoever they may be, are looking to manipulate multiple countries democratic processes. based on the information available, it is unclear the degree of russian sanction or sponsored involvement in either events, however it is clear that russian-based infrastructure has been identified in part - and thus with russia s new yarovaya package" authorities are now in a position to help fill in the missing details. because a wise russian once said we in russia are used to investigating first, before accusing anyone of anything. we believe it is more logical and more correct. threatconnect is sharing details of the indicators associated with this activity within threatconnect incident 20160829c: categories: blog , featured article , research , threat research
