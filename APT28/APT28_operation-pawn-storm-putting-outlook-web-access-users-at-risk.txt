operation pawn storm: putting outlook web access users at risk
posted on:october 24, 2014 at 7:04 am
posted in:bad sites, targeted attacks
author: feike hacquebord (senior threat researcher) in our recently released report, operation pawn storm, we talked about an operation that involved three attack scenarios. for this post, we will talk about the third scenario: phishing emails that redirect victims to fake outlook web access login pages. what s most notable about this is that it is simple, effective, and can be easily replicated. through one line of simple javascript code, the millions of outlook web access (owa) users are placed at risk of becoming a victim of a clever but simple phishing attack. no exploits and vulnerabilities are used here. a feature of javascript, the preview pane of microsoft s owa and two typo-squatted domains are used. we have seen this kind of phishing attack being used against us defense companies like academi (formerly known as blackwater), saic and the osce. how it works to target defense company academi, the attacker registered two typosquatted domain names: tolonevvs[dot]com (real news domain: (news site about afghanistan))
academl[dot]com (real company domain: )
a link to the typosquatted domains are then sent to academi through spear-phishing emails to a very limited number of employees who might actually expect to receive email notifications from . when the target opens the email through the preview pane of microsoft outlook web access and clicks on the typosquatted domain, a new tab will be opened which loads the original news site. from the target s perspective, their browser will look like this: pawnstorm1 figure 1. the real news site opened in a new tab after clicking the typosquatted domain (click to enlarge) this may seem harmless, but there is more to this than just an opened tab to a news site. the typosquatted domain actually contained a mildly obfuscated javascript code: pawnstorm2 figure 2. javascript code in the typosquatted domain, this javascript is not malicious because it simply sets the windows open property to point to a url: window.opener.location = hxxps://mail[dot] ?replacecurrent=1&url=https%3a%2f%2fmail. %2fowa%2f&tids=lkdmfvlkd what this means is that the legitimate url of the original owa session in the first tab of the browser gets changed to the url of the fake owa server set up by the attacker, which in this case is mail[dot]academl[dot]com. when the victim is done with reading the news and he returns to his owa session, he will see this: pawnstorm3 figure 3. phishing site opened in the original owa tab at this point, the target is likely to believe that while reading the news on the legitimate website , the owa server logged him out. the truth, however, is that if the target enters his/her credentials again, his/her information will then be captured by the attacker. for the complete details on the attacks we saw using this technique, please check out our paper, operation pawn storm. not limited to operation pawn storm or owa although we did see this technique used in a certain operation, basically any company having an owa web server is at risk becoming a victim of this kind of phish attack. even two factor authentication might not prevent a one-time complete download of the mailbox of the victim. the only safe way to prevent this kind of attack is to turn off the preview pane in owa. users of other web mail services than owa are also are at risk. for example, we verified that gmail users who read their e-mail in safari, and yahoo e-mail users who read their e-mail in safari or firefox could become victims of a similar phishing trick. users are strongly recommended to be very careful when entering their information into login pages, and to make sure that they are logging into the correct site and not a typosquatted one.
