two years of pawn storm examining an increasingly relevant threat feike hacquebord forward-looking threat research (ftr) team a trendlabssm research paper contents 4
false flag operations 8
how pawn storm attacks
free and corporate
webmail 19
pawn storm phishing
campaigns 29
preferred attacks,
resources, and tools 37
conclusion and defending
against pawn storm trend micro legal disclaimerthe information provided herein is for general information and educational purposes only. it is not intended and should not be construed to constitute legal advice. the information contained herein may not be applicable to all situations and may not reflect the most current situation. nothing contained herein should be relied on or acted upon without the benefit of legal advice based on the particular facts and circumstances presented and nothing herein should be construed otherwise. trend micro reserves the right to modify the contents of this document at any time without prior notice.translations of any material into other languages are intended solely as a convenience. translation accuracy is not guaranteed nor implied. if any questions arise related to the accuracy of a translation, please refer to the original language official version of the document. any discrepancies or differences created in the translation are not binding and have no legal effect for compliance or enforcement purposes.although trend micro uses reasonable efforts to include accurate and up-to-date information herein, trend micro makes no warranties or representations of any kind as to its accuracy, currency, or completeness. you agree that access to and use of and reliance on this document and the content thereof is at your own risk. trend micro disclaims all warranties of any kind, express or implied. neither trend micro nor any party involved in creating, producing, or delivering this document shall be liable for any consequence, loss, or damage, including direct, indirect, special, consequential, loss of business profits, or special damages, whatsoever arising out of access to, use of, or inability to use, or in connection with the use of this document, or any errors or omissions in the content thereof. use of this information constitutes acceptance for use in an as is condition. pawn storm is an active cyber espionage actor group that has been very aggressive and ambitious in
recent years. the group s activities show that foreign and domestic espionage and influence on geopolitics
are the group s main motives, and not financial gain. its main targets are armed forces, the defense
industry, news media, politicians, and dissidents. we can trace activities of pawn storm back to 20041, and before our initial report in 20142 there wasn t
much published about this actor group. however, since then we have released more than a dozen
detailed posts on pawn storm.3 this new report is an updated dissection of the group s attacks and
methodologies something to help organizations gain a more comprehensive and current view of these
processes and what can be done to defend against them. pawn storm is becoming increasingly relevant particularly because it is doing more than just espionage
activities. in 2016, the group attempted to influence public opinion, to influence elections, and sought
contact with mainstream media with some success. now the impact of these malicious activities can
be felt by various industries and enterprises operating throughout the world. even average citizens of
different countries might be affected as pawn storm tries to manipulate people s opinions about domestic
and international affairs. the attacks of pawn storm may even serve as an example for other actors, who
could copy tactics and repurpose them to fit their own objectives. as we look at pawn storm s operations over a two-year period, we can see how the group has become
more adept at manipulating events and public opinion through the gathering and controlled release of
information. many events like their involvement in the democratic national convention hack have
been covered extensively. the group s cyber propaganda methods using electronic means to influence
opinion4 creates problems on multiple levels. aside from manipulating the public, their operations also
discredit political figures and disrupt the established media. the proliferation of fake news and fake
news accusations in 2017 can in part be attributed to constant information leaks and manipulations by
malicious actors. media sources have already confirmed that pawn storm offered them exclusive peeks at
high-impact information, presumably in an attempt to skew public perception on a certain topic or person. in this paper, we take a deeper look at the facts we have compiled and delve into the variety of attacks
that the group is using. pawn storm is known for its sophisticated social engineering lures, efficient
credential phishing, zero days, a private exploit kit, an effective set of malware, false flag operations, and
campaigns to influence the public opinion about political issues. at its core, pawn storm also known as sednit5, fancy bear, apt286 7, sofacy, and strontium8 is still
a persistent cyber espionage actor group. the actors often attack the same target from different sides,
using multiple methods to reach their goals. it generally relies on practiced techniques, specifically when
it comes to phishing. credential phishing has been a key part of many compromises done by pawn storm
in recent years and we were the first to describe them in detail from 2014 and onwards. we start this paper with a section on false flag operations and a rundown of pawn storm s attempts
to influence the public opinion. the second section focuses on different methods used to attack free
and corporate webmail mostly through sophisticated phishing tactics. the third section details pawn
storm s campaigns that we tracked over the years, and lists their intended targets. the next section
covers their preferred attacks, facilitators, and also their attitude towards their own operational security.
and lastly, we give some guidelines on how to defend against pawn storm. false flag operations pawn storm uses a variety of tactics to collect information from their identified targets often through credential phishing. some of the information is then leaked on websites that are specifically designed to display stolen data. more than once pawn storm disguised itself as hacktivists or whistleblowers motivated by some agenda. operating under alternative fronts
after pawn storm breached the world anti-doping agency (wada) and the court of arbitration for sport (tas-cas) in 2016, a group that calls themselves the fancy bears hack team posted medical records of athletes on their website (security company crowdstrike uses fancy bear to identify pawn storm actors). the hack team claims they stood for fair play and clean sport , however, in reality they leaked confidential medical records that were very likely stolen by pawn storm. this move could be meant as retaliation against the decision of wada to block several athletes from the olympics in rio de janeiro, brazil. it could also be meant to weaken the position of wada and influence the public opinion of doping incidents. in 2015, us army information was released on the site by a group calling itself the cyber caliphate. the group presented itself as pro-isis and suggested that they are an islam-inspired terrorist group. in the same year, cyber caliphate claimed to have taken down the live broadcast of french tv station tv5 for a number of hours. pro-isis messages from the group also appeared on the twitter and facebook accounts of tv5. this was particularly painful for france, a country that was still in shock from terrorist attacks on the editors of charlie hebdo, a french satirical weekly magazine. however, it was later reported that the cyber caliphate was actually a front of pawn storm. french magazine l express shared indicators with us that clearly connected cyber caliphate to pawn storm, which french authorities later confirmed. the motives for the tv5 attack are still unclear. of course, it is also possible that this attack was the work of undisciplined pawn storm actors. though the pawn storm actors normally work in a professional way, there have been a few other incidents where some pawn storm actors showed a lack of discipline. 4 | two years of pawn storm: examining an increasingly relevant threat maneuvers used against political organizations
in 2016 the democratic national committee (dnc) was allegedly hacked by pawn storm. stolen emails were published by wikileaks and a site called dcleaks[.]com, a domain very likely controlled by pawn storm. after the dnc hack became public, a lone hacker called guccifer 2.0 claimed responsibility. he claimed to be romanian (just like the real hacker guccifer who was convicted in 2016 for compromising the email accounts of american business executives, political figures and celebrities), but while communicating with the press, it appeared that guccifer 2.0 was not fluent in romanian at all. a study of threatconnect9 showed that guccifer 2.0 approached news media and offered them exclusive access to password-protected parts of the dcleaks[.]com site. this specific site actually leaks email repositories taken from mainly us pawn storm targets that have been victimized by the group s advanced gmail credential phishing campaigns. we were able to collect a substantial amount of information on the gmail credential phishing campaigns of pawn storm from 2014 onwards (as we discuss in the how pawn storm attacks free and corporate webmail section). this makes it very likely that guccifer 2.0 is a creation of the pawn storm actor group. meanwhile, wikileaks, which has dubbed itself a multi-national media organization and associated library , published emails from the dnc and the ak party of turkish president erdogan in 2016. we know that the dnc received a wave of aggressive credential phishing attacks from pawn storm in march and april 2016: during the campaign, dozens of politicians, dnc staff, speech writers, data analysts, former staff of the obama campaign, staff of the hillary clinton campaign, and even corporate sponsors were targeted multiple times. pawn storm also used phishing campaigns against the turkish government and parliament in early 2016. this makes it highly plausible that the emails published by wikileaks were originally stolen by the pawn storm actor group. utilizing mainstream media
there have been instances when pawn storm uses mainstream media to publicize their attacks and influence public opinion. several media outlets have confirmed that they were offered exclusive access to data stolen by pawn storm. when the reputable german magazine der spiegel reported on doping in january 2017,10 der spiegel wrote they were in contact with the fancy bear hackers for months and that in december 2016 they received several sets of data containing pdf and word documents in addition to hundreds of internal emails from united states anti-doping agency (usada) and wada, the world anti- doping agency. this is a clear example where pawn storm successfully contacted mainstream media to influence the public opinion about a political topic. 5 | two years of pawn storm: examining an increasingly relevant threat the reports on the democratic congressional campaign committee (dccc) being compromised, published at end of july 2016, serve as another example. we discovered that the website was severely compromised more than five weeks before it became public. all donations meant for were first redirected to a site that was under pawn storm s control this means that the actors had the opportunity to compromise donors of the democratic party. at the time of discovery, the compromise was about a week old and still live. we disclosed the compromise to us authorities responsibly and the problem was addressed quickly. we did not publish our findings as a public report could actually benefit pawn storm by highlighting their capabilities and also impact the us elections. but then more than five weeks later the compromise did make headlines. pawn storm possibly contacted mainstream media about the compromise and, just like in other cases, offered exclusive access to stolen information. phishing and things pawn storm can do with the data
in april and may 2016 pawn storm launched phishing campaigns against the german political party christian democratic union (cdu) headed by angela merkel, which is also around the same time the group set up phishing sites against two german free webmail providers.11 german authorities later confirmed that this attack was the work of pawn storm. however it is unknown if they were successful or not. no emails of cdu have been leaked yet, but in some instances pawn storm has waited for more than a year before it started to leak stolen data. the timed release of information is one way a threat actor can maximize the impact of their attack against a target. in early 2016, pawn storm also set up credential phishing sites that targeted ministries of the turkish government and the turkish parliament.12 another credential phishing site was set up to target the parliament of montenegro in october 2016 this was likely the work of pawn storm as well. pawn storm has also probably leaked stolen information via cyber-berkut[.]org. this is the website of an actor group posing as an activist group with a particular interest in leaking documents from the ukraine. the exact relation between pawn storm and cyberberkut is unknown, but we have credible information that cyberberkut has published information which was stolen during pawn storm s credential phishing campaigns. prior to leaking the information, parts of the documents and emails were allegedly altered. the authenticity of leaked data is generally not verified, allowing threat actors to alter the stolen data to their own benefit and present it as real and unaltered. by publishing carefully selected pieces of unaltered stolen data, threat actors can even more effectively influence public opinion in a way that is aligned with their interests. 6 | two years of pawn storm: examining an increasingly relevant threat the incidents mentioned above show pawn storm s interest in influencing politics in different countries. this is not limited to the presidential elections in the us, but goes beyond that. resourceful threat actors such as pawn storm can sustain long-term operations and leverage different attacks that can last for years such as credential phishing. the next sections will detail how credential phishing has been so effective for pawn storm. 7 | two years of pawn storm: examining an increasingly relevant threat how pawn storm attacks
free and corporate
webmail credential phishing
credential phishing is an effective tool in espionage campaigns. a lot of internet users are trained by experience not to fall victim to phishing. they are trained to spot obvious grammar and spelling errors, uncommon domains in the phishing urls and the absence of a secure, encrypted connection in the browser bar. however, professional actors have the resources to avoid simple mistakes and invent clever social engineering tactics. they send phishing emails in flawless english and other languages when needed, and they have no problem evading spam filters. essentially, credential phishing attacks have become an effective and dangerous tool that can have severely damaging effects. in these attacks a huge amount of sensitive data might be stolen. credential phishing also serves as the first step to penetrate deeper into the infrastructure of a target organization. several attack scenarios are possible through credential phishing: silent data gathering over an extended period of time pawn storm being a prime example since our data tracks them silently collecting information for more than a year compromised accounts are used to further penetrate into the network of a victim organization, for example by sending emails using stolen identities leaking sensitive emails in order to cause harm to the victim organization and influence public opinion domestic espionage on citizens of nations 8 | two years of pawn storm: examining an increasingly relevant threat using these simple, but oftentimes well-prepared credential phishing attacks, a group can collect an enormous amount of data. pawn storm is doing all of the above. in 2016 the group is believed to have stolen information from the dnc, hillary clinton s campaign team, and wada. they also launched credential phishing attacks on numerous other organizations: armed forces, defense companies, media, and many others. it is very likely that from july 2015 to august 2016, pawn storm had access to the gmail account of colin powell, former united states secretary of state under the george bush administration. in september 2016, more than one year after the initial compromise, dcleaks[.]com posted several of his personal emails online. this was just one of the many examples where pawn storm leaked confidential information, and it shows that some of the compromises span a lengthy period. russian citizens journalists, software developers, politicians, researchers at universities, and artists are also targeted by pawn storm.13 several russian media organizations (including mainstream media corporations) and foreign embassies in moscow are common targets too. pawn storm has maintained long-running campaigns against high profile users of free international webmail providers like yahoo and gmail; as well as webmail providers for ukrainian internet users (ukr. net), and russian users (yandex and ). pawn storm sets up phishing sites of other free webmail providers for very specific targets only. we found pawn storm phishing domains for relatively small webmail providers in cyprus, belgium, italy, norway, and other countries. users of university webmail in estonia and russia were targeted as well. these were probably part of tailored attacks where pawn storm had very specific and high profile targets in mind. the credential phishing attacks against high profile google, yahoo and users are relatively voluminous. we were able to collect thousands of phishing emails since early 2015. it was not continuous. pawn storm sometimes paused activities, which they but then later on resumed. some targets get multiple phishing emails in one week. credential phishing attacks on corporate webmail
attacking corporate email makes a lot of sense for threat actors as email is one of the weakest points in the targets defense. in the last four years, pawn storm has launched numerous credential phishing attacks against the corporate email system of many organizations. targets included armed forces, defense industry, political parties, ngos, media, and governments around the world. breaching corporate email accounts may lead threat actors to valuable, confidential data and it can be a stepping stone for penetrating deeper into the target organization. 9 | two years of pawn storm: examining an increasingly relevant threat many organizations allow their employees to read email while they are out of the office. while this greatly enhances user convenience, webmail introduces significant risks. webmail that can be accessed from anywhere introduces an attack surface that can be probed not only through direct hacking, but also by advanced social engineering. while people might be used to less sophisticated credential phishing emails, advanced actors have shown remarkable creativity in their attacks and often they are fluent in foreign languages as well. for some of the attacks, victims cannot be blamed for falling for the social engineering tricks. we have seen phishing lures that are almost indistinguishable from legitimate emails. one of the social engineering lures makes use of a form of tabnabbing, which is discussed below. here are some considerations on the security of webmail: two-factor authentication improves security, but it doesn t make social engineering impossible. all temporary tokens can be phished by an attacker. even when two-factor authentication is used, an attacker only has to phish for the second authentication token one or two times to get semi-permanent access to a mailbox. they can set up a forwarding address or a token that allows third party applications full access to the system. mandatory logging in onto a company vpn network does raise the bar for an attacker. however, vpn credentials can also be phished, and we ve seen targeted attackers specifically go after vpn access credentials. authentication with a physical security key makes credential phishing virtually impossible unless the attacker has physical access to the equipment of the target. when a target uses a physical security key, the attacker either has to find an exploit to get unauthorized access, or he has to get physical access to the security key and the target s laptop. to add to authentication methods that are based on what you know and what you have, one could add authentication that is based on what you are: fingerprints or other biometric data. biometrics have already been used by some laptops and phone vendors, and have also been a common authentication method in datacenters for more than a decade. 10 | two years of pawn storm: examining an increasingly relevant threat phishing campaign targets
this section lists some of the organizations that were targeted by pawn storm with a campaign that was specifically set up for them. in many cases, only very few employees of these organizations were targeted. date organization phishing domain abnabbing in credential phishing
tabnabbing is a term that was originally introduced by researcher aza raskin.14 he describes the attack as follows: a url in an open tab of the browser is changed to a phishing site when simple javascript detects that the user has moved on to another tab or is inactive for some time. when the target believes that the phishing site is the real login site of the internet service he was using, he might reenter his credentials on the phishing site. the trick exploits internet users habit of keeping several tabs open in their browser for an extended period of time. many services like online banking require reentering credentials after a certain period of inactivity so the user might be familiar with this routine. pawn storm has been using a variant of tabnabbing.15 in this attack scenario, the target gets an email supposedly coming from a website he might be interested in maybe from a conference he is likely to visit or a news site he has subscribed to. the email has a link to a url that looks very legitimate. when the target reads his email and clicks on the link, it will open in a new tab. this new tab will show the legitimate website of a conference or news provider after being redirected from a site under the attackers control. the target is likely to spend some time browsing this legitimate site. distracted, he probably did not notice that just before the redirection, a simple script was run, changing the original webmail tab to a phishing site. when the target has finished reading the news article or conference information on the legitimate site, he returns to the tab of his webmail. he is informed that his session has expired and the site needs his credentials again. he is then likely to reenter his password and give his credentials away to the attackers. this attack scenario is very simple and doesn t require any exploit. its success depends on good preparation by the attacker, but even experienced security researchers could fall for this social engineering trick, in particular when they are on the road and not paying attention to details. in table 2 we show some examples of organizations that have been targeted with credential phishing attacks that made use of this tabnabbing trick. target organization phishing domain malicious domain
the tabnabbing trick figure 1. a target clicks on a link in an email and is redirected to a legitimate news site that will likely hold his interest 15 | two years of pawn storm: examining an increasingly relevant threat figure 2. simple javascript that is run on the pawn storm-controlled website, just before the user is redirected to the legitimate news site. the javascript is not malicious and will point the url in the parent window to a credential phishing site. figure 3. the credential phishing site that was opened in the browser by the tabnabbing trick the phishing site is practically indistinguishable from the original webmail site apart from one typo in the domain. the target is very likely to fall victim to the attack. 16 | two years of pawn storm: examining an increasingly relevant threat compromising dns settings
in another simple but dangerous attack scenario against corporate email systems, the dns settings of the mail servers are compromised and changed to point to a foreign server. it is not an unknown scenario, as even reputable companies have had their dns settings compromised in the past. often these compromises are done by hackers who want some media attention either for themselves or for a specific cause. these hacks are detected quickly and undone quickly, especially if the hackers are just seeking media attention. they simply put up a hah, you are hacked message or something similar on the hijacked domain. a more advanced attacker can apply the same kind of tricks, but as quietly as possible. when an attacker gets dns admin credentials, he can modify the zone file of a domain name (note that reputable registrars offer enhanced security and changes to zone files have to be confirmed by a dns admin over the phone). by changing the mx record of a domain to point to a proxy ip address he controls, an attacker can receive all incoming email. the proxy can be set up to forward all incoming email to the real, actual receiving email server of the target. this allows the attacker to read all metadata of incoming emails, as well as the contents of any email that isn t encrypted. while this kind of attack is not advanced in nature it can have devastating consequences. we know of a ministry of foreign affairs in an eastern european country that had the mx record of their domain compromised by pawn storm for many months. we warned the ministry of foreign affairs about the compromise, but the process wasn t that straightforward. all of the email communications of the ministry couldn t be trusted and we did not trust in the safety of their phone system either. as a solution, we first contacted a cert contact in europe by phone. we described the issue and sent the details in a pgp-encrypted email to the western european cert. the cert sent a secure message to an embassy in the affected country. the embassy decrypted and printed the email. after that, a courier gave the message to the ministry of foreign affairs and the issue was addressed and resolved. 17 | two years of pawn storm: examining an increasingly relevant threat the mx record of the mfa
(ministry of foreign affairs)
domain was compromised email and phone lines
could not be trusted, so
trend micro had to (cid:31)nd
secure communication trend micro contacted a
western european cert by phone and sent a
pgpencrypted email the cert sent a secure
message to the embassy the message was decrypted and printed by the embassy the printed message was brought to the mfa by courier figure 4. how trend micro warned the mfa about the discovered compromise this attack scenario shows how important it is for organizations to use reputable dns providers and registrars only, and to lock down their domain registration so that they don t get hijacked easily. in the past there was at least one other instance where the dns settings of a government institution in a west african country were compromised by pawn storm for a couple of months. 18 | two years of pawn storm: examining an increasingly relevant threat pawn storm phishing
campaigns credential phishing campaigns
pawn storm is constantly trying to get access to the mailboxes of high profile users of free webmail services. we know of dozens of campaigns, each targeting up to thousands of high profile individuals. the social engineering lures used in the campaigns vary in quality, but some lures can be particularly dangerous. in this section we show a couple of these attacks. we collected credential phishing emails that were sent by pawn storm to a handful of high profile yahoo accounts from january 2015 to december 2016. the diagram below shows the distribution of more than 160 credential phishing attacks that were sent to these high profile yahoo users. 19 | two years of pawn storm: examining an increasingly relevant threat figure 5. distribution of pawn storm s 160 credential phishing attacks the diagram shows that pawn storm took a long break during the holidays at the end of 2015. however, from mid-november to mid-december 2015, pawn storm was particularly active with credential phishing against high profile targets. within this period, pawn storm was using a particularly dangerous and effective method of credential phishing we will discuss below. 20 | two years of pawn storm: examining an increasingly relevant threat a serious compromise of a target organization can start with this relatively simple credential phishing email: figure 6. email requesting installation of malicious application google defender 21 | two years of pawn storm: examining an increasingly relevant threat the email poses as an advisory from gmail to install an official application called google defender . normally an internet user will be wary of installing applications he did not ask for. in this particular case however, a click on the link will lead to a page on that looks like this: figure 7. a legitimate-looking google defender page asking for email access permissions at first sight this might look like a legitimate service of google: the url is hosted on the legitimate domain accounts. , and the communication with this website is encrypted like usual. the average internet user might actually be convinced this is all legitimate. however, despite being on accounts. , the application doesn t belong to google. it is a third party application made by pawn storm. in this social lure open authentication (oauth), an open authentication standard, is abused. below we will explain in more detail what oauth is normally used for. 22 | two years of pawn storm: examining an increasingly relevant threat similar attacks from pawn storm targeted high profile yahoo users. for example in one of the late-2015 campaigns mcafee email protection was offered: figure 8. a phishing attack targeting high profile yahoo users clicking on the phishing link would lead the target to a url on the legitimate yahoo domain api.login. . here the user is asked to turn on mcafee email protection that would protect the user against various threats. if this offer is accepted, pawn storm actors would have full access to his email. this lure is similar to the one that was used against gmail users. it is particularly dangerous as most internet users might not realize the applications are not endorsed and carefully checked by their email provider. 23 | two years of pawn storm: examining an increasingly relevant threat figure 9. pawn storm lure for open authentication abuse created for yahoo users at the end of 2015 this social engineering lure makes use of an authorization method called open authentication (oauth). oauth is a way of authorizing third party applications to login to users online accounts for free webmail and other services. the big advantage is that users don t have to reveal their password to the third party. instead the third party applications get a token that can be used for authentication. oauth is great for the users experience on the web. for example, by allowing social networks to access your webmail contact list, it is easier to find friends who are subscribed to the same social network. another popular use for oauth is merging different free webmail accounts into one email account. while oauth offers convenience and useful applications, it also exposes the user to risks. in particular it allows for advanced social engineering schemes that take advantage of it, particularly when no good background checks are done for applications that are authorized by service providers to use oauth. for some free webmail services an email address and a website is enough to allow a third party application to use oauth. because of that, oauth abuse is straightforward and actor groups like pawn storm are taking advantage of oauth for credential phishing schemes. these attacks can have the same negative consequences as traditional credential phishing, even when no credentials are given away. the scheme is quite simple: an actor creates and signs up a rogue application with an online service provider like a free webmail provider that supports oauth the application passes the (basic) security checks the online service provider does to confirm whether the application is legitimate the actor now sends out emails to targets with a social engineering lure that would trick the recipients into allowing oauth authentication for the rogue application 24 | two years of pawn storm: examining an increasingly relevant threat the target might be familiar with generic phishing emails, but not so much with oauth abuse tricks. chances are significant that even well-educated targets get fooled once oauth access has been authorized, the target account can be accessed until the user or the provider revokes the token. if the target changes his password, the actor can still use the oauth token to access the mailbox. in this case the target might have a false sense of security. we informally spoke with two large webmail providers that allow oauth authentication by third party applications. as a result of our informal talks, one webmail provider has changed the way new applications are authorized to use oauth. new applications have to go through a more thorough check before they can use oauth. for this provider we noticed that since late 2015 pawn storm stopped sending phishing lures that abuse oauth. instead pawn storm went back to plain old credential phishing, which is generally less efficient. spear-phishing campaigns
pawn storm tries to snare targets using spear-phishing emails that have a malicious attachment or emails that link to an exploit url. the spear-phishing emails are usually about a recent event covered in the news that is likely to be of interest to the targets. pawn storm often uses the exact same headlines from recent news reports seen on media sites like cnn, al jazeera, huffington post, military times and many others. figure 10. typical infection chain of pawn storm s spear-phishing campaigns 25 | two years of pawn storm: examining an increasingly relevant threat in 2015 and 2016 trend micro blocked dozens of these spear-phishing campaigns against high profile customers. below we list some of the spear-phishing emails that contained a link to the private exploit kit of pawn storm, as well as the date and email subject line used. date ambassador of ukraine to jordan dr. sergiypasko held talks with director of the
european department of the mfae of jordan mr. daifallah al-fayez petro poroshenko congratulated muhammadu buhari on his election as president
of the federal republic of nigeria news: obama, in therapeutic meetings with u.s. jewish leaders, stresses how
much he cares protecting network the subject lines clearly indicate that pawn storm uses recent newsworthy events to encourage victims to click. though these are targeted attacks, some of the campaigns are relatively noisy and have been frequently deployed from 2015 to 2016. most of the attacks were not widely reported in media, but some did make it to the news. in 2016, awareness grew due the amount of research that was published by trend micro and other internet security vendors. for example in september 2016 several major german newspapers published stories of german politicians that were being attacked by pawn storm in august 2016. we can confirm that trend micro saw spear-phishing emails sent by pawn storm using german political themes as social 27 | two years of pawn storm: examining an increasingly relevant threat engineering lures. however these emails were part of a much bigger campaign with targets in many other countries as well. the spear-phishing campaigns as reported in the german media were actually not that uncommon, but almost business as usual for the pawn storm actors. still, it shows that in 2016 the actors showed a clear interest in compromising political organizations. though some of the spear-phishing emails are relatively noisy, pawn storm is careful with how they infect their targets. first of all, the exploit urls are specific for every victim each has a parameter that is unique to the particular target. in case a target clicks on an exploit url, he will first get fingerprinted with invasive javascript code that is not malicious by itself. the javascript will upload information like the operating system version, language settings, browser plugins, and time zone of the target s computer to the exploit server. depending on the fingerprinting results, the exploit server might give back an old exploit, a zero- day, or a social engineering lure.16 in a lot of cases nothing will happen, apart from a redirection to a benign news site that has an article related to the social engineering lure of the spear-phishing email. the use of a zero-day will also depend on how valuable that zero-day still is to pawn storm. once the zero-day gets discovered and a fix is underway, its value in the attack portfolio will be devalued. in 2016 we witnessed that during the interval of a windows privilege escalation vulnerability being disclosed and then patched, pawn storm ramped up its operations and targeted a broader range of governmental personnel. the group used the just-patched flash zero-day and the still open windows privilege escalation vulnerability.17 even when a target does get infected with malware, he will first get relatively simple first stage malware installed. this gives pawn storm another chance to learn whether a target is worth a deeper probe. if the target is interesting enough, the actor will install second stage components like x-agent and x-tunnel. after this, pawn storm might try to penetrate deeper into the network infrastructure, so that it can control more nodes in the victim s network. in 2016, pawn storm started to use rtf and other office documents embedded with a flash file. the flash file will upload information on the targets system to a remote server. we have witnessed that the remote server may respond with a chain of exploits, zero-days and privilege escalation that will infect the target s computer. this kind of infection chain was first described by palo alto network researchers and dubbed dealers choice.18 28 | two years of pawn storm: examining an increasingly relevant threat preferred attacks,
resources, and tools watering hole attacks
pawn storm has compromised websites that targets are likely to visit. for this kind of attack, the actors have to wait and see who will visit the compromised sites. on these compromised sites, pawn storm can choose to inject scripts that will serve their objectives. we have seen instances where pawn storm injected the so-called browser exploitation framework (beef)19 exploit on legitimate websites. in other cases, links were inserted that would lead to pawn storm s private exploit kit. like the name already suggests beef works from the browser to attack internet users. beef is used by legitimate penetration testers and it is very invasive. the framework includes many modules, including tools for reconnaissance, social engineering and active exploitation of vulnerabilities. beef is particularly useful to an attacker when the target doesn t close inactive tabs in his internet browser. when an internet user opens a browser tab and visits a website that has been compromised to link to a beef exploit url, the attacker has ample time to do reconnaissance and try out different attacks until the browser tab gets closed. these attacks may include social engineering attacks, grabbing passwords, and exploiting vulnerabilities. we have seen that the website of a ukrainian defense company was compromised to link to a beef exploit on a remote server. visitors of the defense company s website are likely to be interesting targets to pawn storm, and might have been exposed to various attacks. an injection of a beef exploit happened to the websites of some ministries of foreign affairs in europe and africa as well. earlier in 2014, pawn storm compromised polish government sites and the website of the power exchange in poland. visitors to the websites were exposed to pawn storm s private exploit kit. 29 | two years of pawn storm: examining an increasingly relevant threat and as we previously mentioned, in june 2016 pawn storm compromised the website of the dccc. anyone donating money via would be redirected to a pawn storm-controlled site. pawn storm possibly intended to compromise donors of the democratic party in the us and to spy on them. however we have not been able to confirm the exact infection chain. zero-days
pawn storm is known to have used several zero-days.20 for example, at the end of october 2016 pawn storm was identified as using a flash zero-day together with a privilege escalation in windows. soon after the flash vulnerability (cve-2016-7855) was patched, pawn storm started to make the most out of these partially patched zero-days by exposing more targets to them. on october 28, 2016 a relatively noisy campaign was launched that sent several rtf documents to targets. figure 11. a pawn storm spear-phishing email with an rtf document the rtf document has a flash file embedded in it that is a simple downloader. we saw that it first downloaded an encrypted flash exploit (cve-2016-7855) from a remote server. then it downloaded a second file that crashed microsoft word. in other reported cases the second file was a first stage payload of pawn storm. 30 | two years of pawn storm: examining an increasingly relevant threat in july 2015 trend micro discovered a java zero-day that was exploited together with a privilege escalation that evades the click to play protection in java. privilege escalation windows
kernel figure 12. zero-days that are believed to have been used by pawn storm exclusively before they were patched apart from these zero-days, pawn storm was also quick to use other vulnerabilities that were disclosed in the leaks of hacking team. second stage c&c servers
we were able to keep track of the live second stage c&c servers from late 2013 until today. at the end of 2013 there were about five live x-agent c&c servers. in early october 2016, we counted 26 live x-agent c&c servers. this is a strong indication that pawn storm has been very active in 2016. 31 | two years of pawn storm: examining an increasingly relevant threat another local peak was in the fall of 2014, possibly because around that time trend micro s first paper on pawn storm was published and the actor group made changes to their infrastructure.
figure 13. tracking the number of live x-agents c&cs from oct 2013 to feb 2017 around the christmas holidays of 2016, the number of live x-agents c&cs slightly increased to 27. in january 2017 the number peaked at 28 live x-agent ip addresses. pawn storm did not take a long break during the 2016 holidays. right after christmas, on december 26 2016, we saw pawn storm recommence their spear-phishing campaign. in january 2017, the usual credential phishing also continued. facilitators
pawn storm has a clear preference for certain webhosting providers and registrars. this preference is sometimes so specific that newly set up domains can be spotted before they are even used in attacks. in recent months, however, pawn storm s use of ip ranges is getting more diverse and parts of their activity have become more difficult to track. generally speaking, pawn storm uses the internet infrastructure in well-connected countries like the us, uk, france, netherlands, latvia, romania and germany. in these countries, the national intelligence services could probably easily and legally intercept connections to command and control servers, sources of (spear) phishing emails, and pawn storm s exploit sites that are set up in their country. encryption and tls in both web traffic and email traffic will limit the usefulness of these legal intercepts, though. 32 | two years of pawn storm: examining an increasingly relevant threat for example, for sending credential phishing emails pawn storm probably doesn t have to worry about authorities unless the authorities have access to the servers that are sending the emails. in the table below we illustrate the infrastructure that was used by pawn storm to send out yahoo credential phishing emails in 2015. as far as we are aware, for all of 2015, pawn storm only used one ip address in germany and one in netherlands to send out the phishing emails. in 2016 pawn storm started to use legitimate email providers like gmx and yandex to send out credential phishing emails from vpn servers like ipvanish. actual data communication to c&c servers like x-agent will be encrypted and this means that exfiltrated data cannot be read unless a decryption algorithm is available. pawn storm clearly doesn t care that intelligence services might have some visibility on the identities of the victimized targets. this becomes even more apparent when we realize that a lot of the x-agent c&cs are live for several months. averaged over 3 years of data, x-agent c&cs are live for 6 months. ten of the x-agent c&cs were live for more than 12 months. this shows that pawn storm is somewhat brazen: the actors don t really care if they get caught at some point. you could consider this bad operational security, however it also indicates the difficulties targets face when defending against the pawn storm actors. in a lot of the attacks the actors get what they were after anyway. the graph below shows the distribution of second stage x-agent c&c servers to each country from november 2013 until february 2017. it clearly illustrates the distribution of live c&c servers averaged over a 3 year period.
34 | two years of pawn storm: examining an increasingly relevant threat operational security
operational security is defined as the precautions that actors take to hide their activities and whereabouts. the operational security of pawn storm is quite remarkable, since for many of its operations it has become apparent that hiding activities is not always a high priority for the pawn storm actors. however, actions of pawn storm cannot easily be attributed to nicknames or profiles in the underground. for many cybercriminal groups at least some nicknames from the underground are known, but not so with this group. the identities of the individual pawn storm actors seem to be protected very well. pawn storm has a clear preference for some hosting providers, dns service providers, and domain registrars. by monitoring these service providers, it can be relatively easy for a researcher to spot new infrastructure that is being set up. in this way, a lot of pawn storm s infrastructure can be discovered early sometimes even before the attacks have actually started. there is another side of this apparent lack of operational security though. pawn storm is also using anonymous registration of domains, and in certain cases they choose very different providers. attacks using this infrastructure might easily get overlooked and not attributed to pawn storm. moreover, the preferred service providers of pawn storm give the actors good anonymity, one reason being these providers usually accept bitcoin as payment. pawn storm makes good use of webhosting providers in western countries that offer privacy to their customers. we don t know for sure whether these hosting companies are knowingly providing services to cyber criminals and cyber spies, perhaps at premium rates. however some of the webhosting companies have had ties with so called bulletproof hosting providers in the past. we actually described an example of a hosting provider in the netherlands in a 2016 article.22 we witnessed that pawn storm makes extensive use of vpn servers to connect to free webmail providers and then send out spear-phishing emails to their targets. some of the c&c servers may just relay traffic to intermediate proxies and thus relay stolen data back to the actual backend servers over more than one hop. just a couple of proxy nodes will greatly enhance operational security and anonymity of the actors. even when the infrastructure of pawn storm gets discovered quickly, vast amounts of data might have already been exfiltrated to a foreign computer server before the target is aware something is happening. there are several examples of infections and compromises that were discovered after months, and even after more than a year in some cases. 35 | two years of pawn storm: examining an increasingly relevant threat the vast majority of the campaigns pawn storm is doing would interest intelligence services around the world. investigations by normal police will usually lead nowhere as the problem of espionage23 can only be addressed at higher political levels and not by criminal investigations. communications between different law enforcement agencies are not always optimal within one country and between different countries. this can imply that agency x in a country may know about an attack by pawn storm in its country or another country, but is unable to inform the target in a timely manner. this further adds to the success of actors like pawn storm. it is not unthinkable that the pawn storm actors actually appreciate it when researchers dissect and write about their operations (after they have achieved their goal anyway). these articles are likely to be picked up by mass media, which the actors may consider as free publicity of their capabilities and the media reports might also be damaging to the affected target organizations. normal cybercriminals often don t like media attention and even suspend their activities temporarily when their actions are discovered and written about. pawn storm doesn t slow down at all. on the contrary: a lot has been written about pawn storm since fall of 2014, and their activities have only grown, both in aggressiveness and number. 36 | two years of pawn storm: examining an increasingly relevant threat 