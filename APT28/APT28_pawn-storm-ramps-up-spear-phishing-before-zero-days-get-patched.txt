pawn storm ramps up spear-phishing before zero-days get patched
posted on:november 9, 2016 at 5:00 am
posted in:exploits, targeted attacks, vulnerabilities
author: trend micro by feike hacquebord and stephen hilt the effectiveness of a zero-day quickly deteriorates as an attack tool after it gets discovered and patched by the affected software vendors. within the time between the discovery of the vulnerability and the release of the fix, a bad actor might try to get the most out of his previously valuable attack assets. this is exactly what we saw in late october and early november 2016, when the espionage group pawn storm (also known as fancy bear, apt28, sofacy, and strontium) ramped up its spear-phishing campaigns against various governments and embassies around the world. in these campaigns, pawn storm used a previously unknown zero-day in adobe s flash (cve-2016-7855, fixed on october 26, 2016 with an emergency update) in combination with a privilege escalation in microsoft s windows operating system (cve-2016-7255) that was fixed on november 8, 2016. after the fix of cve-2016-7855 in adobe s flash, pawn storm probably devalued the two zero-days in its attack tool portfolio. instead of only using it against very high profile targets, they started to expose much more targets to these vulnerabilities. we saw several campaigns against still-high-profile targets since october 28 until early november, 2016. figure 1. infection chain of the spear-phishing campaign in early november, pawn storm sent spear-phishing e-mails to various governments around the world. in one of pawn storm s campaigns on november 1, the subject line was european parliament statement on nuclear threats. the e-mail seemingly came from a real press officer working for the media relations office of the european union, but in reality, the sender e-mail address was forged. clicking on the link in the spear-phishing e-mail led to the exploit kit of pawn storm. the exploit kit will first fingerprint its targets with invasive javascript, which uploads os details, time zone, installed browser plugins, and language settings to the exploit server. the exploit server may then send back an exploit or simply redirect to a benign server. in recent attacks, we observed that the exploit kit exposed selected targets to the flash vulnerability cve-2016-7855, combined with the then-unpatched privilege escalation vulnerability in windows (cve-2016-7255). internet users who were using windows vista up to windows 7 without the latest patch for flash would be at high risk of automatically getting infected. from october 28 until early november 2016, several waves of spear-phishing e-mails were sent to embassies and other governmental institutions. some of the e-mails posed as an invitation for a cyber threat intelligence and incident response conference in november by defense iq, a media organization that specializes in news on defense and the military. the conference is real, but of course, the sender address was forged. the spear-phishing e-mail contained an rtf (rich text format) document called programm . opening the rtf document (detected by trend micro as troj_artief.jejosu) would show the program details of the real conference, which was to be held in london in late november 2016. however, the rtf document has an embedded flash file (swf_conex.a) that downloads additional files from a remote server. this attack methodology of pawn storm has been previously observed. we also noted that the embedded flash file downloaded a flash exploit for the just-patched cve-2016-7855. a second file was also downloaded, but this file consistently crashed microsoft word during our tests. apart from these two campaigns, several others were also launched by pawn storm in the period between the discovery of the zero-days and the release of adobe s and microsoft s patches on october 26 and november 8, 2016. this shows that pawn storm ramped up their spear-phishing attacks shortly after its zero-days were discovered. not all organizations may have been able to immediately patch adobe s flash, and the windows vulnerability wasn t patched until november 8, 2016. end users are urged to update their windows os (through ms16-135), and flash player (via its emergency patch) to mitigate these threats. trend micro solutions trend micro deep discovery provides detection, in-depth analysis, and proactive response to today s stealthy malware, and targeted attacks in real-time. it provides a comprehensive defense tailored to protect organizations against targeted attacks and advanced threats through specialized engines, custom sandboxing, and seamless correlation across the entire attack lifecycle, allowing it to detect threats like the above mentioned zero-day attacks even without any engine or pattern update. trend micro deep security and vulnerability protection provide virtual patching that protects endpoints from threats that abuses unpatched vulnerabilities. officescan s vulnerability protection shield endpoints from identified and unknown vulnerability exploits even before patches are deployed. tippingpoint customers are protected from attacks exploiting these vulnerabilities with these mainlinedv filters:
