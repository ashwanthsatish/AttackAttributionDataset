crowdstrike stands fully by its analysis and findings identifying two separate russian intelligence-affiliated adversaries present in the dnc network in may 2016. on june 15, 2016 a blog post to a wordpress site authored by an individual using the moniker guccifer 2.0 claimed credit for breaching the democratic national committee. this blog post presents documents alleged to have originated from the dnc. whether or not this posting is part of a russian intelligence disinformation campaign, we are exploring the documents authenticity and origin. regardless, these claims do nothing to lessen our findings relating to the russian government s involvement, portions of which we have documented for the public and the greater security community. there is rarely a dull day at crowdstrike where we are not detecting or responding to a breach at a company somewhere around the globe. in all of these cases, we operate under strict confidentiality rules with our customers and cannot reveal publicly any information about these attacks. but on rare occasions, a customer decides to go public with information about their incident and give us permission to share our knowledge of the adversary tradecraft with the broader community and help protect even those who do not happen to be our customers. this story is about one of those cases. crowdstrike services inc., our incident response group, was called by the democratic national committee (dnc), the formal governing body for the us democratic party, to respond to a suspected breach. we deployed our ir team and technology and immediately identified two sophisticated adversaries on the network cozy bear and fancy bear. we ve had lots of experience with both of these actors attempting to target our customers in the past and know them well. in fact, our team considers them some of the best adversaries out of all the numerous nation-state, criminal and hacktivist/terrorist groups we encounter on a daily basis. their tradecraft is superb, operational security second to none and the extensive usage of living-off-the-land techniques enables them to easily bypass many security solutions they encounter. in particular, we identified advanced methods consistent with nation-state level capabilities including deliberate targeting and access management tradecraft both groups were constantly going back into the environment to change out their implants, modify persistent methods, move to new command & control channels and perform other tasks to try to stay ahead of being detected. both adversaries engage in extensive political and economic espionage for the benefit of the government of the russian federation and are believed to be closely linked to the russian government s powerful and highly capable intelligence services. cozy bear (also referred to in some industry reports as cozyduke or apt 29) is the adversary group that last year successfully infiltrated the unclassified networks of the white house, state department, and us joint chiefs of staff. in addition to the us government, they have targeted organizations across the defense, energy, extractive, financial, insurance, legal, manufacturing media, think tanks, pharmaceutical, research and technology industries, along with universities. victims have also been observed in western europe, brazil, china, japan, mexico, new zealand, south korea, turkey and central asian countries. cozy bear s preferred intrusion method is a broadly targeted spearphish campaign that typically includes web links to a malicious dropper. once executed on the machine, the code will deliver one of a number of sophisticated remote access tools (rats), including adobearm, ati-agent, and minidionis. on many occasions, both the dropper and the payload will contain a range of techniques to ensure the sample is not being analyzed on a virtual machine, using a debugger, or located within a sandbox. they have extensive checks for the various security software that is installed on the system and their specific configurations. when specific versions are discovered that may cause issues for the rat, it promptly exits. these actions demonstrate a well-resourced adversary with a thorough implant-testing regime that is highly attuned to slight configuration issues that may result in their detection, and which would cause them to deploy a different tool instead. the implants are highly configurable via encrypted configuration files, which allow the adversary to customize various components, including c2 servers, the list of initial tasks to carry out, persistence mechanisms, encryption keys and others. an http protocol with encrypted payload is used for the command & control communication. fancy bear (also known as sofacy or apt 28) is a separate russian-based threat actor, which has been active since mid 2000s, and has been responsible for targeted intrusion campaigns against the aerospace, defense, energy, government and media sectors. their victims have been identified in the united states, western europe, brazil, canada, china, georgia, iran, japan, malaysia and south korea. extensive targeting of defense ministries and other military victims has been observed, the profile of which closely mirrors the strategic interests of the russian government, and may indicate affiliation with (main intelligence department) or gru, russia s premier military intelligence service. this adversary has a wide range of implants at their disposal, which have been developed over the course of many years and include sofacy, x-agent, x-tunnel, winids, foozer and downrange droppers, and even malware for linux, osx, ios, android and windows phones. this group is known for its technique of registering domains that closely resemble domains of legitimate organizations they plan to target. afterwards, they establish phishing sites on these domains that spoof the look and feel of the victim s web-based email services in order to steal their credentials. fancy bear has also been linked publicly to intrusions into the german bundestag and france s tv5 monde tv station in april 2015. at dnc, cozy bear intrusion has been identified going back to summer of 2015, while fancy bear separately breached the network in april 2016. we have identified no collaboration between the two actors, or even an awareness of one by the other. instead, we observed the two russian espionage groups compromise the same systems and engage separately in the theft of identical credentials. while you would virtually never see western intelligence agencies going after the same target without de-confliction for fear of compromising each other s operations, in russia this is not an uncommon scenario. putin s hydra: inside russia s intelligence services , a recent paper from european council on foreign relations, does an excellent job outlining the highly adversarial relationship between russia s main intelligence services (fsb), the primary domestic intelligence agency but one with also significant external collection and active measures remit, (svr), the primary foreign intelligence agency, and the aforementioned gru. not only do they have overlapping areas of responsibility, but also rarely share intelligence and even occasionally steal sources from each other and compromise operations. thus, it is not surprising to see them engage in intrusions against the same victim, even when it may be a waste of resources and lead to the discovery and potential compromise of mutual operations. the cozy bear intrusion relied primarily on the seadaddy implant developed in python and compiled with py2exe and another powershell backdoor with persistence accomplished via windows management instrumentation (wmi) system, which allowed the adversary to launch malicious code automatically after a specified period of system uptime or on a specific schedule. the powershell backdoor is ingenious in its simplicity and power. it consists of a single obfuscated command setup to run persistently, such as: this one-line powershell command, stored only in wmi database, establishes an encrypted connection to c2 and downloads additional powershell modules from it, executing them in memory. in theory, the additional modules can do virtually anything on the victim system. the encryption keys in the script were different on every system. powershell version of credential theft tool mimikatz was also used by the actors to facilitate credential acquisition for lateral movement purposes. fancy bear adversary used different tradecraft, deploying x-agent malware with capabilities to do remote command execution, file transmission and keylogging. it was executed via rundll32 commands such as: in addition, fancy bear s x-tunnel network tunneling tool, which facilitates connections to nat-ed environments, was used to also execute remote commands. both tools were deployed via remcom, an open-source replacement for psexec available from github. they also engaged in a number of anti-forensic analysis measures, such as periodic event log clearing (via wevtutil cl system and wevtutil cl security commands) and resetting timestamps of files. intelligence collection directed by nation state actors against us political targets provides invaluable insight into the requirements directed upon those actors. regardless of the agency or unit tasked with this collection, the upcoming us election, and the associated candidates and parties are of critical interest to both hostile and friendly nation states. the 2016 presidential election has the world s attention, and leaders of other states are anxiously watching and planning for possible outcomes. attacks against electoral candidates and the parties they represent are likely to continue up until the election in november.
