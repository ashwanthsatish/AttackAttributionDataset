july 7, 2016
what's in a name server?
in blog, featured article, research, threat research what's in a name... server? following the lead from crowdstrike, threatconnect expanded on the dnc breach research looking at the name server hosting information for the misdepatrment[.]com spoofed domain. internet contact books
name servers are the contact books of the internet. a cell phone s contact book gives someone the opportunity to forget their mom s phone number because it automatically associates her name with her ten digit phone number. this way, after her information is in the contact book, they only have to remember her name to call her. name servers provide a similar function - they translate domain names into difficult-to-remember ip addresses so we only have to remember the domain name. note: the purpose of this post is not to be a dns primer - you can learn more about dns and how it works in this article. hosting services usually have their own name servers that they use for any websites that are registered through them. also, hosting services generally use multiple name servers for their accounts to provide continuity in case one of their name servers goes down. for example, if five domains are registered through godaddy, all five of those domains by default will use godaddy name servers like ns1.godaddy[.]com and ns2.godaddy[.]com. individuals can also choose to configure or transfer their domains so that they use other service providers name servers if they choose. so what and why you care:
hundreds of thousands of domains might use a single name server, but in some cases, especially for smaller hosting services, a name server may only be used for a couple of hundred domains. this can prove to be useful information as threats of all shapes and sizes - including advanced persistent threats (apts) - will sometimes use boutique or smaller hosting services to register the domains that are used as malicious infrastructure in support of their operations. this name server information is contained in the whois record for a domain and can potentially be used to identify other malicious domains that organizations may encounter related to a specific incident. name servers, bitcoins, and bears. oh my!
following the lead from our friends at crowdstrike, we expanded on the research we did into fancy bear s efforts against the dnc, where we took a look at the name server hosting information for the misdepatrment[.]com spoofed domain. leveraging domaintool s capabilities, we were able to identify that this domain was registered through the domains4bitcoins[.]com hosting service that allows customers to buy domain names with bitcoins. domains4bitcoins dnc breach a hosting service like this is attractive to malicious actors that want to minimize the amount of attributable information that they are required to supply when purchasing domains. this service mitigates the need to supply credit cards and legitimate billing names and addresses, as the customer can simply pay from their bitcoin wallet and use fictitious names and addresses that ultimately obfuscate their true ownership. some of the domains registered through this service, including misdepatrment[.]com, use multiple *.bitcoin-dns[.]hosting name servers. using domaintools reverse ns lookup, we were able to identify about 1600 domains that also used the same name servers as misdepatrment[.]com. this set contains a wealth of domains that were previously identified as malicious, spoof or typosquat legitimate companies or organizations, or are otherwise suspicious. associations to previous activity
leveraging threatconnect s analyze function, we were able to quickly identify the below domains that use domains4bitcoins[.]com s name servers had been attributed to fancy bear (aka apt28 and sofacy) activity: domain	attributes
militaryobserver[.]net	fancy bear related domains. from a pwc threat intelligence bulletin.
sysprofsvc[.]com	likely malicious fancy bear c2 domain that overlaps with the domain winsyscheck[.]com at ip 69.90.132[.]194.
euronews24[.]info	likely fancy bear domain registered by leila77@cock[.]li
naoasch[.]com	fancy bear callback found in dll md5: the presence of multiple domains attributed to an apt group on this relatively small bitcoin name server underscores the fact that using such services is likely a common tactic for malicious actors who want avoid attribution and hosting services that mitigate abusive activity. paying in bitcoins also lessens any hassles an apt might experience in trying to register domains using foreign currency. criminal actors leveraging recent ransomware variants, including locky and samsam, request ransom payments in bitcoins from their victims. the malicious actors can then use these bitcoin hosting services to easily procure additional anonymous infrastructure using their ransom money. several of the domains registered through domains4bitcoins[.]com spoof bitcoin-related websites. for example, blockichain[.]info spoofs the bitcoin wallet site blockchain[.]info, which has previously been spoofed in multiple phishing efforts. one possibility is that the individuals behind these operations may be using stolen bitcoins to feed the beast and use stolen digital currency to procure digital infrastructure in support of future operations. additional shadiness
we further reviewed the domains using domains4bitcoins[.]com s name servers and are sharing over 400 of them in 20160616b: suspicious domains on bitcoin dns nameservers. some of the more notable domains mirror government organizations, media outlets, and technology companies or tools. many of these organizations are ubiquitous and domains spoofing them could be used against a variety of targets: some notable patterns stick out from the above list with respect to previously-attributed activity. theguardianpress[.]com domain was registered using the same email domain, cock[.]li, as the naoasch[.]com and euronews24[.]info domains that were previously attributed to fancy bear activity. this domain was also registered in the same timeframe as another domain, theguardiannews[.]org, which also spoofs the guardian. leveraging the reverse dns capability within the threatconnect platform, we are also able to quickly identify that four of the domains--adoble[.]net, wincodec[.]com, theguardiannews[.]org, and theguardianpress[.]com--previously resolved to the 5.135.183[.]154 ip address. these domains are now hosted elsewhere, with the guardian-spoofing domains being hosted on dedicated servers. the 5.135.183[.]154 ip also hosted the misdepatrment[.]com domain before it was potentially used in the dnc attack from a dedicated server at the fancy bear 45.32.129[.]185 ip identified by crowdstrike. the adobeupdater[.]org domain was registered by the same email, vrickson@mail[.]com, that was used to register the fancy bear-attributed domain ssl-icloud[.]com. finally, two domains spoofing intel and one spoofing honeywell were all registered on february 17, 2016. it is important to note that we cannot immediately confirm that these domains are hosting malware or are otherwise attributable to malicious apt activity; however, they deserve additional scrutiny due to the patterns identified above, the fact that they use a bitcoin name server, and that they emulate legitimate organizations. the start of authority (soa) and whois records for these domains confirm that they were not registered by the spoofed organization. setting alerting capabilities to identify domains that use a bitcoin name server and were registered using a free webmail account (such as chewiemail[.]com or mail[.]com) may provide an organization with more specific alerts that are useful for both analytic and defensive efforts. many of these domain squats are consistent with those that apt actors leverage in their operations, including those targeting nato, news websites, or intel. after registering domains like these, apts can quickly use them in multiple phases of their operation ranging from delivery to command and control. previous fancy bear name server activity
this isn t the first time that various fancy bear infrastructure has leveraged the same technique and used smaller name servers. we reviewed a report from trend micro that detailed some domains that had been used in previous fancy bear attacks. four of the eight domains detailed in the report were likely registered using the same hosting services. these domains initially used the same xtraorbit name server and later transferred to another xtraorbit name server before they were published in the report:
leveraging domaintools, we were able to identify that only 466 domains currently use the xtraorbit[.]com name server. then using threatconnect s analyze function, we were able to identify that at least 17 of those domains had been attributed to fancy bear. the concentration of malicious domains on this name server again demonstrates that analysis of name servers can facilitate analytic efforts against such apt groups. conclusion
bitcoin hosting services and name servers are not limited to what we showed here. in the course of our research, we identified at least three other distinct name servers that were dedicated to bitcoin hosting services: domains4bitcoins.*.orderbox-dns[.]com, *.domains4bitcoins[.]com, and *.domains4bitcoins-parking[.]com. some domains associated with these name servers were also incorporated into 20160616b: suspicious domains on bitcoin dns nameservers. also, shady name server activity isn t restricted to bitcoin services. we identified other name servers hosting a concentration of malicious apt domains. and, as more domains are registered through services like these or transferred to these name servers on a daily basis, it is worthwhile to monitor such activity and incorporate it into your organization s analytic and defensive efforts.
